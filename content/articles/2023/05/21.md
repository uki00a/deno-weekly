---
title: 2023/05/15〜2023/05/21の最新情報
tags:
  - Deno
  - deno_std
categories:
  - news
date: 2023-05-21
---

## Deno v1.33.4

[Deno v1.33.4](https://github.com/denoland/deno/releases/tag/v1.33.4)がリリースされました。

### Node.js互換性の改善

- `node:crypto`: `getDiffieHellman`/`createDiffieHellman`が実装されました。
- `node:url`: `format`にURLオブジェクトを渡すと、適切にフォーマットが行われなかった問題が修正されました。
- `node:child_process`: `spawn`の`stdio`オプションに`Stream`を渡せるようになりました。
  - これにより[https://github.com/mysticatea/npm-run-all](https://github.com/mysticatea/npm-run-all) が動くようになったようです
- Node-API
  - `napi_add_finalizer`が実装されました。
  - BigInt関連のAPIの互換性が改善されています。
- npm: `optionalDependencies`のサポートが改善されています。

### Deno KV

`Deno.Kv.close()`の戻り値の型定義が`Promise<void>`から`void`へ変更されました。(実装は変わっていません)

また、`close()`の呼び出しによって実行途中の操作が割り込まれる旨がドキュメントで明示されています。

### `Deno.serve()`のバグ修正

リクエストがキャンセルされると、Denoがパニックすることがある問題が修正されました。

### Web API

- `BroadcastChannel`の型定義が`lib.deno.unstable.d.ts`へ移動されました。
  - unstable APIであるにも関わらず、`--unstable`なしでも型定義を参照できてしまう問題があったようです。
- `WebSocket`で短い時間内で多くのメッセージを送信すると、いくつかのメッセージが失われることがある問題が修正されました。
- `fetch()`でIPアドレスを指定してHTTPSリクエストを送信するとエラーが発生する問題が解消されました。(例: `https://1.1.1.1/`)
