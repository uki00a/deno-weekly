---
title: 2023/05/22ã€œ2023/05/28ã®æœ€æ–°æƒ…å ±
tags:
  - Deno
  - deno_std
  - Deno Deploy
  - fresh
  - esm.sh
categories:
  - news
date: 2023-05-28
---

## Deno v1.34

Deno v1.34ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã€‚

ä»¥ä¸‹ã«å†…å®¹ã‚’ã¾ã¨ã‚ãŸãŸã‚ã€ã‚ˆã‚ã—ã‘ã‚Œã°ãã¡ã‚‰ã‚’å‚ç…§ã„ãŸã ã‘ã‚Œã°ã¨æ€ã„ã¾ã™ã€‚

* [Deno v1.34]({{< ref "articles/deno/v1.34.md" >}})

## deno_std v0.189.0

[deno_std v0.189.0](https://github.com/denoland/deno_std/releases/tag/0.189.0)ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã€‚

### `std/async/retry.ts`

[retry()](https://deno.land/std@0.189.0/async/retry.ts?s=retry)ã®å†…éƒ¨ã§ã‚¸ãƒƒã‚¿ãƒ¼ãŒé©ç”¨ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

### `std/collections/group_by.ts`

`groupBy()`ã§`Iterable<T>`å‹ã®å€¤ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¾ã—ãŸã€‚

```javascript
import { groupBy } from "https://deno.land/std@0.189.0/collections/group_by.ts";

groupBy(
  new Set([1, 2, 3, 4, 5]),
  (x) => x % 2 === 0 ? "even" : "odd",
);
// Output: { odd: [ 1, 3, 5 ], even: [ 2, 4 ] }
```

ã¾ãŸã€`selector`é–¢æ•°ãŒå¼•æ•°ã¨ã—ã¦ç¾åœ¨å‡¦ç†ä¸­ã®è¦ç´ ã®indexã‚’å—ã‘å–ã‚‹ã‚ˆã†ã«å¤‰æ›´ã•ã‚Œã¦ã„ã¾ã™ã€‚

---

* [v0.189.0](https://deno.land/std@0.189.0/collections/group_by.ts?s=groupBy)
* [v0.188.0](https://deno.land/std@0.188.0/collections/group_by.ts?s=groupBy)
        

## Deno Deployã§Node.jsçµ„ã¿è¾¼ã¿ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã‚µãƒãƒ¼ãƒˆ

Deno Deployã§Node.jsçµ„ã¿è¾¼ã¿ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã‚µãƒãƒ¼ãƒˆã•ã‚ŒãŸã‚ˆã†ã§ã™ã€‚

- [Node.js built-ins on Deno Deploy](https://deno.com/blog/node-builtins-on-deploy)

Denoã¨åŒæ§˜ã«`node:<ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å>`ã®å½¢å¼ã§`import`ã™ã‚‹ã“ã¨ã§åˆ©ç”¨ã§ãã¾ã™ã€‚

ã“ã‚Œã«ã‚ˆã‚Šã€[esm.sh](https://github.com/esm-dev/esm.sh)ã‚’åˆ©ç”¨ã—ã¦ã€Deno Deployã§Expressãªã©ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå‹•ã‹ã›ã‚‹ã‚ˆã†ã«ãªã£ãŸã‚ˆã†ã§ã™ã€‚(ç¾çŠ¶ã§ã¯[target=denonext]({{< ref "articles/2023/02/26.md" >}})ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‚ˆã†ã§ã™)

```javascript
import express from "https://esm.sh/express@4.18.2?target=denonext";

const app = express();
app.get("/", (req, res) => {
  res.send("Hello Express");
});
app.listen(3000);
```

Deno Deployã§ã®å„Node.jsçµ„ã¿è¾¼ã¿ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚µãƒãƒ¼ãƒˆçŠ¶æ³ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§èª¬æ˜ã•ã‚Œã¦ã„ã¾ã™ã€‚

- https://deno.com/deploy/docs/runtime-node

ã¾ãŸã€å°†æ¥çš„ã«ã¯Deno Deployã§`npm:`ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ã‚‚æ¤œè¨ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚

## Deno Deploy's Changelog

Deno Deployã®Changelogãƒšãƒ¼ã‚¸ãŒå…¬é–‹ã•ã‚Œã¾ã—ãŸã€‚

* https://deno.com/deploy/changelog

Deno Deployã‚„`deployctl`ãªã©ã®æœ€æ–°æƒ…å ±ãŒå…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚

## fresh v1.1.6

[fresh v1.1.6](https://github.com/denoland/fresh/releases/tag/1.1.6)ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã€‚

### `MiddlewareHandlerContext`ã«`destination`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒè¿½åŠ 

ã“ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã¯ã€è¦æ±‚ã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã«å¿œã˜ã¦ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã®å€¤ãŒè¨­å®šã•ã‚Œã¾ã™ã€‚

|`destination`|èª¬æ˜|
|:---:|:---:|
|`"static"`|`static`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã«è¨­å®šã•ã‚Œã¾ã™|
|`"route"`|`route`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§å®šç¾©ã•ã‚ŒãŸã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã«è¨­å®šã•ã‚Œã¾ã™|
|`"notFound"`|404ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã«è¨­å®šã•ã‚Œã¾ã™|
|`"internal"`|freshã®å†…éƒ¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆãªã©ãŒè¦æ±‚ã•ã‚ŒãŸéš›ã«è¨­å®šã•ã‚Œã¾ã™|

Middlewareã§ã€è¦æ±‚ã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã«å¿œã˜ãŸå›ºæœ‰ã®å‡¦ç†ã‚’è¡Œã„ãŸã„å ´åˆãªã©ã«æ´»ç”¨ã§ããã†ã§ã™ã€‚

```typescript
import type { MiddlewareHandlerContext } from "$fresh/server/types.ts";

export async function handler(
  req: Request,
  ctx: MiddlewareHandlerContext,
) {
  const res = ctx.destination === "static"
    ? await handleStaticResource(req, ctx)
    : await ctx.next();
  return res;
}
```

---

- [MiddlewareHandlerContext](https://deno.land/x/fresh@1.1.6/src/server/types.ts?s=MiddlewareHandlerContext)
    
### `.env`ã®ã‚µãƒãƒ¼ãƒˆãŒè¿½åŠ 

ä»Šå¾Œã€[init.ts](https://deno.land/x/fresh@1.1.6/init.ts)ã§æ–°ã—ããƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ã¨ã€ã‚µãƒ¼ãƒèµ·å‹•æ™‚ã«`.env`ãŒè‡ªå‹•ã§èª­ã¿è¾¼ã¾ã‚Œã¾ã™ã€‚

## esm.sh v123

[esm.sh v123](https://github.com/esm-dev/esm.sh/releases/tag/v123)ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã€‚

[esm-worker](https://www.npmjs.com/package/esm-worker)ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦ã€`esm.sh`ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§å‹•ã‹ã™ãŸã‚ã®ä»•çµ„ã¿ãŒå°å…¥ã•ã‚Œã¦ã„ã¾ã™ã€‚

```shell
$ deno run -A https://esm.sh/server
Welcome to use esm.sh!
This is local version of esm.sh running on Deno
 ğŸ¦•.
Homepage: http://localhost:8787
Module: http://localhost:8787/react
```

---

https://github.com/esm-dev/esm.sh/blob/v123/server.ts
