---
title: 2023/05/08〜2023/05/14の最新情報
tags:
  - Deno
  - deno_std
  - esm.sh
categories:
  - news
date: 2023-05-14
---

## Deno v1.33.3

[Deno v1.33.3](https://github.com/denoland/deno/releases/tag/v1.33.3)がリリースされました。

### `deno compile`でnpmパッケージがサポート

`deno compile`で`npm:`や`node:`URLに依存したアプリケーションの実行可能ファイルの生成がサポートされました。

```javascript
import chalk from "npm:chalk@5.2.0";

console.log(chalk.green.bold("Hello"));
```

現時点では`--unstable`の指定が必要です。

```shell
$ deno compile --unstable --output=example main.js

$ ./example
```

また、`deno compile`によるコンパイル対象として、直接npmパッケージを指定することもできるようです。

```shell
$ deno compile --unstable --output=cowsay npm:cowsay@1.5.0

$ ./cowsay hello
```

### `Deno.serve()`

レスポンスの自動的な圧縮が実装されました。

現時点では`gzip`のみがサポートされています。(`Content-Encoding: gzip`)

それ以外には、`--watch`オプションと併用した際の安定性の改善が実施されています。

### `Deno.Command`

[Deno.ChildProcess#kill](https://deno.land/api@v1.33.3?s=Deno.ChildProcess&p=prototype.kill)が、システムの全バイナリに対する`--allow-run`権限を要求する問題が修正されました。

v1.33.2までは、例えば`--allow-run=redis-cli`のように特定のバイナリのみを許可している場合、`Deno.ChildProcess#kill`で権限エラーが発生する問題があったため、このリリースで修正されています。

### `deno lsp`

`documentPreloadLimit`オプションが追加されました。

これにより、[deno lspがプリロードするドキュメント数]({{< ref "articles/2023/04/02.md" >}})をカスタマイズできます。

[vscode_deno](https://github.com/denoland/vscode_deno)では、[v3.18.0](https://github.com/denoland/vscode_deno/compare/3.17.0...3.18.0)で`documentPreloadLimit`オプションのサポートが入っているようです。

### その他

- `Deno.seekSync`と`Deno.seek`の型定義が統一されていなかった問題が修正されました。([#19060](https://github.com/denoland/deno/issues/19060))
- `node:module`: `Module.runMain()`が実装されました。([ts-node](https://github.com/TypeStrong/ts-node)で使用されているようです)
- リダイレクトするリモートモジュールへの依存があった場合、`deno vendor`の実行時にパニックする問題が修正されました。
- [Deno.UnsafeCallback](https://deno.land/api@v1.33.3?s=Deno.UnsafeCallback&unstable)が使用されていると、`deno test`がハングすることのある問題が修正されました。
