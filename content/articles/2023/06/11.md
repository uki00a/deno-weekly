---
title: 2023/06/05〜2023/06/11の最新情報
tags:
  - Deno
  - deno_std
categories:
  - news
date: 2023-06-11
---

## Deno v1.34.2

[Deno v1.34.2](https://github.com/denoland/deno/releases/tag/v1.34.2)がリリースされました。

### Node.js互換性

- `node:http2`が追加されました。
  - `http2.connect`と`http2.createServer`の基本的な実装が追加されています。
- `node:fs/promises`: `FileHandle`の以下のメソッドが実装されました。
  - `readFile()`
  - `read()`
  - `write()`
  - `close()`
- `node:child_process`: `spawn`で`stdioオプション`に`[0, 1, 2]`が指定できるように
- `node:process`: `process.stdout`にpipeされた`Readable`ストリームがクローズされた際に、`process.stdout`も一緒にクローズされてしまう問題が修正されています。

### Web API

- 巨大な`ArrayBuffer`を`console.log`などで表示しようとした際に、誤ってdetached状態として表示される問題が修正されました。
- `EventTarget`のリスナ内で同一イベントへのリスナを新しく登録した際に、登録されたばかりのリスナが即座に呼ばれてしまう問題が修正されました。

### パフォーマンス改善

主にHTTPサーバ(`Deno.serve`)に対して、様々なパフォーマンス改善が実施されています。

- [perf: use sendto syscalls #19414](https://github.com/denoland/deno/pull/19414)
- [perf(ext/http): Add a sync phase to http serving #19321](https://github.com/denoland/deno/pull/19321)
- [perf(ext/http): Use flat list of headers for multiple set/get methods #19336](https://github.com/denoland/deno/pull/19336)
- [perf(ext/http): Migrate op_http_get_request_headers to v8::Array #19354](https://github.com/denoland/deno/pull/19354)
- [perf(ext/http): Migrate op_http_get_request_method_and_url to v8::Array #19355](https://github.com/denoland/deno/pull/19355)
- [perf: optimize RegExp usage in JS #19364](https://github.com/denoland/deno/pull/19364)
- [perf(http): avoid flattening http headers #19384](https://github.com/denoland/deno/pull/19384)

## deno_std v0.191.0

[deno_std v0.191.0](https://github.com/denoland/deno_std/releases/tag/0.191.0)がリリースされました。

### `std/{csv,http,path}`: 非推奨化されたファイル・APIの削除

- [std/csv/stream.ts](https://deno.land/std@0.190.0/csv/stream.ts)が削除されました (今後は[std/csv/csv_parse_stream.ts](https://deno.land/std@0.191.0/csv/csv_parse_stream.ts)の使用が推奨)
- `std/http/util.ts`の[compareEtag](https://deno.land/std@0.190.0/http/util.ts?s=compareEtag)が削除されました (今後は[std/http/etag.ts](https://deno.land/std@0.191.0/http/etag.ts)の使用が推奨されます)
- `std/path/mod.ts`の[sep](https://deno.land/std@0.190.0/path/mod.ts?s=sep)が削除されました (今後は[SEP](https://deno.land/std@0.191.0/path/mod.ts?s=SEP)の使用が推奨されます)

### `std/async/retry.ts`

`jitter`オプションが追加されました。(デフォルトは`1`)

`0`を指定するとjitterが適用されなくなります。

### `std/collections`

- 各APIが配列だけでなく`Iterable<T>`を引数として受け取るように改善されました。
- `std/collections/sort_by.ts`: `options`引数が追加
  - `order`オプションによってソート時の並び順を指定できます (デフォルトは`asc`)

### `std/crypto`

`crypto.digest`で`BLAKE2B-224`がサポートされました。

### `std/html`が追加

### `std/streams/merge_readable_streams.ts`

`mergeReadableStreams`のエラーハンドリングが改善されました。

いずれかのストリームでエラーが起きたときにunhandled rejectionが起きないように制御が入りました。

### `std/toml/stringify.ts`

以下のバグが修正されています。

- キーが空文字列の際に、不正なTOMLが出力される
- 値が空のオブジェクトがうまくTOMLとして出力されない
- インラインオブジェクトのキーに`/`などの特殊なキーがあると、適切に出力がされない
