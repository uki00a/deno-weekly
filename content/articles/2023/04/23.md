---
title: 2023/04/17ã€œ2023/04/23ã®æœ€æ–°æƒ…å ±
tags:
  - Deno
  - deno_std
  - esm.sh
  - Oak
categories:
  - news
date: 2023-04-23
---


## Deno v1.32.5

[Deno v1.32.5](https://github.com/denoland/deno/releases/tag/v1.32.5)ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã€‚

### KV

[Deno.AtomicOperation.sum](https://deno.land/api@v1.32.5?unstable=&s=Deno.AtomicOperation&p=prototype.sum)ãŒå®Ÿè£…ã•ã‚Œã¾ã—ãŸã€‚
            
```typescript
const kv = await Deno.openKv(":memory:");

const result = await kv.set(["key"], new Deno.KvU64(1n));

const ok = await kv.atomic()
  .check({ key: ["key"], versionstamp: result.versionstamp })
  .mutate({ type: "sum", key: ["key"], value: new Deno.KvU64(2n) })
  .commit();
assert(ok);

const result2 = await kv.get(["key"]);
assert(result2.value instanceof Deno.KvU64);
assert(result2.value.value === 3n);
```

### Node.jsäº’æ›æ€§
            
- `node:http`: `ClientRequest.socket.remoteAddress`ãŒå®Ÿè£…ã•ã‚Œã¾ã—ãŸ
- `node:crypto`:  [createVerify](https://nodejs.org/docs/latest-v18.x/api/crypto.html#cryptocreateverifyalgorithm-options)ãŒå®Ÿè£…ã•ã‚Œã¾ã—ãŸ
- `node:path`: `fromFileUrl`ãªã©ã®Node.jsã§ã¯æä¾›ã•ã‚Œãªã„ã‚·ãƒ³ãƒœãƒ«ãŒexportã•ã‚Œã¦ã„ãŸå•é¡ŒãŒä¿®æ­£ã•ã‚Œã¾ã—ãŸ
- `npm`: ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ã§æŒ‡å®šã•ã‚ŒãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«è¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸå ´åˆã«ã€ãã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã‚ˆã†ã«æŒ™å‹•ãŒå¤‰æ›´ã•ã‚Œã¾ã—ãŸ (ã“ã®ã‚ˆã†ãªå ´åˆã€ä»Šã¾ã§ã¯ã‚¨ãƒ©ãƒ¼ãŒèµ·ãã¦ã„ã¾ã—ãŸ)

### ãƒã‚°ä¿®æ­£

- `deno lsp`: Unixç³»ã®OSã§statusãƒšãƒ¼ã‚¸ãŒè¿”ã£ã¦ã“ãªããªã£ã¦ã„ãŸå•é¡ŒãŒä¿®æ­£ã•ã‚Œã¾ã—ãŸ
- `deno test --watch`ã®å®Ÿè¡Œä¸­ã«SIGINTã‚’é€ä¿¡ã—ã¦ã‚‚ã€ãƒ—ãƒ­ã‚»ã‚¹ã‚’åœæ­¢ã§ããªã„å•é¡ŒãŒä¿®æ­£ã•ã‚Œã¾ã—ãŸ
- `Deno.upgradeWebSocket()`ã§å–å¾—ã—ãŸ`WebSocket`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®`send()`ãƒ¡ã‚½ãƒƒãƒ‰ãŒã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã„ãšã‚Œã‹ã®ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’å—ä¿¡ã™ã‚‹ã¾ã§ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã—ã¾ã†å•é¡ŒãŒä¿®æ­£ã•ã‚Œã¾ã—ãŸ ([#18700](https://github.com/denoland/deno/issues/18700))

## deno_std v0.184.0

[deno_std v0.184.0](https://github.com/denoland/deno_std/releases/tag/0.184.0)ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã€‚

### `std/encoding` - éæ¨å¥¨åŒ–ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤

éæ¨å¥¨åŒ–ã•ã‚ŒãŸä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå‰Šé™¤ã•ã‚Œã¦ã„ã¾ã™ã€‚

|å‰Šé™¤ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«|ç§»è¡Œå…ˆ|
|:---:|:---:|
|`std/encoding/front_matter/*`|[std/front_matter/mod.ts](https://deno.land/std@0.184.0/front_matter/mod.ts)|
|`std/encoding/jsonc.ts`|[std/jsonc/mod.ts](https://deno.land/std@0.184.0/jsonc/mod.ts)|
|`std/encoding/toml.ts`|[std/toml/mod.ts](https://deno.land/std@0.184.0/toml/mod.ts)|
|`std/encoding/yaml.ts`|[std/yaml/mod.ts](https://deno.land/std@0.184.0/yaml/mod.ts)|
|`std/encoding/csv.ts`|[std/csv/mod.ts](https://deno.land/std@0.184.0/csv/mod.ts)|
|`std/encoding/csv/*`|[std/csv/mod.ts](https://deno.land/std@0.184.0/csv/mod.ts)|
|`std/encoding/json/stream.ts`|[std/json/mod.ts](https://deno.land/std@0.184.0/json/mod.ts)|

### `std/console`ã®è¿½åŠ 

æ–°è¦ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦[std/console](https://deno.land/std@0.184.0/console/mod.ts)ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚

ã“ã‚Œã¯Rustã®[unicode-width](https://github.com/unicode-rs/unicode-width/)ã‚’TypeScriptã«ãƒãƒ¼ãƒˆã—ãŸã‚‚ã®ã®ã‚ˆã†ã§ã™ã€‚

```javascript
import { unicodeWidth } from "https://deno.land/std@0.184.0/console/mod.ts";

unicodeWidth("foobar"); // => 6
unicodeWidth("ã‚ã„ã†ãˆãŠ"); // => 10
unicodeWidth("ğŸ¦•"); // => 2
```

### `std/testing/bdd.ts`: `it.skip`/`describe.skip`ãŒè¿½åŠ 

æŒ™å‹•ã¨ã—ã¦ã¯`it.ignore`/`describe.ignore`ã¨åŒæ§˜ã§ã™ã€‚

Jestã‚„Mochaãªã©ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã¯`.ignore`ã§ã¯ãªã`.skip`ãŒæä¾›ã•ã‚Œã¦ãŠã‚Šã€ãã‚Œã‚‰ã¨ã®äº’æ›æ€§ã‚’é«˜ã‚ã‚‹ã“ã¨ãŒç›®çš„ã®ã‚ˆã†ã§ã™ã€‚

### `std/http/file_server`: `serveFile()`ã®æ”¹å–„

[serveFile()](https://deno.land/std@0.184.0/http/file_server.ts?s=serveFile)ã§Rangeãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é©åˆ‡ã«å‡¦ç†ã§ãã‚‹ã‚ˆã†ã«æ”¹å–„ã•ã‚Œã¾ã—ãŸã€‚

## "What's next for Deno?" by Ryan Dahl (NodeCongress '23)

NodeCongressã§ã®Ryan Dahlæ°ã®ç™ºè¡¨ãŒ[Youtube](https://www.youtube.com/watch?v=LVEGRj3RZSA)ã§å…¬é–‹ã•ã‚Œã¾ã—ãŸã€‚

{{< youtube LVEGRj3RZSA >}}

ä»¥ä¸‹ã®å†…å®¹ãªã©ã«ã¤ã„ã¦è§£èª¬ã•ã‚Œã¦ã„ã¾ã™ã€‚

- `node:`ã‚„`npm:`ã®ã‚µãƒãƒ¼ãƒˆã«ã¤ã„ã¦
- [Deno KV]({{< ref "articles/deno/v1.32.md" >}})ã®ç´¹ä»‹
- Deno Deployã§ã®Deno KVã®ã‚µãƒãƒ¼ãƒˆã«ã¤ã„ã¦ (ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ã—ã¦FoundationDBãŒæ¡ç”¨ã•ã‚Œã‚‹äºˆå®šã®ã‚ˆã†ã§ã™)
- Deno 2.0ã®ãƒªãƒªãƒ¼ã‚¹æ™‚æœŸ (ä»Šå¹´ã®å¤é ƒã«äºˆå®šã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™)
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚„æ°¸ç¶šã‚­ãƒ¥ãƒ¼ã€ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ãƒ¯ãƒ¼ã‚«ãƒ¼ãªã©ã®é–‹ç™ºã«ã¤ã„ã¦

## `Deno.serve(handler, options)`å½¢å¼ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ãŒå‰Šé™¤

ä»¥ä¸‹ã®PRã§`Deno.serve`ã®å®‰å®šåŒ–ã«å‘ã‘ã¦ã€APIã®ã‚·ã‚°ãƒãƒãƒ£ã®è¦‹ç›´ã—ãŒè¡Œã‚ã‚Œã¦ã„ã¾ã™ã€‚

> [BREAKING(unstable): remove "Deno.serve(handler, options)" overload #18759](https://github.com/denoland/deno/pull/18759)

å…·ä½“çš„ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå‘¼ã³å‡ºã—ãŒã§ããªããªã‚‹ã‚ˆã†ã§ã™ã€‚

```typescript
const handler = (request) => {
  // ...
  return new Response(body);
};
const ac = new AbortController();
Deno.serve(handler, {
  signal: ac.signal,
});
```

ä¸Šè¨˜ã¨åŒæ§˜ã®ã“ã¨ãŒã—ãŸã„å ´åˆã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«æŒ‡å®šã§ãã¾ã™ã€‚

```typescript
const handler = (request) => {
  // ...
  return new Response(body);
};
const ac = new AbortController();
Deno.serve({
  signal: ac.signal,
}, handler);

// ã¾ãŸã¯ä»¥ä¸‹ã§ã‚‚å¯
Deno.serve({
  handler,
  signal: ac.signal,
});
```

## esm.sh v116

[esm.sh v116](https://github.com/esm-dev/esm.sh/releases/tag/v116)ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã€‚

GitHubãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®importãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã™ã€‚

å¯¾è±¡ãƒªãƒã‚¸ãƒˆãƒªã®ãƒ«ãƒ¼ãƒˆã«`package.json`ãŒã‚ã‚Œã°ã€`https://esm.sh/gh/<ã‚ªãƒ¼ãƒŠãƒ¼>/<ãƒªãƒã‚¸ãƒˆãƒª>/path/to/file`ã®ã‚ˆã†ã«æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’importã§ãã‚‹ã‚ˆã†ã§ã™ã€‚

## Oak v12.2.0

[Oak v12.2.0](https://github.com/oakserver/oak/commit/5683813b9f3dd5bc89c6259dfb953796c50fad40)ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã€‚

[Flashã‚µãƒ¼ãƒã®ã‚µãƒãƒ¼ãƒˆãŒå‰Šé™¤]({{< ref "articles/2023/04/09.md" >}})ã•ã‚Œã¦ã„ã¾ã™ã€‚
