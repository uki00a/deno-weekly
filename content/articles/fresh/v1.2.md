---
title: fresh v1.2
tags:
  - fresh
  - Preact
categories:
  - release
date: 2023-06-18
---

fresh v1.2ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã€‚

ã“ã®è¨˜äº‹ã§ã¯ä¸»ãªå¤‰æ›´ç‚¹ãªã©ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚

ã“ã®ãƒªãƒªãƒ¼ã‚¹ã«åˆã‚ã›ã¦ã€Preactã®ãƒ¡ãƒ³ãƒ†ãƒŠãƒ¼ã§ã‚ã‚‹[Marvin Hagemeister](https://github.com/marvinhagemeister)æ°ãŒDenoç¤¾ã«å…¥ç¤¾ã•ã‚ŒãŸã“ã¨ãŒç™ºè¡¨ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã‹ã‚‰Marvin Hagemeisteræ°ã‚’ä¸­å¿ƒã«ã€ãƒ•ãƒ«ã‚¿ã‚¤ãƒ ã§Freshã®é–‹ç™ºãŒé€²ã‚ã‚‰ã‚Œã¦ã„ãã“ã¨ãŒè¨ˆç”»ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚

## ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã«ã¤ã„ã¦

freshã¯ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆç”¨ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ([update.ts](https://github.com/denoland/fresh/blob/1.2.0/update.ts))ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€v1.2ã¸ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```bash
$ deno run -A -r https://fresh.deno.dev/update .
```

ã¾ãŸã€ã“ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä»¥é™ã‹ã‚‰[init.ts](https://github.com/denoland/fresh/blob/1.2.0/init.ts) (freshã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ç”¨ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ)ã§ä½œæˆã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€`deno task update`ã§ã‚‚freshã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## Islandã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«é–¢ã™ã‚‹æ”¹å–„

### `props.children`ã®ã‚µãƒãƒ¼ãƒˆ

Islandã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§`props.children`ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¾ã—ãŸã€‚

```tsx
import type { PageProps } from "$fresh/server.ts";

import Collapse from "../islands/Collapse.tsx";

function Content() {
  return <div>foobar</div>;
}

export default function Index(props: PageProps) {
  return (
    <Collapse>
      <Content />
    </Collapse>
  );
}
```

ã¾ãŸIslandã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒã‚¹ãƒˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

```tsx
export default function Index(props: PageProps) {
  return (  
    <Collapse>
      <Collapse>
        <Content />
      </Collapse>
    </Collapse>
  );
}
```

åˆ¶é™ã¨ã—ã¦ã€`children`ä»¥å¤–ã®`props`ã«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æ¸¡ã™ã“ã¨ã¯ã¾ã ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚

### `props`ã«ã‚·ã‚°ãƒŠãƒ«/`Uint8Array`/å¾ªç’°ã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ¸¡ã›ã‚‹ã‚ˆã†ã«

[Preact Signals](https://preactjs.com/guide/v10/signals/)ã®ã‚·ã‚°ãƒŠãƒ«ã‚’Islandã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®`props`ã¨ã—ã¦æ¸¡ã›ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

```tsx
import type { PageProps } from "$fresh/server.ts";
import { useSignal } from "@preact/signals";

import Counter from "../islands/Counter.tsx";
import Double from "../islands/Double.tsx";

export default function Index(props: PageProps<string>) {
  const count = useSignal(0);
  return (
    <>
      <Counter count={count} />
      <Double count={count} />
    </>
  );
}
```

ã¾ãŸã€å¾ªç’°ã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„`Uint8Array`ã‚‚ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¾ã—ãŸã€‚

ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å¾ªç’°ã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ¸¡ã™ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

```tsx
import Example from "../islands/Example.tsx";

export default function Page() {
  const data = { a: 1, b: { c: 2 } };
  data.d = data;
  return (
    <Example data={data} />;
  );
}
```

### `islands`ã®ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚µãƒãƒ¼ãƒˆ

ä»Šã¾ã§ã¯ã€Islandã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯`islands`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ç›´ä¸‹ã«é…ç½®ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚(ä¾‹: `islands/Counter.tsx`)

ã“ã®ä»•æ§˜ãŒæ‹¡å¼µã•ã‚Œã¦ã€`islands`ã®ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã—ãŸIslandã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚‚freshã«ã‚ˆã£ã¦èªè­˜ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸ (ä¾‹: `islands/sub_directory/Counter.tsx`)

## npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚µãƒãƒ¼ãƒˆ

Islandã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§`npm:`ãŒåˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

```tsx
// islands/Example.tsx
import truncate from "npm:lodash.truncate@4.4.2";

interface Props {
  text: string;
}

export default function Example({ text }: Props) {
  return <span>{ truncate(text) }</span>;
}
```

æ³¨æ„ç‚¹ã¨ã—ã¦ã€Deno Deployã§ã¯ã¾ã `npm:`ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚

Deno Deployã§ã®`npm:`ã‚µãƒãƒ¼ãƒˆã«ã¤ã„ã¦ã¯ã€ã¾ã‚‚ãªãã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹è¨ˆç”»ãŒã‚ã‚‹ã‚ˆã†ãªã®ã§ã€ã‚‚ã—æ°—ã«ãªã‚‹å ´åˆã¯[Deno Deployã®Changelog](https://deno.com/deploy/changelog)ãªã©ã‚’ã‚¦ã‚©ãƒƒãƒã—ã¦ãŠãã¨ã‚ˆã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

## ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã§`renderAsync`ãƒ•ãƒƒã‚¯ãŒã‚µãƒãƒ¼ãƒˆ

freshã«ã¯[ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ](https://github.com/denoland/fresh/blob/1.2.0/docs/concepts/plugins.md)ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã‚Œã¯freshã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã«ãŠã‘ã‚‹æ§˜ã€…ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«å¯¾ã—ã¦ãƒ•ãƒƒã‚¯ã‚’æä¾›ã™ã‚‹ã“ã¨ã§ã€freshã‚’æ‹¡å¼µã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®ä»•çµ„ã¿ã§ã™ã€‚

[v1.1]({{< ref "articles/fresh/v1.1.md" >}})ã®æ™‚ç‚¹ã§ã¯ã€SSRã®å®Ÿè¡Œå‰å¾Œã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«å¯¾ã™ã‚‹ãƒ•ãƒƒã‚¯(`render`ãƒ•ãƒƒã‚¯)ã®ã¿ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã—ãŸã€‚

ã“ã®`render`ãƒ•ãƒƒã‚¯ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€SSRã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚ŒãŸHTMLã«åŸºã¥ã„ã¦[Twind](https://github.com/tw-in-js/twind)ãªã©ã®CSSãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã‚’ç”Ÿæˆã•ã›ã‚‹ã“ã¨ãªã©ãŒå‡ºæ¥ã¾ã—ãŸã€‚

å®Ÿéš›ã«freshã®å…¬å¼ã‹ã‚‰ã“ã®æ©Ÿèƒ½ã‚’æ´»ç”¨ã—ãŸTwindå‘ã‘ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚

- [plugins/twind.ts](https://github.com/denoland/fresh/blob/1.2.0/plugins/twind.ts)

åˆ¶é™ã¨ã—ã¦ã€ã“ã®`render`ãƒ•ãƒƒã‚¯ã¯åŒæœŸçš„ã«å‹•ä½œã™ã‚‹ã“ã¨ãŒæƒ³å®šã•ã‚Œã¦ãŠã‚Šã€éåŒæœŸå‡¦ç†ã‚’ä»•è¾¼ã‚€ã“ã¨ãŒã§ããªã„ã¨ã„ã†èª²é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚

ãã®ãŸã‚ã€[UnoCSS](https://github.com/unocss/unocss)ãªã©ã®éåŒæœŸã«å‹•ä½œã™ã‚‹CSSã‚¨ãƒ³ã‚¸ãƒ³ã‚’ãƒ—ãƒ©ã‚°ã‚¤ãƒ³çµŒç”±ã§ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ãŒã§ããªã„èª²é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚

ã“ã®åˆ¶é™ã‚’è§£æ¶ˆã™ã‚‹ãŸã‚ã€`renderAsync`ã¨ã„ã†æ–°ã—ã„ãƒ•ãƒƒã‚¯ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚

å®Ÿéš›ã«ã“ã®`renderAsync`ãƒ•ãƒƒã‚¯ã‚’æ´»ç”¨ã—ã¦UnoCSSãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’å®Ÿè£…ã™ã‚‹PRãŒfreshã®ãƒªãƒã‚¸ãƒˆãƒªã«ä½œæˆã•ã‚Œã¦ã„ã¾ã™ã€‚

> [feat(plugins): add unocss plugin (WIP) #1303](https://github.com/denoland/fresh/pull/1303)

ã“ã‚Œã«ã‚ˆã‚Šã€è¿‘ã„å°†æ¥ã€freshå…¬å¼ã‹ã‚‰UnoCSSãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒæä¾›ã•ã‚Œã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚Šãã†ã§ã™ã€‚

## `deno.json`ã‚µãƒãƒ¼ãƒˆã®æ”¹å–„

### `imports`ã«ã‚ˆã‚‹ä¾å­˜ç®¡ç†ãŒã‚µãƒãƒ¼ãƒˆ

ä»Šã¾ã§ã€freshã§ã¯`import_map.json`ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«(Import Maps)ã§ä¾å­˜é–¢ä¿‚ã‚’ç®¡ç†ã—ã¦ã„ã¾ã—ãŸã€‚

ã¾ãŸã€[Deno v1.30]({{< ref "articles/deno/v1.30/v1.2.md" >}})ã®ãƒªãƒªãƒ¼ã‚¹ã§ã€`deno.json`ã§Import MapsãŒå®šç¾©ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

Denoæœ¬ä½“ã§ã®ã“ã®å¤‰æ›´ã«åˆã‚ã›ã¦ã€freshã§ã‚‚`deno.json`ã®`imports`ã§å®šç¾©ã•ã‚ŒãŸImport Mapsã‚’è§£é‡ˆã—ã¦ãã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

ä»Šå¾Œã€[init.ts](https://github.com/denoland/fresh/blob/1.2.0/init.ts)ã§æ–°ã—ãä½œæˆã•ã‚ŒãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¤ã„ã¦ã¯ã€ã“ã®`deno.json`ã§ã®ä¾å­˜ç®¡ç†ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«ãªã‚Šã¾ã™ã€‚

ã¾ãŸã€ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã—ã¦ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ãŸéš›ã‚‚ã€`import_map.json`ã‹ã‚‰`deno.json`ã¸è‡ªå‹•ã§ç§»è¡Œã•ã‚Œã¾ã™ã€‚

### ç¥–å…ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ã®`deno.json`ã®æ¢ç´¢ãŒã‚µãƒãƒ¼ãƒˆ

ä»Šã¾ã§ã€freshã§ã¯ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã«`deno.json`ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ãŒæƒ³å®šã•ã‚Œã¦ã„ã¾ã—ãŸã€‚

ã“ã®ãƒªãƒªãƒ¼ã‚¹ã‹ã‚‰ã€ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ç¥–å…ˆã‹ã‚‰ã‚‚`deno.json`ãŒæ¢ç´¢ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

ã“ã‚Œã¯ã€freshã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä½œæˆã—ã¦ã„ã‚‹ã‚ˆã†ãªã‚±ãƒ¼ã‚¹ã§æ´»ç”¨ã•ã‚Œã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚

ä¾‹ãˆã°ã€ä»¥ä¸‹ã¯`./web`ã«freshã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒä½œæˆã•ã‚Œã¦ã„ã¾ã™ãŒã€ã“ã®ã‚ˆã†ãªå ´åˆã€freshã¯`./deno.json`ã‚’èª­ã¿è¾¼ã‚“ã§ãã‚Œã¾ã™ã€‚

```bash
.
â”œâ”€â”€ deno.json
â”œâ”€â”€ web
â”‚Â Â  â”œâ”€â”€ routes
â”‚Â Â  â”‚  â”œâ”€â”€ index.ts
â”‚Â Â  â”‚  â””â”€â”€ about.ts
â”‚Â Â  â””â”€â”€ fresh.gen.ts
â””â”€â”€ README.md
```



## HEADãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚«ã‚¹ã‚¿ãƒ ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ãŒå®šç¾©ã§ãã‚‹ã‚ˆã†ã«

freshã¯SSRå®Ÿè¡Œæ™‚ã®æŒ™å‹•ã‚’èª¿æ•´ã—ãŸã‚Šã€REST APIãªã©ã®å®Ÿè£…ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ãªã©ã‚’ç›®çš„ã¨ã—ã¦ã€[ã‚«ã‚¹ã‚¿ãƒ ãƒãƒ³ãƒ‰ãƒ©ãƒ¼](https://github.com/denoland/fresh/blob/1.2.0/docs/getting-started/custom-handlers.md)ã¨ã„ã†æ©Ÿèƒ½ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚

ã“ã®ã‚«ã‚¹ã‚¿ãƒ ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã§HEADãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‡¦ç†ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

HEADãƒ¡ã‚½ãƒƒãƒ‰ãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚ŒãŸéš›ã«ã€`handler.HEAD`ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚Œã°ãã‚ŒãŒå‘¼ã°ã‚Œã¾ã™ã€‚

ã‚‚ã—`handler.HEAD`ãŒæœªå®šç¾©ã§ã‚ã‚Œã°ã€ãã®HEADãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ä»£ã‚ã‚Šã«`handler.GET`ã§å‡¦ç†ã•ã‚Œã¾ã™ã€‚

```tsx
// routes/api/example.ts
import type { Handlers } from "$fresh/server.ts";

export const handler: Handlers = {
  HEAD() {
    return new Response(null, {
      headers: {
        "Content-Type": "text/plain;charset=UTF-8",
        "Content-Length": "13",
      },
    });
  },
  GET() {
    return new Response("Hello, world!", {
      headers: {
        "Content-Type": "text/plain;charset=UTF-8",
        "Content-Length": "13",
      },
    });
  },
};
```

## `createHandler()`ã®è¿½åŠ 

æ–°ã—ã[createHandler()](https://deno.land/x/fresh@1.2.0/src/server/mod.ts?s=createHandler)ã¨ã„ã†APIãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚

ä¸»ã«ãƒ†ã‚¹ãƒˆã§ã®ä½¿ç”¨ãŒæƒ³å®šã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ãŒã€ãã‚Œä»¥å¤–ã®ç”¨é€”ã§ã‚‚æ´»ç”¨ã§ããã†ã§ã™ã€‚

```tsx
// test.ts
import { assertEquals, assertStringIncludes } from "https://deno.land/std@0.190.0/testing/asserts.ts";

import manifest from "./fresh.gen.ts";
import { createHandler } from "$fresh/server.ts";

import twindv1 from "$fresh/plugins/twindv1.ts";
import twindConfig from "./twind.config.ts";

Deno.test("handlers", async (t) => {
  const handler = await createHandler(manifest, { plugins: [twindv1(twindConfig)] });
  await t.step("GET /", async () => {
    const res = await handler(new Request("http://localhost:8000/"), {
      localAddr: {
        hostname: "127.0.0.1",
        port: 8000,
        transport: "tcp",
      },
      remoteAddr: {
        hostname: "127.0.0.1",
        port: 50000,
        transport: "tcp",
      }
    });
    assertEquals(res.status, 200);
    assertStringIncludes(await res.text(), "Hello world!");
  });
});
```

## ãƒšãƒ¼ã‚¸ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚„ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

[HandlerContext.render](https://deno.land/x/fresh@1.2.0/src/server/mod.ts?s=HandlerContext)ãŒ`options`å¼•æ•°ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã—ãŸã€‚

ä»¥ä¸‹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚

|ã‚ªãƒ—ã‚·ãƒ§ãƒ³|èª¬æ˜|
|:---:|:---:|
|`status`|HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ä¸Šæ›¸ãã§ãã¾ã™ã€‚|
|`statusText`|HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¸Šæ›¸ãã§ãã¾ã™ã€‚|
|`headers`|HTTPãƒ˜ãƒƒãƒ€ã‚’ä¸Šæ›¸ãã§ãã¾ã™ã€‚|

ã“ã‚Œã«ã‚ˆã‚Šã€ä¾‹ãˆã°ã€ãƒšãƒ¼ã‚¸ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹éš›ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ã€‚

```tsx
import type { Handlers } from "$fresh/server.ts";

export const handler: Handlers = {
  async GET(req, ctx) {
    return ctx.render(null, {
      // ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¨­å®š
      headers: { "x-custom-header": "foo" },
    });
  },
};

export default function Index(props: PageProps) {
  ...
}
```

### `_app.tsx`ã§ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãªã©ã‚’å‚ç…§ã§ãã‚‹ã‚ˆã†ã«

[ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ©ãƒƒãƒ‘ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ](https://github.com/denoland/fresh/blob/1.2.0/docs/concepts/app-wrapper.md)(`_app.tsx`)ã®`props`ã®å‹ã§ã‚ã‚‹[AppProps](https://deno.land/x/fresh@1.2.0/src/server/mod.ts?s=AppProps)ãŒ[PageProps](https://deno.land/x/fresh@1.2.0/src/server/mod.ts?s=PageProps)ã®å†…å®¹ã‚‚å—ã‘å–ã‚‹ã‚ˆã†ã«æ‹¡å¼µã•ã‚Œã¾ã—ãŸã€‚

ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãªã©ã‚’å–ã‚Šæ‰±ã†ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

```tsx
// routes/_app.tsx
export default function App(props: AppProps) {
  const { name } = props.params;
  ...
}
```

## èµ·å‹•ãƒãƒ¼ãƒˆã«é–¢ã™ã‚‹æ”¹å–„

`PORT`ç’°å¢ƒå¤‰æ•°ã«ã‚ˆã£ã¦èµ·å‹•ãƒãƒ¼ãƒˆã‚’å¤‰æ›´ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

```bash
$ PORT=3000 deno task start
  ...

 ğŸ‹ Fresh ready
    Local: http://localhost:3000/
```

ãã‚Œä»¥å¤–ã«ã‚‚ã€`PORT`ç’°å¢ƒå¤‰æ•°ã‚„`port`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã‚ˆã£ã¦ãƒãƒ¼ãƒˆãŒæŒ‡å®šã•ã‚Œãªã‹ã£ãŸéš›ã«ã€8000ã€œ8020ã¾ã§ã®ä¸­ã‹ã‚‰ç©ºã„ã¦ã„ã‚‹ãƒãƒ¼ãƒˆãŒè‡ªå‹•ã§é¸æŠã•ã‚Œã‚‹ã‚ˆã†ã«æ”¹å–„ãŒè¡Œã‚ã‚Œã¦ã„ã¾ã™ã€‚

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„

[TBT](https://web.dev/i18n/ja/tbt/)ã‚„[TTI](https://web.dev/i18n/ja/tti/)ã®æ”¹å–„ã®ãŸã‚ã€Islandã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãŒ[scheduler.postTask](https://developer.mozilla.org/en-US/docs/Web/API/Scheduler/postTask)ã‚’ä½¿ç”¨ã—ã¦å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«æŒ™å‹•ãŒå¤‰æ›´ã•ã‚Œã¾ã—ãŸã€‚

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚„Islandã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®æ•°ãŒå¢—ãˆã‚Œã°å¢—ãˆã‚‹ç¨‹ã€TTIãŒä¼¸ã³ã‚‹å•é¡Œã‚’è§£æ¶ˆã—ãŸã„ã®ãŒèƒŒæ™¯ã«ã‚ã‚‹ã‚ˆã†ã§ã™ã€‚

ã‚‚ã—`postTask`ãŒåˆ©ç”¨ã§ããªã„å ´åˆã¯ã€`setTimeout`ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã•ã‚Œã¾ã™ã€‚

ãã‚Œä»¥å¤–ã«ã‚‚ã€Freshã®[å„ç¨®ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ](https://github.com/denoland/fresh/blob/96be590a90a585c755d2082f5ee12a4fc338349f/src/runtime/entrypoints/main.ts)ã‚„Islandã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãªã©ãŒ`link[rel=modulepreload]`ã«ã‚ˆã£ã¦äº‹å‰èª­ã¿è¾¼ã¿ã•ã‚Œã‚‹ã‚ˆã†ã«æ”¹å–„ã•ã‚Œã¾ã—ãŸã€‚



## ãã®ä»–ã®æ”¹å–„

SSRæ™‚ã®å•é¡Œã‚’è¦‹ã¤ã‘ã‚„ã™ãã™ã‚‹ãŸã‚ã€ã‚µãƒ¼ãƒã‚µã‚¤ãƒ‰ã§ã‚‚`preact/debug`ãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

## å‚è€ƒ

- https://github.com/denoland/fresh/releases/tag/1.2.0
- https://deno.com/blog/fresh-1.2
