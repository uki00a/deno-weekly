---
title: Deno v2.2
tags:
  - Deno
categories:
  - release
date: 2025-02-23
description: Deno v2.2がリリース
---

Deno v2.2がリリースされました。

この記事では主な変更点などについて解説します。

https://www.youtube.com/watch?v=RM1j52eF2og

## `deno lint`

### JavaScriptプラグインシステムの導入

`deno lint`向けに導入が進められていたJavaScriptプラグインシステムが正式に導入されました。

- https://github.com/NfNitLoop/deno-lints
- https://github.com/uki00a/deno-lint-plugin-extra-rules

### React/JSX関連のルールの追加

[`deno_lint`で実装されていたReactやJSX関連のlintルール]({{< ref "articles/2024/12/01.md" >}})がDeno本体で有効化されました。

```shell
$ deno lint --rules --json | jq '.rules | map(select(.tags | (contains(["jsx"]) or contains(["react"])))) | .[].code'
"jsx-boolean-value"
"jsx-button-has-type"
"jsx-curly-braces"
"jsx-key"
"jsx-no-children-prop"
"jsx-no-comment-text-nodes"
"jsx-no-duplicate-props"
"jsx-no-unescaped-entities"
"jsx-no-useless-fragment"
"jsx-props-no-spread-multi"
"jsx-void-dom-elements-no-children"
"react-no-danger"
"react-no-danger-with-children"
"react-rules-of-hooks"
```

新しく追加されたこれらのルールには`jsx`もしくは`react`タグが付与されています。React関連のルールは`recommended`タグがついていなさそうなので、必要に応じて`deno.json`の`lint.rules.tags`などで有効化するとよさそうです:

```json
{
  "lint": {
    "rules": {
      "tags": ["fresh", "react", "recommended"]
    }
  }
}
```

### `--rules`の挙動の変更

`deno lint --rules`の挙動が変更されています。

今までは無効化されているルールは表示されませんでしたが、Deno v2.2からは無効化されているものも含め利用可能なルールがすべて表示されるように挙動が変更されています。有効化されているルールには`✓`マークが表示されるため、見分けることはできそうです。

また、`deno lint --json --rules`からマークダウンドキュメントが削除されています。(代わりに[公式ドキュメントへのリンク]({{< ref "articles/2025/01/05.md" >}})が表示されます)

## `node:sqlite`

Denoに`node:sqlite`モジュールが追加されました。インメモリーデータベース(`:memory:`)を利用する場合を除いて、該当のデータベースファイルに対する読み込み(`--allow-read`)と書き込み権限(`--allow-write`)を与える必要があります (ただし、`readOnly: true`を指定した場合は書き込み権限は要求されません)

```javascript
import { join } from "node:path";
import { DatabaseSync } from "node:sqlite";

const denoDir = Deno.env.get("DENO_DIR");
const db = new DatabaseSync(join(denoDir, "check_cache_v2"), {
  readOnly: true,
});
const stmt = db.prepare("SELECT * FROM tsbuildinfo");
const rows = stmt.all();
for (const row of rows) {
  console.info(row.specifier);
}
db.close();
```

## `deno outdated`

### 依存関係の対話的な更新がサポート

[`deno outdated`]({{< ref "articles/deno/v2.1.md" >}})で依存関係の対話的な更新がサポートされました。`--update`と`--interactive`を併用することで、Denoが対話的に依存関係を更新するUIを表示してくれます:

```shell
$ deno outdated --update --interactive
? Select which packages to update (<space> to select,↑/↓/j/k to navigate, a to select all, i to invert selection,
enter to accept, <Ctrl-c> to cancel)
❯ ○ jsr:@hono/hono       4.6.14 -> 4.7.2
  ○ npm:@nestjs/common   10.4.4 -> 10.4.15
  ○ npm:@nestjs/core     10.4.4 -> 10.4.15
  ○ jsr:@oak/oak         17.1.0 -> 17.1.4
```

## `deno task`

### ワイルドカード指定(`*`)によるタスクの一括実行がサポート

指定されたパターンにマッチするタスクをまとめて実行することができます:

```shell
# `check:`から始まるタスクをまとめて実行します
$ deno task 'check:*'
```

### `--frozen`のサポート

`deno task`で[`--frozen`]({{< ref "articles/deno/v1.45.md" >}})オプションがサポートされています。

`"nodeModulesDir": "auto"`が有効化されている際に`deno task`でエラーが起きてしまうことがあるようで、その場合に`--frozen=false`を指定することで回避できるようにすることが目的のようです。

## `deno check`

### `compilerOptions.rootDirs`のサポート

`deno check`コマンドでTypeScriptの`compilerOptions.rootDirs`がサポートされました。

### npmの依存解決失敗時のエラーの改善

`deno check`コマンドにおいて、npmの依存関係の解決に関するエラーが`tsc`と同様の形式で表示されるよう改善されています。

## `deno compile`

### sloppy importsのサポート

`deno compile`が[sloppy imports]({{< ref "articles/deno/v1.39.md" >}})を認識してくれるよう改善されています。

sloppy importsは`"unstable": ["sloppy-imports"]`や`--unstable-sloppy-imports`などで有効化できます。

## `deno jupyter`

### `GPUTexture`と`GPUBuffer`の表示がサポート

GPUTexture`は`image/png`, `GPUBuffer`は`text/plain`形式で解釈されるようです ([#28117](https://github.com/denoland/deno/pull/28117)に動画があります)
