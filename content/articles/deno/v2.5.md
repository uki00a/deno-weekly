---
title: Deno v2.5
tags:
  - Deno
categories:
  - release
date: 2025-09-14
description: Deno v2.5がリリース (`Deno.bundle()`が追加, `deno bundle`でHTMLエントリーポイントがサポート, `deno lint`に`no-import-prefix`及び`no-unversioned-import`ルールが追加, `deno install` - インストール結果やライフサイクルスクリプトに関するレポートの改善, 引数なしで`deno run`を実行した際のタスクの一覧表示機能が再導入, `deno check` - SvelteKit向けの機能改善, `deno.json`でのパーミッションの定義がサポート, `DENO_AUDIT_PERMISSIONS`環境変数の導入, `Deno.ChildProcess`の`stdout`と`stderr`に`Response`ライクな問い合わせメソッドが追加, `Deno.test`に`before*`/`after*`フックが追加, `Deno.serve()`などに`tcpBacklog`オプションが追加, `WebSocket`に`headers`オプションが追加, TypeScript 5.9へのアップデート, V8 14.0.0へのアップデート, `--unstable-node-globals`の再導入, `bundleDependencies`のサポート, など)
---

## はじめに

Deno v2.5がリリースされました。

この記事では主な変更点などについて解説します。

### `deno bundle`

### `Deno.bundle()`APIが追加

`deno bundle`コマンドの機能をプログラムから利用するための`Deno.bundle()`APIが正式にリリースされました ([#29949](https://github.com/denoland/deno/pull/29949))

`Deno.bundle()`を利用するためには`--unstable-bundle`によって明示的に有効化が必要です:

```typescript
const result = await Deno.bundle({
  entrypoints: ["./mod.ts"],
  platform: "deno",
});
console.assert(result.success);

const [outputFile] = result.outputFiles;
const bundledCode = outputFile.text();
console.assert(typeof bundledCode === "string");
```

`outputPath`や`outputDir`オプションを指定することで、バンドル結果がファイルシステムへ書き込まれます (`--allow-write`の指定は不要なようです):

```typescript
const result = await Deno.bundle({
  entrypoints: ["./mod.ts"],
  platform: "browser",
  minify: true,
  sourcemap: "external",
  outputDir: "dist",
});
console.assert(result.success);
```

### HTMLエントリーポイントのサポート

`deno bundle`でHTMLエントリーポイントのサポートが追加されています ([#29856](https://github.com/denoland/deno/pull/29856))

例として、バンドル対象のHTMLとJavaScriptモジュールを準備しておきます。

```html
<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
</head>
<body>
  <script type="module" src="./index.tsx"></script>
</body>
</html>
```

```tsx
// index.tsx
import { render } from "preact";

function App() {
  return (
    <main>
      Hello Deno!
    </main>
  );
}

render(<App />, document.body);
```

Preactがきちんと動作するよう`deno.json`に設定を追加しておきます。

```json
{
  "imports": {
    "preact": "npm:preact@10.27.1",
    "@std/http": "jsr:@std/http@1.0.20"
  },
  "compilerOptions": {
    "jsx": "react-jsx",
    "jsxImportSource": "preact",
    "lib": [
      "dom",
      "dom.asynciterable",
      "dom.iterable"
    ]
  },
  "exclude": ["dist"]
}
```

この状態でHTMLファイルを引数に指定して`deno bundle`を実行すると、`--outdir`ディレクトリにバンドル結果が出力されます。

```shell
$ deno bundle --unstable-bundle --outdir=dist index.html
⚠️  deno bundle is experimental and subject to changes
Bundled 4 modules in 43ms
  dist/index-2G6XNFTT.js 15.73KB
  dist/index.html        166B

# `deno_std`のファイルサーバー (`@std/http/file-server`) で結果を確認できます
$ deno run --allow-read --allow-net @std/http/file-server dist
```

### `deno lint`

### `no-import-prefix`ルール

`no-import-prefix`ルールが追加されています ([#30598](https://github.com/denoland/deno/pull/30598))

以下のように`jsr:`や`npm:`付きの`import`の使用が検出されると、エラーが発生します。

```javascript
import { delay } from "jsr:@std/async@^1/delay";
```

`deno.json`または`package.json`で依存パッケージを管理することを促すためのルールのようです。

### `no-unversioned-import`ルール

`no-unversioned-import`ルールが追加されています ([#30609](https://github.com/denoland/deno/pull/30609))

以下のように、バージョンが明示されていない`import`を検出してくれます。

```javascript
import { delay } from "jsr:@std/async/delay";
```

## `deno fmt`

### 引数なしで`deno fmt`を実行した際の振る舞いが変更

`deno.json`および`package.json`が存在しない状態で`deno fmt`を実行すると、以下の確認メッセージが表示されるよう挙動が変更されています ([#30623](https://github.com/denoland/deno/pull/30623))

```shell
$ deno fmt
Warning It looks like you're not in a workspace. Are you sure you want to format the entire '/path/to/current-dir' directory? [Y/n]
```

### `import`/`export`への`fmt.spaceSurroundingProperties`のサポート

`deno.json`における`"fmt.spaceSurroundingProperties": false`の設定が`import`および`export`にも適用されるよう改善されました ([#30371](https://github.com/denoland/deno/pull/30371))

```json
{
  "fmt": {
    "spaceSurroundingProperties": false
  }
}
```

```javascript
// 1. フォーマット前
import { delay } from "jsr:@std/async@^1/delay";

// 2. フォーマット後
import {delay} from "jsr:@std/async@^1/delay";
```

### `deno install`/`deno add`

### 出力内容の改善

[Deno v2.4.5]({{< ref "articles/2025/08/24.md" >}})における`deno install`コマンドの出力の改善に続いて、パッケージのインストールに要した時間やキャッシュから再利用されたパッケージ数なども表示されるよう改善されています ([#30615](https://github.com/denoland/deno/pull/30615))

```shell
$ deno install
Installed 9 packages in 1631ms
Reused 0 packages from cache
Downloaded 9 packages from JSR
+++++++++
Downloaded 0 packages from npm

Dependencies:
+ jsr:@david/dax 0.41.0
+ jsr:@david/which 0.4.1
+ jsr:@std/assert 0.221.0
+ jsr:@std/bytes 0.221.0
+ jsr:@std/fmt 0.221.0
+ jsr:@std/fs 0.221.0
+ jsr:@std/io 0.221.0
+ jsr:@std/path 0.221.0
+ jsr:@std/streams 0.221.0
```

また、このインストール結果の表示機能を引数付きの`deno install`や`deno add`, `deno cache`コマンドなどにも導入する改善が実施されています ([#30549](https://github.com/denoland/deno/pull/30549))

### ライフサイクルスクリプトに関する警告メッセージの改善

[ライフサイクルスクリプト]({{< ref "articles/deno/v1.45.md" >}})を提供するnpmパッケージをインストールした際の警告メッセージが改善されています ([#30527](https://github.com/denoland/deno/pull/30527))

```shell
$ deno add npm:better-sqlite3@12.2.0
Add npm:better-sqlite3@12.2.0
╭ Warning
│
│  Ignored build scripts for packages:
│  npm:better-sqlite3@12.2.0
│
│  Lifecycle scripts are only supported when using a `node_modules` directory.
│  Enable it in your deno config file:
│  "nodeModulesDir": "auto"
╰─
```

### jsrパッケージのインストールに関するバグ修正

`deno.json`でjsrパッケージのバージョンを更新した状態で引数なしで`deno install`が実行された際に、該当jsrパッケージの更新後のバージョンをインストールするよう挙動が修正されています ([#30483](https://github.com/denoland/deno/pull/30483))

## `deno run`/`deno task`

### 引数なしで実行した際のタスクの一覧表示機能が再導入

[Deno v2.0.0-rc.3]({{< ref "articles/2024/09/22.md" >}})で Revert されていた引数なしで`deno run`コマンドが実行された際に`deno.json`で定義されたタスクの一覧を表示する機能が再導入されました ([#30592](https://github.com/denoland/deno/pull/30592))

### タスク名とディレクトリ名の衝突時の挙動が改善

`deno run <task>`で指定したタスク名と同じ名前のディレクトリが存在する場合、エラーが発生してしまう問題が修正されています ([#29538](https://github.com/denoland/deno/pull/29538))。この場合、`deno.json`で定義されたタスクの方が実行されます。

### `--env-file`と`--watch`を併用した際の挙動の改善

`--env-file`と`--watch`の併用時に、`.env`ファイルが変更された際にプロセスの再起動と`.env`ファイルの再読み込みが行われるよう改善されています ([#30197](https://github.com/denoland/deno/pull/30197))

### `--preload`で複数のファイルを読み込ませる際の挙動の変更

[`--preload`]({{< ref "articles/deno/v2.4.md" >}})オプションに`data:`URLを指定できるようにするため、`--preload`オプションに複数のファイルをカンマ区切りで指定できないよう挙動が変更されています ([#30544](https://github.com/denoland/deno/pull/30544))

`--preload`オプションで複数のファイルを読み込ませたい場合、今後は`--preload`オプションを複数回指定する必要がありそうです。

### `deno check`

主にSvelteKit向けの動作の改善が実施されているようです。

### `tsconfig.json` - `compilerOptions.rootDirs`のサポート

`deno check`コマンドで[`tsconfig.json`]({{< ref "articles/deno/v2.4.md" >}})に記載された`compilerOptions.rootDirs`がサポートされています ([#30495](https://github.com/denoland/deno/pull/30495))

### `compilerOptions.moduleResolution: "bundler"`のサポート

 [`compilerOptions.moduleResolution: "bundler"`](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-5-0.html#--moduleresolution-bundler)がサポートされています。`compilerOptions.module`に`esnext`または`preserve`が指定された際は、`compilerOptions.moduleResolution`のデフォルト値として`bundler`が使用されるよう実装されています ([#30603](https://github.com/denoland/deno/pull/30603))

## `deno publish`

### `import.meta.resolve()`の取り扱いの改善

静的に解析可能な`import.meta.resolve()`の引数が正規化 (_unfurl_) されるよう改善されています ([#30663](https://github.com/denoland/deno/pull/30663))

具体的には、パッケージの公開時に以下のような変換が実施されるようです。

```javascript
// 1. `deno publish`の実行前
import.meta.resolve("preact");

// 2. `deno publish`によるJSRへの公開後 (Import mapsの内容に基づいて、specifierが正規化されます)
import.meta.resolve("npm:preact@10.27.1");
```

## `deno lsp`

### ワークスペースメンバーの取り扱いの改善

ワークスペース内のメンバーのImport mapsで定義されたエントリーへのauto importがサポートされています ([#30667](https://github.com/denoland/deno/pull/30667))

### ファイルリネーム時の挙動の改善

あるファイルを別ディレクトリへ移動した際の`import`の書き換えが適切に動作するよう改善されています ([#30628](https://github.com/denoland/deno/pull/30628))

### `deno init`

### `--npm`オプション指定時の依存関係の取り扱いの変更

`deno init --npm`の実行時にカレントディレクトリではなく`/tmp/deno_init_nm/<date>/<random>`に作成した一時的な`node_modules`ディレクトリを利用するよう挙動が変更されています ([#30492](https://github.com/denoland/deno/pull/30492))

その他のパッケージマネージャーも同様の実装をしているようで、それにあわせることなどが目的のようです。

## Permissions

### `deno.json`でのパーミッションの定義がサポート (`--permission-set`)

`deno.json`でパーミッションを定義する機能 (`--permission-set`)が実装されています。

`deno.json`の`permissions`でパーミッションセットを定義できます:

```json
{
  "permissions": {
    "default": {
      "net": true
    },
    "server": {
      "net": true,
      "read": ["data.txt"]
    }
  }
}
```

定義したパーミッションセットは`--permission-set`で適用することが可能です:

```shell
# (1) `permissions.default`を適用します
$ deno --permission-set main.js

# (2) `-P`は`--permission-set`の短縮形式です
$ deno -P main.js

# (3) `permissions.server`を適用します
$ deno --permission-set=server main.js
```

また、`deno bench`/`deno compile`/`deno test`の各コマンド向け専用のパーミッションセットを定義することも可能で、`deno.json`の対応するセクション配下の`permissions`で定義できます:

```json
{
  "test": {
    "permissions": {
      "read": ["data.txt"]
    }
  }
}
```

```shell
# `test.permissions`を適用します
$ deno test --permission-set main.js
```

---

- **公式ドキュメント**: https://github.com/denoland/docs/commit/1f0139f05c2d1d45b90e0b5dd701607d664766f7

### `DENO_AUDIT_PERMISSIONS`

`DENO_AUDIT_PERMISSIONS`環境変数がサポートされました ([#30575](https://github.com/denoland/deno/pull/30575))

この環境変数にパスを指定しておくと、jsonl形式でアプリケーションの実行中に要求されたパーミッションが記録されます:

```shell
# 1. アプリケーション実行時に`DENO_AUDIT_PERMISSIONS`にパスを指定しておきます
$ DENO_AUDIT_PERMISSIONS=permissions.jsonl deno run -A main.js

# 2. 指定されたパスに要求されたパーミッション情報が記録されます
$ jq 'pick(.permission, .value)' --compact-output permissions.jsonl
{"permission":"read","value":"README.md"}
{"permission":"write","value":"README.md"}
{"permission":"read","value":"Makefile"}
{"permission":"write","value":"Makefile"}
```

書き込まれるJSONのスキーマは[cli/schemas/permission-audit.v1.json](https://github.com/denoland/deno/blob/e02e4c2042d4cc87206683dfe2e8d0abab350f54/cli/schemas/permission-audit.v1.json)で定義されています。

また、[`DENO_TRACE_PERMISSIONS=1`]({{< ref "articles/deno/v2.1.md" >}})を設定しておくと、`DENO_AUDIT_PERMISSIONS`で指定されたパスの各レコードに追加で`stack`プロパティーが追加され、より詳細に情報が記録されます。

---

- 公式ドキュメント: https://github.com/denoland/docs/commit/6003ed865d10198f2140aba32e2c9b83198966c6

## Deno API

### `Deno.ChildProcess.{stdout,stderr}`への`Response`ライクな問い合わせメソッドの追加

`Deno.ChildProcess.stdout`と`Deno.ChildProcess.stderr`に以下の4つのメソッドが追加されています:

- `arrayBuffer`
- `bytes`
- `json`
- `text`

[`Response`](https://developer.mozilla.org/en-US/docs/Web/API/Response)ライクに子プロセスの出力内容を問い合わせることができます。

```javascript
const command = new Deno.Command(Deno.execPath(), {
  args: ["json_reference"],
  stdout: "piped",
}).spawn();
const json = await command.stdout.json();
```

---

- **公式ドキュメント**: https://github.com/denoland/docs/commit/37bb3db3d38e00a5de69617421919e5204633593

### `Deno.test`への`before*`/`after*`フックのサポート

以下の4つのAPIが追加されています:

- `Deno.test.beforeAll()`
- `Deno.test.afterAll()`
- `Deno.test.beforeEach()`
- `Deno.test.afterEach()`

VitestやJestなどと同様に、これらのAPIを利用することで該当モジュールにおける各テストケースの実行前後に特定の処理を実行することができます:

```javascript
Deno.test.beforeEach(() => setup());
Deno.test.afterEach(() => teardown());
Deno.test("doSomethingAsync", async () => {
  await doSomethingAsync();
  // ...
});
```

---

- **公式ドキュメント**: https://github.com/denoland/docs/commit/dc96c8aa5e8070d8ab21913bb8cd64fb874af497

### `tcpBacklog`オプションの追加

[Deno v2.4.5]({{< ref "articles/2025/08/24.md" >}})におけるTCPソケットの`backlog`パラメータの変更に続けて、以下のAPIに`tcpBacklog`オプションが追加されています ([#30541](https://github.com/denoland/deno/pull/30541))

- `Deno.serve()`
- `Deno.listen()`
- `Deno.listenTls()`

`tcpBacklog`オプションのデフォルト値は`511`です。

### `unsafelyDisableHostnameVerification`オプションの追加

`Deno.connectTls()`と`Deno.startTls()`に`unsafelyDisableHostnameVerification`オプションが追加されています ([#30409](https://github.com/denoland/deno/pull/30409))

このオプションに`true`を設定すると、ホスト名の検証が無効化されます。

### `Deno.QuicListener`に関する破壊的変更

[`Deno.QuicListener`]({{< ref "articles/2025/01/12.md" >}})が`Deno.QuicConn`ではなく`Deno.QuicIncoming`を`yield`するように修正されています ([#30150](https://github.com/denoland/deno/pull/30150))

## Web API

### `WebSocket`

`WebSocket`に`headers`オプションが追加されています ([#30321](https://github.com/denoland/deno/pull/30321))

これはDeno独自のオプションのようで、WebSocket接続の確立時に送信されるHTTPヘッダーをカスタマイズできます。

### `fetch()`

`HTTPS_PROXY`などのプロキシー関連の環境変数で[`unix:`]({{< ref "articles/2025/05/18.md" >}})や[`vsock:`]({{< ref "articles/2025/06/15.md" >}})形式のURLがサポートされています ([#30377](https://github.com/denoland/deno/pull/30377))

## TypeScript 5.9

Deno内部のTypeScriptが`5.8.3`から`5.9.2`へアップデートされています ([#30601](https://github.com/denoland/deno/pull/30601))

これにあわせて`TypedArray`に関連した型定義が更新されています ([#30640](https://github.com/denoland/deno/pull/30640), [#30434](https://github.com/denoland/deno/pull/30434), [#30435](https://github.com/denoland/deno/pull/30435))

---

- [Announcing TypeScript 5.9](https://devblogs.microsoft.com/typescript/announcing-typescript-5-9/)

## V8 14.0.0

Deno内部のV8が14.0.0へアップデートされています ([#30629](https://github.com/denoland/deno/pull/30629))

これに伴い、廃止されたTemporal APIに関するDeno内部に存在していたパッチ処理が削除されています。Denoの公式ブログ記事によると、もうまもなく`--unstable-temporal`オプションを削除することが検討されているようです。

## Node.js互換性の改善

### `--unstable-node-globals`の再導入

[Deno v2.4]({{< ref "articles/deno/v2.4.md" >}})で非推奨化されていた`--unstable-node-globals`が再導入されています。今回のリリースでは、`--unstable-node-globals`を指定した際に`setTimeout`や`setInterval`を`node:timers`のものに置き換える機能が導入されています  ([#29993](https://github.com/denoland/deno/pull/29993))

### `bundleDependencies`のサポート

Denoが[`bundleDependencies`](https://github.com/npm/documentation/blob/257ef1a088062d55a86afb98ba96d870c941113c/content/cli/v11/configuring-npm/package-json.mdx#bundledependencies) (`bundledDependencies`) が定義されたnpmパケージを適切に取り扱うよう改善されています ([#30521](https://github.com/denoland/deno/pull/30521))

### `node:sqlite`

`DatabaseSync`に `Symbol.for("sqlite-type")`プロパティーが定義されています ([#30511](https://github.com/denoland/deno/pull/30511))

Node.jsにはSQLite向けに様々なドライバーが存在しており、どのドライバーを使用しているのかを判断しやすくすることが目的のようです。`bun:sqlite`の`Database`にも同様のプロパティーを追加するPRが作成されているようです ([oven-sh/bun#22109](https://github.com/oven-sh/bun/pull/22109))

### `node:fs`

WindowsにおいていくつかのAPIで必要以上にパーミッションが要求されていた問題が修正されています ([#30535](https://github.com/denoland/deno/pull/30535))

また、以下のAPIの互換性が改善されています:

- `symlink()` - Windowsにおける互換性の改善 ([#30555](https://github.com/denoland/deno/pull/30555))
- `exists()` - 不正なシンボリックリンクの取り扱いが改善 ([#30507](https://github.com/denoland/deno/pull/30507))
- `mkdtemp()` - `Buffer`や`Uint8Array`形式でのパスの指定がサポート ([#30602](https://github.com/denoland/deno/pull/30602))

### `node:http`

`Server#listen`で`signal`オプションがサポートされています ([#30515](https://github.com/denoland/deno/pull/30515))

また、`ServerResponse#setHeaders`が実装されています ([#30586](https://github.com/denoland/deno/pull/30586))

### `node:https`

`request()`から返却される`ClientRequest`の`socket.authorized`が`true`に設定されるよう改善されています ([#30641](https://github.com/denoland/deno/pull/30641))

この改善によって、Yarn v1の`add`コマンドが動作するようです。

### `node:tls`

`TLSSocket`の`socket`引数において`net.Socket`以外の`stream.Duplex`の指定がサポートされています ([#30465](https://github.com/denoland/deno/pull/30465))

この改善により[mssql](https://github.com/tediousjs/node-mssql)パッケージにおいて接続時にエラーが発生する問題が修正されているようです。

### `node:child_process`

`deno init --npm`で[`@angular/create`](https://www.npmjs.com/package/@angular/create)などのモジュール内のJavaScriptファイルをサブプロセスとして実行するパッケージが動作するよう、`spawn()`などによって`node_modules`内のスクリプトを実行する際にnpmパッケージに関する依存関係の解決情報 ([`DENO_DONT_USE_INTERNAL_NODE_COMPAT_STATE_FD`](https://github.com/denoland/deno/blob/9e2472afc072fdbca49b3de7ccbb4beedf59fc6a/libs/npm_installer/process_state.rs#L27)) を引き継ぐように改善されています。([#30490](https://github.com/denoland/deno/pull/30490))

また、`fork()`がNode.jsの`--experimental-*`オプションを無視するよう挙動が修正されています ([#26351](https://github.com/denoland/deno/pull/26351))

### `node:path`

以下のAPIの互換性が改善されています:

- `resolve()` ([#30503](https://github.com/denoland/deno/pull/30503))
- `normalize()` ([#30537](https://github.com/denoland/deno/pull/30537))
- `relative()` ([#30566](https://github.com/denoland/deno/pull/30566))

### `node:crypto`

`hkdfSync()`に`Uint8Array`以外の`TypedArray`が渡されると、間違った結果を返す問題が修正されています ([#30463](https://github.com/denoland/deno/pull/30463))

### `node:async_hooks`

`AsyncHook`による`process.nextTick()`の追跡がサポートされています ([#30578](https://github.com/denoland/deno/pull/30578))

### Node-API

`napi_create_external_buffer()`の`finalize_cb`に`NULL`を渡せるよう改善されています ([#30514](https://github.com/denoland/deno/pull/30514))

## 参考

- https://deno.com/blog/v2.5
- https://github.com/denoland/deno/releases/tag/v2.5.0
