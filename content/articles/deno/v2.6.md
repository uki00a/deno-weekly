---
title: Deno v2.6
tags:
  - Deno
categories:
  - release
date: 2025-12-14
description: Deno v2.6がリリース
---

## はじめに

Deno v2.6がリリースされました。

この記事では主な変更点などについて紹介します。

## `deno x`

`deno x`コマンドが追加されています ([#31138](https://github.com/denoland/deno/pull/31138))

このコマンドを使うことで、`npx`のように指定したパッケージをインストールし、実行することができます。

```shell
$ deno x cowsay@1.6.0 hi
 ____
< hi >
 ----
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
```

インストールされたパッケージは`$DENO_DIR/deno_x_cache`に保存されます。`$DENO_DIR/deno_x_cache/<package-dir>/deno.lock`を作成することで、パッケージの依存関係を固定してくれます。

また、パーミッションフラグの指定も可能です (デフォルトでは `--allow-all` が指定されます)

```shell
$ deno x --ignore-env --allow-read cowsay@1.6.0 hi
```

ネイティブバイナリーを実行する場合は`--allow-run`が要求されます。

```shell
$ deno x --deny-run esbuild --version
error: Requires run access to "/path/to/.deno/esbuild@0.27.1/node_modules/esbuild/bin/esbuild", run again with the --allow-run flag
```

デフォルトではnpmパッケージが実行されますが、`jsr:`を指定することでjsrパッケージの実行も可能です。

```shell
$ deno x --allow-read=deno.json jsr:@uki00a/deno-json-lint@0.3.0
```

引数なしで `deno x` を実行すると、プロジェクト内で認識されているコマンドの一覧を表示できます。

```shell
$ deno x
Available (local) commands:
  esbuild

$ deno x
No local commands found
```

`deno x --install-alias`を実行すると、`dx`という名前のシンボリックリンクを作成してくれます。`dx`は`deno x`へのエーリアスとして機能してくれます。

```shell
$ dx --ignore-env -R cowsay@1.6.0 hi
```

## `deno approve-scripts`

`deno approve-scripts`コマンドが追加されています ([#31472](https://github.com/denoland/deno/pull/31472), [#31493](https://github.com/denoland/deno/pull/31493))

これはpnpmにおける[pnpm approve-builds](https://github.com/pnpm/pnpm/releases/tag/v10.1.0)コマンドに相当する機能で、`deno.json`の[`allowScripts`]({{< ref "articles/2025/11/16.md" >}})フィールドを更新することで、ライフサイクルスクリプトの実行を許可するnpmパッケージを指定することができる機能です。

```shell
# (1) ライフサイクルスクリプトを持つパッケージをインストールします
$ deno install npm:better-sqlite3@12.2.0
Add npm:better-sqlite3@12.2.0
╭ Warning
│
│  Ignored build scripts for packages:
│  npm:better-sqlite3@12.2.0
│
│  Run "deno approve-scripts" to run build scripts.
╰─

# (2) 対話的に特定パッケージに対するライフサイクルスクリプトの実行を許可できます
$ deno approve-scripts
? Select which packages to approve lifecycle scripts for
(<space> to select, ↑/↓/j/k to navigate, a to select all, i to invert selection, enter to accept, <Ctrl-c> to cancel)
❯ ○ npm:better-sqlite3@12.2.0

# (3) `deno.json`の`allowScripts`が更新されます
$ cat deno.json | jq .allowScripts
[
  "npm:better-sqlite3@12.2.0"
]
```

## `deno audit` - `socket.dev`との統合

[Deno v2.5.5]({{< ref "articles/2025/11/02.md" >}})で実装された`deno audit`コマンドで`--socket`オプションがサポートされています ([#31106](https://github.com/denoland/deno/pull/31106))

このオプションを指定すると[socket.dev](https://socket.dev/)との統合が有効化されます。具体的には`deno audit`でデフォルトで利用される[Full Audit エンドポイント](https://github.com/npm/npm-audit-report/blob/fbdb240694bd9a8d95e9386a157d471494a1426c/README.md#break-from-version-1) (`/-/npm/v1/security/audits`) ではなく、[`@socketsecurity/bun-security-scanner`](https://www.npmjs.com/package/@socketsecurity/bun-security-scanner)でも使用されている[`firewall-api.socket.dev`](https://github.com/SocketDev/bun-security-scanner/blob/037562d18ed7460a95f91f7a4806ad627756437f/src/modes/unauthenticated.ts#L10)エンドポイントを使用してパッケージの検査が行われます。

また、`SOCKET_API_KEY`環境変数を指定した場合、それで設定されたAPIキーを使用して`https://api.socket.dev/v0/purl`エンドポイントによる検査が行われます ([#31370](https://github.com/denoland/deno/pull/31370))

## Permissions - `--ignore-read`/`--ignore-env`オプションの追加

`--ignore-read`オプション ([#31363](https://github.com/denoland/deno/pull/31363)) と`--ignore-env`オプション ([#31187](https://github.com/denoland/deno/pull/31187)) が実装されています。

これらのオプションはそれぞれ指定されたファイルまたは環境変数を存在しないものとして扱いたい場合に利用できます。

`--ignore-read`オプションで無視されたファイルを読もうとすると、`Deno.errors.NotFound`が発生します。

```shell
$ cat main.js
console.info(await Deno.readTextFile("./README.md"));

$ file README.md
README.md: ASCII text

$ deno run --ignore-read=README.md main.js       
error: Uncaught (in promise) NotFound: No such file or directory (os error 2)
console.info(await Deno.readTextFile("./README.md"));
  ...
```

`--ignore-env`によって指定された環境変数については常に未定義として扱われます。

```shell
# `main.js`
$ cat main.js
console.info("HOME", Deno.env.get("HOME"));
console.info("FOO", Deno.env.get("FOO"));

# (1) `HOME`環境変数のみを無視する
$ FOO=1 deno run --allow-env --ignore-env=HOME main.js
HOME undefined
FOO 1

# (2) すべての環境変数を無視
$ FOO=1 deno run --ignore-env main.js 
HOME undefined
FOO undefined
```

これらのオプションについては`deno.json`のパーミッションセットの定義においてもサポートされています。

```json
{
  "permissions": {
    "default": {
      "env": { "ignore": true }
    }
  }
}
```

## `deno publish` - `"publish": false`がサポート

`deno.json`で`"publish": false`の設定がサポートされています ([#30852](https://github.com/denoland/deno/pull/30852))

この設定を行っておくと、該当のパッケージが`deno publish`によってjsrに公開されなくなります。[ワークスペース]({{< ref "articles/deno/v1.45.md" >}})を採用したプロジェクトにおいて、公開したくないパッケージに対してこの設定を行うことが想定されています。

## `deno init`

### `deno init --empty`

`deno init`コマンドに`--empty`オプションが追加されています ([#31516](https://github.com/denoland/deno/pull/31516))

このオプションを指定すると`deno.json`と`main.ts`のみを生成してくれます。

```shell
$ deno init --empty

$ ls
deno.json  main.ts
```

### `deno init --npm --yes`

`deno init --npm`に`--yes`オプションが追加されています ([#31499](https://github.com/denoland/deno/pull/31499))

このオプションを指定すると確認プロンプト (`⚠️  Do you fully trust <package name> package? Deno will invoke code from it with all permissions. Do you want to continue? [y/n]`) がスキップされます。
