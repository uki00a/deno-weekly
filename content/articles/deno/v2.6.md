---
title: Deno v2.6
tags:
  - Deno
  - jsr
categories:
  - release
date: 2025-12-14
description: Deno v2.6がリリース (`deno x`コマンドが追加, `deno approve-scripts`コマンドが追加, `deno audit` - `socket.dev`との統合がサポート, `--ignore-read`/`--ignore-env`オプションの追加, `deno publish` - 公開したくないパッケージの指定がサポート, `deno init` - `--empty`オプションが追加, `deno init --npm` - `--yes`オプションが追加, `deno install -g`の挙動が変更, `--lockfile-only`オプションが追加, `deno lint` - プラグインでファイルと環境変数の読み込みがサポート, `deno bundle` - Androidでの利用がサポート, `Deno.bundle()`の`Worker`での利用がサポート, `deno lsp` - `source.organizeImports`におけるバグ修正, `deno check` - typescript-go連携におけるバグ修正, Source Phase Importsがサポート, `BroadcastChannel`が安定化, Streamの移譲がサポート, Float16Arrayがサポート, Deno本体に`@types/node`がバンドル, `--require`オプションが実装, Subpath importsで`#/`から始まるマッピングがサポート, Windows向けのshimの生成が改善, `node:sqlite` - `DatabaseSync`に`aggregate`や`function`メソッドが追加, `node:child_process` - Advanced serializationがサポート, ソースマップサポートの改善, など)
---

## はじめに

Deno v2.6がリリースされました。

この記事では主な変更点などについて紹介します。

## `deno x`

`deno x`コマンドが追加されています ([#31138](https://github.com/denoland/deno/pull/31138))

このコマンドを使うことで、`npx`のように指定したパッケージをインストールし、実行することができます。

```shell
$ deno x cowsay@1.6.0 hi
 ____
< hi >
 ----
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
```

インストールされたパッケージは`$DENO_DIR/deno_x_cache`に保存されます。`$DENO_DIR/deno_x_cache/<package-dir>/deno.lock`を作成することで、パッケージの依存関係を固定してくれます。

また、パーミッションフラグの指定も可能です (デフォルトでは `--allow-all` が指定されます)

```shell
$ deno x --ignore-env --allow-read cowsay@1.6.0 hi
```

ネイティブバイナリーを実行する場合は`--allow-run`が要求されます。

```shell
$ deno x --deny-run esbuild --version
error: Requires run access to "/path/to/.deno/esbuild@0.27.1/node_modules/esbuild/bin/esbuild", run again with the --allow-run flag
```

デフォルトではnpmパッケージが実行されますが、`jsr:`を指定することでjsrパッケージの実行も可能です。

```shell
$ deno x --allow-read=deno.json jsr:@uki00a/deno-json-lint@0.3.0
```

引数なしで `deno x` を実行すると、プロジェクト内で認識されているコマンドの一覧を表示できます。

```shell
$ deno x
Available (local) commands:
  esbuild


# コマンドが見つからない場合
$ deno x
No local commands found
```

`deno x --install-alias`を実行すると、`dx`という名前のシンボリックリンクを作成してくれます。`dx`は`deno x`へのエイリアスとして機能してくれます。

```shell
$ dx --ignore-env -R cowsay@1.6.0 hi
```

## `deno approve-scripts`

`deno approve-scripts`コマンドが追加されています ([#31472](https://github.com/denoland/deno/pull/31472), [#31493](https://github.com/denoland/deno/pull/31493))

これはpnpmにおける[pnpm approve-builds](https://github.com/pnpm/pnpm/releases/tag/v10.1.0)コマンドに相当する機能で、`deno.json`の[`allowScripts`]({{< ref "articles/2025/11/16.md" >}})フィールドを更新することで、ライフサイクルスクリプトの実行を許可するnpmパッケージを指定することができる機能です。

```shell
# (1) ライフサイクルスクリプトを持つパッケージをインストールします
$ deno install npm:better-sqlite3@12.2.0
Add npm:better-sqlite3@12.2.0
╭ Warning
│
│  Ignored build scripts for packages:
│  npm:better-sqlite3@12.2.0
│
│  Run "deno approve-scripts" to run build scripts.
╰─

# (2) 対話的に特定パッケージに対するライフサイクルスクリプトの実行を許可できます
$ deno approve-scripts
? Select which packages to approve lifecycle scripts for
(<space> to select, ↑/↓/j/k to navigate, a to select all, i to invert selection, enter to accept, <Ctrl-c> to cancel)
❯ ○ npm:better-sqlite3@12.2.0

# (3) `deno.json`の`allowScripts`が更新されます
$ cat deno.json | jq .allowScripts
[
  "npm:better-sqlite3@12.2.0"
]
```

## `deno audit` - `socket.dev`との統合

[Deno v2.5.5]({{< ref "articles/2025/11/02.md" >}})で実装された`deno audit`コマンドで`--socket`オプションがサポートされています ([#31106](https://github.com/denoland/deno/pull/31106))

このオプションを指定すると[socket.dev](https://socket.dev/)との統合が有効化されます。具体的には`deno audit`でデフォルトで利用される[Full Audit エンドポイント](https://github.com/npm/npm-audit-report/blob/fbdb240694bd9a8d95e9386a157d471494a1426c/README.md#break-from-version-1) (`/-/npm/v1/security/audits`) ではなく、[`@socketsecurity/bun-security-scanner`](https://www.npmjs.com/package/@socketsecurity/bun-security-scanner)でも使用されている[`firewall-api.socket.dev`](https://github.com/SocketDev/bun-security-scanner/blob/037562d18ed7460a95f91f7a4806ad627756437f/src/modes/unauthenticated.ts#L10)エンドポイントを使用してパッケージの検査が行われます。

また、`SOCKET_API_KEY`環境変数を指定した場合、それで設定されたAPIキーを使用して`https://api.socket.dev/v0/purl`エンドポイントによる検査が行われます ([#31370](https://github.com/denoland/deno/pull/31370))

## Permissions - `--ignore-read`/`--ignore-env`オプションの追加

`--ignore-read`オプション ([#31363](https://github.com/denoland/deno/pull/31363)) と`--ignore-env`オプション ([#31187](https://github.com/denoland/deno/pull/31187)) が実装されています。

これらのオプションはそれぞれ指定されたファイルまたは環境変数を存在しないものとして扱いたい場合に利用できます。

`--ignore-read`オプションで無視されたファイルを読もうとすると、`Deno.errors.NotFound`が発生します。

```shell
$ cat main.js
console.info(await Deno.readTextFile("./README.md"));

$ file README.md
README.md: ASCII text

$ deno run --ignore-read=README.md main.js
error: Uncaught (in promise) NotFound: No such file or directory (os error 2)
console.info(await Deno.readTextFile("./README.md"));
  ...
```

`--ignore-env`によって指定された環境変数については常に未定義として扱われます。

```shell
# `main.js`
$ cat main.js
console.info("HOME", Deno.env.get("HOME"));
console.info("FOO", Deno.env.get("FOO"));

# (1) `HOME`環境変数のみを無視する
$ FOO=1 deno run --allow-env --ignore-env=HOME main.js
HOME undefined
FOO 1

# (2) すべての環境変数を無視
$ FOO=1 deno run --ignore-env main.js 
HOME undefined
FOO undefined
```

これらのオプションについては`deno.json`のパーミッションセットの定義においてもサポートされています。

```json
{
  "permissions": {
    "default": {
      "env": { "ignore": true }
    }
  }
}
```

## `deno publish` - `"publish": false`がサポート

`deno.json`で`"publish": false`の設定がサポートされています ([#30852](https://github.com/denoland/deno/pull/30852))

この設定を行っておくと、該当のパッケージが`deno publish`によってjsrに公開されなくなります。[ワークスペース]({{< ref "articles/deno/v1.45.md" >}})を採用したプロジェクトにおいて、公開したくないパッケージに対してこの設定を行うことが想定されています。

## `deno init`

### `deno init --empty`

`deno init`コマンドに`--empty`オプションが追加されています ([#31516](https://github.com/denoland/deno/pull/31516))

このオプションを指定すると`deno.json`と`main.ts`のみを生成してくれます。

```shell
$ deno init --empty

$ ls
deno.json  main.ts
```

### `deno init --npm --yes`

`deno init --npm`に`--yes`オプションが追加されています ([#31499](https://github.com/denoland/deno/pull/31499))

このオプションを指定すると確認プロンプト (`⚠️  Do you fully trust <package name> package? Deno will invoke code from it with all permissions. Do you want to continue? [y/n]`) がスキップされます。

## `deno install`

### `deno install -g`における破壊的変更

`deno install -g`でインストールするスクリプトに対して引数を指定したい場合、`--`の指定が必須化されています ([#31292](https://github.com/denoland/deno/pull/31292))

```shell
$ deno install -g jsr:@std/http/file-server -- --allow-read --allow-net
```

この変更により、複数のスクリプトをまとめてインストールできるよう改善されています。

```shell
$ deno install -g jsr:@std/http/file-server jsr:@uki00a/deno-json-lint 
```

### `--lockfile-only`

`--lockfile-only`オプションが追加されています ([#31376](https://github.com/denoland/deno/pull/31376))

このオプションが指定されると、npmパッケージのインストールはせずに`deno.lock`の更新のみが行われます (`"nodeModulesDir": "auto"`が設定されていたとしても`node_modules`が更新されません)

```shell
$ deno install --lockfile-only npm:esbuild
```

## `deno lint` - プラグインでファイルと環境変数の読み込みがサポート

[プラグイン]({{< ref "articles/deno/v2.2.md" >}})で環境変数やファイルの読み込みがサポートされています ([#31327](https://github.com/denoland/deno/pull/31327))

特にオプションを指定せずとも、あらかじめ`--allow-env`及び`--allow-read`が指定されている場合と同様に動作します。

## `deno bundle`

Androidにおける利用 ([#31521](https://github.com/denoland/deno/pull/31521)) 及び `Worker`内での`Deno.bundle()`の利用 ([#31316](https://github.com/denoland/deno/pull/31316)) がサポートされています。

また、`bun:` specifierが検出された際に常にexternalモジュールとして扱われるように挙動が修正されています ([#31411](https://github.com/denoland/deno/pull/31411))

## `deno lsp` におけるバグ修正

### `source.organizeImports`

[`source.organizeImports`]({{< ref "articles/2025/11/02.md" >}})コードアクションにおいて[ワークスペース]({{< ref "articles/deno/v1.45.md" >}})内のパッケージに対するspecifierが書き換えられてしまう問題が修正されています ([#31230](https://github.com/denoland/deno/pull/31230))

また、[vscode_deno](https://github.com/denoland/vscode_deno)において _Organize imports_ アクションが重複して表示される問題が修正されています ([#31530](https://github.com/denoland/deno/pull/31530))

### `textDocument/definition`

Denoのグローバルキャッシュを利用している場合、npmパッケージ内において定義先へのジャンプ (`textDocument/definition`) が動作しなかった問題が修正されています ([#31377](https://github.com/denoland/deno/pull/31377))

## `deno test` - JUnitレポーターのバグ修正

JUnitレポーター (`--reporter junit`) においてANSIエスケープコードが取り除かれるよう修正されています ([#30854](https://github.com/denoland/deno/pull/30854))

## `deno check` - `typescript-go`連携におけるバグ修正

`typescript-go`を使用して型チェックを実行 ([`--unstable-tsgo`]({{< ref "articles/2025/11/02.md" >}})) する際に、`.css`などの非`.js`/`.ts`ファイルへのimportでエラーが発生しないよう改善されています ([#31478](https://github.com/denoland/deno/pull/31478))

### Source Phase Imports

[Source Phase Imports](https://github.com/tc39/proposal-source-phase-imports)が実装されています ([#31486](https://github.com/denoland/deno/pull/31486))

この機能を使うことで、例えば、以下のように`.wasm`モジュールを`WebAssembly.Module`として読み込むことができます。

```javascript
import source mathModule from "https://raw.githubusercontent.com/denoland/deno/refs/tags/v2.6.0/tests/testdata/wasm/math.wasm";

console.assert(mathModule instanceof WebAssembly.Module);

const instance = await WebAssembly.instantiate(mathModule);
console.assert(instance.exports.add(1, 2) === 3);
```

### Web API

### `BroadcastChannel`が安定化

`BroadcastChannel`が安定化されました。今後は`--unstable-broadcast-channel`の指定なしで利用できます ([#30770](https://github.com/denoland/deno/pull/30770))

### Streamの移譲がサポート

`ReadableStream`/`WritableStream`/`TransformStream`の[移譲](https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Transferable_objects)がサポートされています ([#31126](https://github.com/denoland/deno/pull/31126))

```javascript
using f = await Deno.open("README.md");
const clone = structuredClone({
  content: f.readable,
}, { transfer: [f.readable] });
for await (const chunk of clone.content) {
  // ...
}
```

### Float16Array

[Float16Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float16Array)がサポートされています ([#31410](https://github.com/denoland/deno/pull/31410))

また、`ImageData`に対する`Float16Array`のサポートも実施されています ([#31394](https://github.com/denoland/deno/pull/31394))

### その他の改善

`Worker`を作成し、その内部で`fetch()`を呼んでいるケースにおいて _Too many open files_ エラーが起きてしまうことのある問題への修正が実施されています ([#31375](https://github.com/denoland/deno/pull/31375))

`console.dir()`で`console.group()`によるインデントがサポートされています ([#31412](https://github.com/denoland/deno/pull/31412))

また、`NodeListOf`型に`[Symbol.iterator]()`メソッドの型定義が追加されています([#31384](https://github.com/denoland/deno/pull/31384))

## Node.js互換性の改善

### Deno本体に`@types/node`がバンドル

Deno本体に[`@types/node`](https://www.npmjs.com/package/@types/node)がバンドルされました ([#31502](https://github.com/denoland/deno/pull/31502))

今までは必要に応じて`@types/node`がダウンロードされていましたが、今後はデフォルトでDeno本体に内蔵された`@types/node`の定義が使用されます。

### `--require`

`--require`オプションが実装されています ([#31201](https://github.com/denoland/deno/pull/31201))

Node.jsにおける同名オプションと同様に、エントリーポイントを実行する前に指定されたCommonJSモジュールを事前に読み込むことができます。

```shell
# `main.js`の実行前に`setup.cjs`が実行されます
$ deno run --require=setup.cjs main.js
```

### Subpath importsで`#/`から始まるマッピングがサポート

[Subpath imports](https://github.com/nodejs/node/blob/4f24aff94ad9160bceaf9dcc9cf5235a65f01029/doc/api/packages.md#subpath-imports)で`#/`から始まるマッピングがサポートされています ([#31520](https://github.com/denoland/deno/pull/31520))

Node.jsの最近の変更に追従しているようです ([nodejs/node#60864](https://github.com/nodejs/node/pull/60864))

### Windows向けのshimの生成が改善

Windowsにおいて`node_modules/.bin`にnpmと同様の形式 ([cmd-shim](https://github.com/npm/cmd-shim)) でshimを生成するよう改善されています ([#31494](https://github.com/denoland/deno/pull/31494))

### `node:sqlite`

下記APIが追加されています。

- `DatabaseSync#aggregate()` ([#31461](https://github.com/denoland/deno/pull/31461))
- `DatabaseSync#function()` ([#31386](https://github.com/denoland/deno/pull/31386))
- `DatabaseSync#[Symbol.dispose]()` ([#31311](https://github.com/denoland/deno/pull/31311))
- `StatementSync#setAllowUnknownNamedParameters()` ([#31202](https://github.com/denoland/deno/pull/31202))

また、`StatementSync#iterate()`のバグが修正されています ([#31361](https://github.com/denoland/deno/pull/31361))。このメソッドを呼ぶ際に意図せず最後のクエリの実行結果が再利用されてしまっていたようです ([#30144](https://github.com/denoland/deno/issues/30144))。

### `node:fs/promises`

以下の改善が実施されています。

- `FileHandle#appendFile()`が実装 ([#31301](https://github.com/denoland/deno/pull/31301))
- `statfs()`が公開 ([#31528](https://github.com/denoland/deno/pull/31528))
- `FileHandle#readFile()` - `signal`オプションがサポート ([#31462](https://github.com/denoland/deno/pull/31462))
- `FileHandle#close()` - リソースをgracefulに解放するよう改善されています ([#31164](https://github.com/denoland/deno/pull/31164))

### `node:child_process`

Advanced serialization (`serialization: 'advanced'`) がサポートされています ([#31380](https://github.com/denoland/deno/pull/31380))

### `node:dns`

`lookupService()`が実装されています ([#31310](https://github.com/denoland/deno/pull/31310))

### `node:timers`

Node.jsとの互換性を改善するために`setImmediate()`が再実装されています ([#30328](https://github.com/denoland/deno/pull/30328))

また、`Timeout#refresh()`でメモリリークが発生しないようにする改善が実施されています ([#31436](https://github.com/denoland/deno/pull/31436))

### `node:crypto`

`Cipheriv`において自動的なパディング (`Cipheriv#setAutoPadding()`) が適切に動作するよう改善されています ([#31389](https://github.com/denoland/deno/pull/31389))

### `node:buffer`

`Buffer.compare()`及び`Buffer#compare()`の内部処理がRustで再実装され、パフォーマンスが改善されています ([#31425](https://github.com/denoland/deno/pull/31425))

## その他

### ソースマップサポートの改善

Denoが`//# sourceMappingURL=...`コメントを検出した際に、指定されたソースマップの内容を適用した上でスタックトレースを表示してくれるよう改善されています ([#31268](https://github.com/denoland/deno/pull/31268))

また、`process.sourceMapsEnabled`が定義されるように改善されています ([#31358](https://github.com/denoland/deno/pull/31358))

## 参考

この記事は以下のページを参考に記述されています。

- https://github.com/denoland/deno/releases/tag/v2.6.0
- https://deno.com/blog/v2.6
