---
title: 2025/11/10〜2025/11/16の最新情報
tags:
  - Deno
categories:
  - news
date: 2025-11-16
description: >
  Deno 3.0.0-rc.0 (グローバルのタイマーAPIがWeb標準ではなくNode.js互換のものへ変更, `--deny-*`と`--allow-*`併用時の挙動の変更, `allowScripts`フィールドのサポート, `deno compile`で`--preload`オプションがサポート, `Deno.kill()`および`Deno.ChildProcess#kill()`で数値によるシグナルの指定がサポート, `node:process` - GID/UID 関連のAPIが追加, など)
---

## Deno 3.0.0-rc.0

Deno 3.0.0-rc.0 がリリースされています ([#31258](https://github.com/denoland/deno/pull/31258))

- [v2.5.6 からの差分](https://github.com/denoland/deno/compare/12a6585c663d91c68d5215abf1607dd30c12c320...138b2e0e62d07a8786385cae46ac179afbf9973f)

まだ [dl.deno.land](https://dl.deno.land/) には公開されていないようなので、変わりに _canary_ バージョンで説明します (`3.0.0-rc.0+138b2e0`)

```shell
$ deno upgrade 138b2e0e
62d07a8786385cae46ac179afbf9973f
```

### 破壊的変更

下記のタイマーAPIがWeb標準ではなく、Node.js互換 (`node:timers`) のAPIへと置き換えられています ([#31272](https://github.com/denoland/deno/pull/31272))

- `setTimeout()`
- `setInterval()`
- `clearTimeout()`
- `clearInterval()`

`globalThis.setTimeout()`を実行すると、`number`型の値ではなく`Timeout`オブジェクトが返却されるよう挙動が変わります。

### パーミッション

`--deny-*`よりも`--allow-*`がより特定的であれば、`--allow-*`の方が優先されるよう挙動が変更されています ([#31224](https://github.com/denoland/deno/pull/31224))

```shell
# `docs/*`へのアクセスは拒否するが、`docs/foo.txt`についてのみ許可します (今までのバージョンでは`NotCapable`エラーが発生しました)
$ deno --allow-read=docs/foo.txt --deny-read=docs main.js
```

また、`--allow-env`と`--deny-env`を併用した際の`Deno.env.toObject()`および`process.env`の挙動が変更されています 。具体的には、以下のようにDenoを実行した際に、`Deno.env.toObject()`の返却結果から`DENO_DIR`と`DENO_INSTALL_ROOT`が除外されます ([#31267](https://github.com/denoland/deno/pull/31267))

```shell
$ deno run --allow-env --deny-env=DENO_DIR,DENO_INSTALL_ROOT main.js
```

### `allowScripts`

`deno.json`で`allowScripts`フィールドがサポートされています ([#31075](https://github.com/denoland/deno/pull/31075))

`allowScripts`の詳細については[先週のページ]({{< ref "articles/deno/v1.45.md" >}})を参照いただければと思います。

### `deno compile`

`deno compile` コマンドで[`--preload`]({{< ref "articles/deno/v2.4.md" >}})オプションがサポートされています。`--preload`で指定されたスクリプトは実行可能ファイル内に組み込まれ、生成された実行可能ファイルが実行される都度、自動で`--preload`オプションで指定されたスクリプトが適用されるようです ([#31152](https://github.com/denoland/deno/pull/31152))

### `deno repl`

`--eval-file`オプションで`=`の指定の省略がサポートされています ([#31151](https://github.com/denoland/deno/pull/31151))

```shell
$ deno repl --eval-file main.js
```

### `deno coverage`

`deno coverage --html`で生成されたHTMLレポートにダークモードとライトモードを切り替えるためのトグルが追加されています ([#31140](https://github.com/denoland/deno/pull/31140))

### スタックトレースの出力の改善

Denoがスタックトレースを出力する際にパスのカレントディレクトリ部分がグレーで表示されるよう変更されています ([#31194](https://github.com/denoland/deno/pull/31194))

また、視認性の改善のため、スタックフレーム中のDenoの内部コードに関する行をグレーで表示するよう改善されています ([#31247](https://github.com/denoland/deno/pull/31247))

### Deno API

`Deno.kill()`および`Deno.ChildProcess#kill()`でシグナルの数値での指定がサポートされています ([#31153](https://github.com/denoland/deno/pull/31153))

```javascript
const command = new Deno.Command("deno", {
  args: ["eval", "setTimeout(() => console.info('foo'), 5000)"],
  stdout: "inherit",
});
const child = command.spawn();
child.kill(9);
```

### Node.js互換性の改善

#### `node:process`

下記APIが実装されています:

- `ppid` ([#31137](https://github.com/denoland/deno/pull/31137))
- `process.setegid()` ([#31155](https://github.com/denoland/deno/pull/31155))
- `process.seteuid()` ([#31160](https://github.com/denoland/deno/pull/31160))
- `process.setgid()`/`process.setuid()` ([#31162](https://github.com/denoland/deno/pull/31162))
- `process.versions.sqlite` ([#31277](https://github.com/denoland/deno/pull/31277))

#### `node:fs`

`readFile()`で`flag`オプションがサポートされています ([#31129](https://github.com/denoland/deno/pull/31129))

#### `node:util`

`getSystemErrorMessage()`が実装されています ([#31147](https://github.com/denoland/deno/pull/31147))

#### `node:perf_hooks`

`performance.timerify()` が実装されています ([#31238](https://github.com/denoland/deno/pull/31238))

#### `node:crypto`

AES-GCM向けに`createCipheriv()`で`authTagLength`オプションがサポートされていまうｓ ([#31253](https://github.com/denoland/deno/pull/31253))

#### `node:worker_threads`

`Worker`で`exit`イベントが複数回発火されないよう修正されています ([#31231](https://github.com/denoland/deno/pull/31231))

#### Node-API

`Buffer`を作成する際に警告が表示される問題が修正されています ([#31245](https://github.com/denoland/deno/pull/31245))

### その他

Deno内部のV8のバージョンがv14.2へアップデートされています ([#31178](https://github.com/denoland/deno/pull/31178))
