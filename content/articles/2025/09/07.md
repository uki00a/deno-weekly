---
title: 2025/09/01〜2025/09/07の最新情報
tags:
  - Deno
  - deno_std
  - fresh
categories:
  - news
date: 2025-09-07
description: >
  Deno v2.5 向けの機能の追加について (`Deno.bundle()`APIが追加, `--permission-set`オプションが追加, など), `deno_std`のリリース (`@std/net@1.0.6` - `matchSubnets()`などのAPIが追加, `@std/streams@1.0.12` - `AbortStream`の非推奨化)
---

## Deno v2.5 向けの機能の追加について

### `Deno.bundle()`APIが追加

`deno bundle`コマンドの機能をプログラムから動的に利用するために、`Deno.bundle()`というAPIが追加されています。

- [feat(bundle): runtime API for deno bundle #29949](https://github.com/denoland/deno/pull/29949)

`Deno.bundle()`を利用するためには`--unstable-bundle`によって明示的に有効化が必要です:

```typescript
const result = await Deno.bundle({
  entrypoints: ["./mod.ts"],
  platform: "deno",
});
console.assert(result.success);

const [outputFile] = result.outputFiles;
const bundledCode = outputFile.text();
console.assert(typeof bundledCode === "string");
```

`outputPath`や`outputDir`オプションを指定することで、バンドル結果がファイルシステムへ書き込まれます (`--allow-write`の指定は不要なようです):

```typescript
const result = await Deno.bundle({
  entrypoints: ["./mod.ts"],
  platform: "browser",
  minify: true,
  sourcemap: "external",
  outputDir: "dist",
});
console.assert(result.success);
```

### `deno.json`でのパーミッションセットの定義 

`deno.json`でパーミッションセットの定義をサポートする機能がマージされています ([#30330](https://github.com/denoland/deno/pull/30330)):

```json
{
  "permissions": {
    "default": {
      "net": true
    },
    "server": {
      "net": true,
      "read": ["data.txt"]
    }
  }
}
```

定義したパーミッションセットは`--permission-set`で適用することが可能です:

```shell
# (1) `permissions.default`を適用します
$ deno --permission-set main.js

# (2) `--permission-set`は`-P`の短縮形式です
$ deno -P main.js

# (3) `permissions.server`を適用します
$ deno --permission-set=server main.js
```

また、`deno bench`/`deno compile`/`deno test`の各コマンド向け専用のパーミッションセットを定義することも可能で、`deno.json`の対応するセクション配下の`permissions`で定義できるようです ([以前]({{< ref "articles/2025/08/10.md" >}})は`deno.json`の`permissions.{compile,bench,test}`を特別扱いする想定で実装されていました):

```json
{
  "test": {
    "permissions": {
      "read": ["data.txt"]
    }
  }
}
```

```shell
# `test.permissions`を適用します
$ deno test --permission-set main.js
```

### `Deno.test`への`before*`/`after*`フックのサポート

[先週]({{< ref "articles/2025/08/31.md" >}})に紹介した`Deno.test`への`before*`/`after*`フックをサポートするPRがマージされています ([#30504](https://github.com/denoland/deno/pull/30504))

例えば、`Deno.test.beforeEach()`と`Deno.test.afterEach()`を使うことで、該当のテストモジュール内における各テストケースの実行前後に特定の処理を実行することができます:

```javascript
Deno.test.beforeEach(() => cleanup());
Deno.test.afterEach(() => teardown());
Deno.test("doSomethingAsync", async () => {
  await doSomethingAsync();
});
```

### `Deno.ChildProcess.{stdout,stderr}`への`Response`ライクな問い合わせメソッドの追加

[先週]({{< ref "articles/2025/08/31.md" >}})に紹介した`Deno.ChildProcess`に`Response`オブジェクトライクな問い合わせメソッドを追加するPRがマージされています ([#30552](https://github.com/denoland/deno/pull/30552)):

```javascript
const command = new Deno.Command(Deno.execPath(), {
  args: ["json_reference"],
  stdout: "piped",
}).spawn();
const json = await command.stdout.json();
```

## `deno_std`のリリース

`deno_std`のリリースが実施されています ([release-2025.09.04](https://github.com/denoland/std/releases/tag/release-2025.09.04))

### `@std/net@1.0.6`

[@std/net@1.0.6](https://jsr.io/@std/net@1.0.6)がリリースされています。

#### `@std/net/unstable-ip` - 新規APIの追加

`matchSubnets()`/`matchIPv4Subnet()`/`matchIPv6Subnet()`が追加されています。([#6786](https://github.com/denoland/std/pull/6786))

特定のアドレスがCIDR表記で指定されたサブネットにマッチするかどうかを検証できます。

### `@std/streams@1.0.12`

[@std/streams@1.0.12](https://jsr.io/@std/streams@1.0.12)がリリースされています。

#### `@std/streams/unstable-abort-stream`の非推奨化

[`AbortStream`]({{< ref "articles/2025/06/15.md" >}})が非推奨化されています ([#6799](https://github.com/denoland/std/pull/6799))。

[`ReadableStream#pipeThrough`の`signal`オプション](https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream/pipeThrough#signal)によって代用可能であることが理由のようです。

### `@std/toml@1.0.10`

[@std/toml@1.0.10](https://jsr.io/@std/toml@1.0.10)がリリースされています。

#### `@std/toml/parse`のバグ修正

`parse()`でネストされたテーブルの配列が適切に解析されるよう修正されています ([#6794](https://github.com/denoland/std/pull/6794))
