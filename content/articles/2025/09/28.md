---
title: 2025/09/22〜2025/09/28の最新情報
tags:
  - Deno
  - Deno Deploy
  - Deno KV
  - Prisma
categories:
  - news
date: 2025-09-28
description: >
  Deno v2.5.2 (`deno lsp` - BDDスタイルのテストケースの検出と実行がサポート, `deno bundle --watch`でHTMLエントリーポイントの再ビルドが適切に動作するよう改善, `deno check`で`compilerOptions.paths`がサポート, `Uint8Array`にBase64/Hex関連のAPIの型定義が追加, など), Deno の直近の変更やPRについて (パーミッションブローカー, `deno approve-scripts`コマンド, `deno.json`への`private: true`フィールドの追加), Deploy EA Databases へのデータベースのプロビジョニング機能のサポートについて
---

## Deno v2.5.2

[Deno v2.5.2](https://github.com/denoland/deno/releases/tag/v2.5.2)がリリースされています。

### `deno lsp`

`deno lsp`で`describe()`/`it()`で定義されたテストの検出と実行がサポートされています ([#30802](https://github.com/denoland/deno/pull/30802))

### `deno bundle`

`deno bundle --watch`に[HTMLエントリーポイント]({{< ref "articles/deno/v2.5.md" >}})を指定している場合、変更の検出時に出力されたHTMLファイルが適切にビルドされない問題が修正されています ([#30790](https://github.com/denoland/deno/pull/30790))

また、`deno bundle`で`--frozen`のサポートが追加されています ([#30825](https://github.com/denoland/deno/pull/30825))

### `deno coverage`

`Worker`内のコードに対してもカバレッジが計測されるよう改善されています ([#30807](https://github.com/denoland/deno/pull/30807))

### TypeScript

#### `compilerOptions.paths`のサポート

`deno check`コマンドで`compilerOptions.paths`がサポートされています ([#30766](https://github.com/denoland/deno/pull/30766))

#### `Uint8Array`に Base64/Hex 関連のAPIに関する型定義が追加

[Deno v2.5.0]({{< ref "articles/deno/v2.5.md" >}})におけるV8のアップデートに伴い、下記APIの型定義が追加されました ([#30686](https://github.com/denoland/deno/pull/30686)):

- [Uint8Array#toBase64()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array/toBase64)
- [Uint8Array#setFromBase64()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array/setFromBase64)
- [Uint8Array#toHex()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array/toHex)
- [Uint8Array#setFromHex()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array/setFromHex)
- [Uint8Array.fromBase64()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array/fromBase64)
- [Uint8Array.fromHex()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array/fromHex)

#### `Promise<undefined>` から `Promise<void>` への変更

TypeScript 公式の型定義に合わせて、以下の各プロパティーの型定義が `Promise<undefined>` から `Promise<void>` へ変更されています ([#30820](https://github.com/denoland/deno/pull/30820)):

- `ReadableStreamGenericReader#closed`
- `WritableStreamDefaultWriter#closed`
- `WritableStreamDefaultWriter#ready`
- `WebTransport#ready`

### WebSocket

[Deno 2.5.1]({{< ref "articles/2025/09/21.md" >}})から`WebSocket`の接続時に`User-Agent`ヘッダーが送信されなくなっていた問題が修正されています ([#30758](https://github.com/denoland/deno/pull/30758))

### `node:fs`

`statfs()`で`path`引数に`Buffer`の指定がサポートされています ([#30662](https://github.com/denoland/deno/pull/30662))

また、`readFile()`で`encoding: "binary"`の指定時に`String`を返すよう挙動が修正されています ([#30830](https://github.com/denoland/deno/pull/30830))

### `node:crypto`

`timingSafeEqual()`に`ArrayBuffer`のサポートが追加されています ([#30773](https://github.com/denoland/deno/pull/30773))

## Deno の直近の変更やPRについて

### パーミッションブローカー (`DENO_PERMISSION_BROKER_PATH`)

パーミッションブローカー という機能を実装するPRがマージされています。

- [feat(unstable): add permission broker #30826](https://github.com/denoland/deno/pull/30826)

`DENO_PERMISSION_BROKER_PATH`という環境変数が追加されており、この環境変数へUNIXドメインソケットのパスを指定することで、パーミッションブローカーが有効化されます。アプリケーションでパーミッションを要求するAPIが実行された際に、まずDenoはそのUNIXドメインソケットへJSON形式でメッセージを送信します (リクエストのスキーマ: [cli/schemas/permission-broker-request.v1.json](https://github.com/denoland/deno/blob/3d7e939b072b08d998e0045c70439cadb6a8e76c/cli/schemas/permission-broker-request.v1.json))

その後、DenoはUNIXドメインソケットからレスポンスが返却されるまで待機します (レスポンスのスキーマ: [cli/schemas/permission-broker-response.v1.json](https://github.com/denoland/deno/blob/3d7e939b072b08d998e0045c70439cadb6a8e76c/cli/schemas/permission-broker-response.v1.json))

レスポンスの`result`フィールドに`"deny"`が設定されていた場合、Denoは要求されたAPIの実行を拒否します。

この機能は _unstable_ という扱いのようなのでDeno v2.5.3あたりでリリースされる可能性がありそうです。

### `deno approve-scripts`コマンド

まだマージはされていませんが、`deno approve-scripts`というコマンドを実装する PR が作成されています:

- [feat(unstable): add `deno approve-builds` subcommand #30838](https://github.com/denoland/deno/pull/30838)

⚠️ **このコマンドはまだ実装途中であり、本機能の説明には[`5ff6aee`](https://github.com/denoland/deno/tree/5ff6aee74454d532f86b8bed97923f3270a1fcdd)のコミット時点の実装に基づいた推測も含まれます。**

このコマンドはライフサイクルスクリプトを提供するnpmパッケージの管理を行いやすくすることを目的としたもののようです。

まず、Denoが未実行のライフサイクルスクリプトを持つnpmパッケージを検出すると、`node_modules/.deno/.state.toml`の`ignored-scripts`に該当のパッケージを記録してくれるようです。

その後、`deno approve-scripts` コマンドの引数として`node_modules/.deno/.state.toml`に記録されたnpmパッケージを指定すると、`node_modules/.deno/.state.toml`の`ignored-scripts`から該当のパッケージが削除されます。

```shell
$ deno approve-scripts npm:esbuild
```

今回の修正において、`deno.json`に`install.approvedScripts`というフィールドが追加されており、ここに`deno approve-scripts`で許可したnpmパッケージを記録する想定のようです。`deno.json`の`install.approvedScripts`に記録されたnpmパッケージについては、ライフサイクルスクリプトの実行が自動的に許可されるものと推測されます。

### `deno.json`への`private: true`フィールドの追加

まだマージはされていませんが、`deno.json`に`private`フィールドを追加するPRが作成されています:

- [feat: support `private: true` in `deno.json` #30852](https://github.com/denoland/deno/pull/30852)

`package.json`における同名フィールドと同様に、`deno.json`で`private: true`を設定しておくと、Denoは該当のパッケージを`deno publish`の対象から除外してくれるようです。[ワークスペース]({{< ref "articles/deno/v1.45.md" >}})機能などと併用すると便利そうです。

この機能は[Deno v2.6.0のマイルストーン](https://github.com/denoland/deno/milestone/70)に含まれています。

## Deploy EA Databases へのデータベースのプロビジョニング機能のサポートについて

[Deno Deploy EA]({{< ref "articles/2025/06/01.md" >}})に関するドキュメントが更新されています。

- [Db provision update #2549](https://github.com/denoland/docs/pull/2549)

[Deploy EA Databases]({{< ref "articles/2025/07/27.md" >}})においてデータベースのプロビジョニング機能が追加されたようで、現時点では Deno KV のみがサポートされている状況であるものの、今後、[Prisma Postgres](https://github.com/prisma/docs/blob/88faf31b51f902e542769aa788c07a126077f856/content/250-postgres/100-introduction/250-overview.mdx)のサポートも追加が行われる想定のようです。
