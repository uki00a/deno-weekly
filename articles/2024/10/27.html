<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>2024/10/21〜2024/10/27の最新情報 | 週刊Deno</title><meta name=keywords content="Deno,deno_std,Next.js"><meta name=description content="Denoのv2.0.3 (Interactive Inlay Hints for Typesのサポート, deno compileでのNode-APIのサポート, など), Deno v2.1向けの変更について (wireitを参考にしたタスクの依存関係の定義, など), @deno/nextjs-start (Deno Deployでnext startを動かすためのパッケージ), @std/async@1.0.7 (throttleが実装), @std/collections@1.0.9 (slidingWindowsでIterableがサポート), @std/expect@1.0.6 (expect.objectContainingが実装)
"><meta name=author content><link rel=canonical href=https://uki00a.github.io/deno-weekly/articles/2024/10/27.html><link crossorigin=anonymous href=/deno-weekly/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/deno-weekly/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://raw.githubusercontent.com/uki00a/blog/master/src/assets/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://uki00a.github.io/deno-weekly/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://uki00a.github.io/deno-weekly/favicon-32x32.png><link rel=apple-touch-icon href=https://uki00a.github.io/deno-weekly/apple-touch-icon.png><link rel=mask-icon href=https://uki00a.github.io/deno-weekly/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:image" content="https://raw.githubusercontent.com/uki00a/blog/master/src/assets/avatar.png"><meta property="twitter:image" content="https://raw.githubusercontent.com/uki00a/blog/master/src/assets/avatar.png"><meta name=twitter:site content="@uki00a"><script async src="https://www.googletagmanager.com/gtag/js?id=G-MK2K2MRMBF"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-MK2K2MRMBF",{anonymize_ip:!1})}</script><meta property="og:title" content="2024/10/21〜2024/10/27の最新情報"><meta property="og:description" content="Denoのv2.0.3 (Interactive Inlay Hints for Typesのサポート, deno compileでのNode-APIのサポート, など), Deno v2.1向けの変更について (wireitを参考にしたタスクの依存関係の定義, など), @deno/nextjs-start (Deno Deployでnext startを動かすためのパッケージ), @std/async@1.0.7 (throttleが実装), @std/collections@1.0.9 (slidingWindowsでIterableがサポート), @std/expect@1.0.6 (expect.objectContainingが実装)
"><meta property="og:type" content="article"><meta property="og:url" content="https://uki00a.github.io/deno-weekly/articles/2024/10/27.html"><meta property="article:section" content="articles"><meta property="article:published_time" content="2024-10-27T00:00:00+00:00"><meta property="article:modified_time" content="2024-10-27T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="2024/10/21〜2024/10/27の最新情報"><meta name=twitter:description content="Denoのv2.0.3 (Interactive Inlay Hints for Typesのサポート, deno compileでのNode-APIのサポート, など), Deno v2.1向けの変更について (wireitを参考にしたタスクの依存関係の定義, など), @deno/nextjs-start (Deno Deployでnext startを動かすためのパッケージ), @std/async@1.0.7 (throttleが実装), @std/collections@1.0.9 (slidingWindowsでIterableがサポート), @std/expect@1.0.6 (expect.objectContainingが実装)
"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"2024/10/21〜2024/10/27の最新情報","item":"https://uki00a.github.io/deno-weekly/articles/2024/10/27.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"2024/10/21〜2024/10/27の最新情報","name":"2024\/10\/21〜2024\/10\/27の最新情報","description":"Denoのv2.0.3 (Interactive Inlay Hints for Typesのサポート, deno compileでのNode-APIのサポート, など), Deno v2.1向けの変更について (wireitを参考にしたタスクの依存関係の定義, など), @deno/nextjs-start (Deno Deployでnext startを動かすためのパッケージ), @std/async@1.0.7 (throttleが実装), @std/collections@1.0.9 (slidingWindowsでIterableがサポート), @std/expect@1.0.6 (expect.objectContainingが実装)\n","keywords":["Deno","deno_std","Next.js"],"articleBody":"Deno v2.0.3 Deno v2.0.3がリリースされました。\ndeno lsp Interactive Inlay Hints for Types Interactive Inlay Hints for Typesが実装されています。Inlay Hintsの内容をクリックすることで、その定義元へジャンプできるようです。\n  feat(lsp): interactive inlay hints #26382  import-map-remap quickfix type imports (import type)に対してもimport-map-remap quickfixが利用できるよう改善されています。\n  fix(lsp): import-map-remap quickfix for type imports #26454  deno compile Node-APIのサポート deno compileで生成されたバイナリでNode-APIがサポートされています。\n  feat: support node-api in denort #26389  deno check --frozenのサポート deno checkコマンドで--frozenオプションの指定がサポートされています。\n  fix(check): support --frozen on deno check #26479  deno fmt --extの挙動の変更 deno fmtに--extオプションを指定した際に、引数でのファイルの指定が必須に変更されています。\n  fix(fmt): –ext flag requires to pass files #26525  HTMLファイルに対するdeno-fmt-ignore-*のサポート HTMLファイルに対してdeno fmtコマンドを実行する際にdeno-fmt-ignore-*コメントが動作していなかった問題が修正されています。\n  fix(fmt): upgrade formatters #26469  deno add/deno install deno.jsonの更新時の振る舞いの改善 deno addやdeno removeなどのコマンドでdeno.json(c)やpackage.jsonが更新される際に、元のインデントやコメントなどを維持してくれるよう振る舞いが改善されています。\n  fix(install): better json editing #26450  引数なしでdeno installを実行した際の振る舞いの変更 引数なしでdeno installを実行した際に、JSRパッケージのexportsで定義されたすべてのファイルがダウンロードされるように挙動が変更されています。(今までは依存されているファイルのみがダウンロードされていました)\n  fix(install): cache all exports of JSR packages listed in deno.json #26501  型定義ファイルのみを含むファイルの取り扱いが改善 deno installでJSRパッケージをダウンロードする際に、型定義だけを含むファイルがダウンロードされない問題が修正されています。\n  fix(install): cache type only module deps in deno install #26497  package.jsonに対するdeno.lockサポートの改善 プロジェクトにpackage.jsonだけが存在するときにdeno addなどのコマンドを実行した際もdeno.lockが更新されるように改善されています。\n  fix(install): update lockfile when using package.json #26458  .npmrcサポート deno installとdeno addに.npmrcの設定が適用されない問題が修正されています。\n  fix: .npmrc settings not being passed to install/add command #26473  Node.js互換性の改善 Next.jsやPlaywright, Vitestのサポートの改善などが実施されています。\n(Windows) スレッドプールサイズの増加 Windowsでnext buildを実行すると、利用可能なCPUコア数によってはプロセスがハングしてしまう問題を解消するため、Denoの内部で利用されているスレッドプールのサイズが調整されています。\n  fix(cli): increase size of blocking task threadpool on windows #26465  サードパーティーレジストリの取り扱いの改善 AWS CodeArtifactなどのサードパーティーレジストリのサポートのため、npmレジストリからscoped packageを要求する際にURLが適切にエンコードされるよう挙動が改善されています。\n  fix(npm): ensure scoped package name is encoded in URLs #26390  node:child_process VitestやPlaywrightサポートの改善に向けて、IPCの使用時に意図せずWouldBlockやBrokenPipeエラーが起きることのある問題が修正されています。\nnode:fs readlink()のエラーハンドリングが改善され、ERROR_NOT_A_REPARSE_POINTの発生時にEINVALが返されるように修正されています。Windowsでnext buildが失敗する問題を解消することが目的のようです (#26179)\nまた、WindowsにおいてERROR_INVALID_NAMEがEINVALではなくENOENTへマッピングされるよう修正されています (#26475)\nnode:util styleTextのformat引数で配列がサポートされました。\n  fix(node/util): support array formats in styleText #26507  node:tls connect()から返却されたTLSSocketに対してalpnProtocolプロパティが設定されるように改善されています。\n  fix(node:tls): set TLSSocket.alpnProtocol for client connections #26476  FFI u64/i64の取り扱いの変更 u64/i64型がNumberではなくbigintとして返却されるように挙動が変更されています。\n  fix(ext/ffi): return u64/i64 as bigints from nonblocking ffi calls #26486  Deno v2.1向けの変更について まだマージはされていませんが、直近でDeno v2.1向けと思われる機能の開発が進められているため、いくつか紹介します。(⚠️ここで紹介している機能についてはまだマージはされていないため、今後、使い方などに変更が発生する可能性もあります)\ndeno task - タスクの依存関係の定義について まだDraft状態ですが、deno taskで各タスク間の依存関係を定義できるようにする対応が進められているようです:\n feat(task): dependencies (WIP) (denoland/deno#26467) feat(task): dependencies (denoland/deno_config#129)  現状ではwireitを参考に、各タスク間の依存関係を定義できるようにする想定のようです:\n{  \"tasks\": {  \"check\": {  \"command\": \"deno check mod.ts\",  \"dependencies\": [\"lint:fmt\", \"lint:dlint\"]  },  \"lint:fmt\": \"deno fmt --check\",  \"lint:dlint\": \"deno lint\"  } } deno compileでのV8コードキャッシュのサポート deno compileにV8コードキャッシュのサポートを追加するPRが作成されています:\n perf(compile): code cache #26528  deno compileで作成された実行可能ファイルの初回実行時に/tmpへコードキャッシュを保存し、その実行可能ファイルの2回目以降の実行時に読み込むことで、バイナリーの起動速度の高速化が図られるようです。\nもしこのコードキャッシュの生成と読み込みを無効化したい場合、deno compileに--no-code-cacheを指定する必要があるようです。\n複数の.envファイルのサポート --env-fileで複数の.envファイルを読み込めるようにする対応が進められています:\n feat(cli): support multiple env file argument #26527  各.envファイル間で環境変数の衝突が見つかった場合、後で指定されたファイルの値が優先される想定のようです。\n$ deno run --env-file=\".env.default\" --env-file=\".env.development\" main.ts @deno/nextjs-start @deno/nextjs-startというJSRパッケージが公開されています:\n パッケージ: @deno/nextjs-start リポジトリ: arnauorriols/deno-next-start デモ: Deploy a Next.js app to Deno Deploy - YouTube  内部的にはnext/dist/cli/next-start.jsが利用されているようで、このパッケージをDeno Deployのエントリポイントとして指定することで、next startを実行した際と同様にDeno Deploy上でNext.jsの本番サーバーを起動できるようです。\ndeno_stdのリリース deno_stdがリリースされています。\n@std/async@1.0.7 @std/async@1.0.7がリリースされています。\n@std/async/unstable-throttle 新規APIとしてthrottleが実装されています。基本的にlodashのthrottle()と同様の機能を提供してくれるようです。\n@std/collections@1.0.9 @std/collections@1.0.9がリリースされています。\n@std/collections/unstable-sliding-windows slidingWindowsにIterableのサポートが追加されています。\n@std/expect@1.0.6 @std/expect@1.0.6がリリースされています。\nexpect.objectContainingが実装されています。\n@std/text@1.0.8 @std/text@1.0.8がリリースされています。\n@std/text/unstable-slugify slugifyにoptions引数(SlugifyOptions)が追加されています。transliterateオプションが提供されており、any-asciiなどのパッケージとの併用が想定されているようです。\n","wordCount":"318","inLanguage":"en","datePublished":"2024-10-27T00:00:00Z","dateModified":"2024-10-27T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://uki00a.github.io/deno-weekly/articles/2024/10/27.html"},"publisher":{"@type":"Organization","name":"週刊Deno","logo":{"@type":"ImageObject","url":"https://raw.githubusercontent.com/uki00a/blog/master/src/assets/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://uki00a.github.io/deno-weekly/ accesskey=h title="週刊Deno (Alt + H)">週刊Deno</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://uki00a.github.io/deno-weekly/tags.html title=タグ><span><i class="fa fa-heart"></i>タグ</span></a></li><li><a href=https://uki00a.github.io/deno-weekly/categories.html title=カテゴリー><span><i class="fa fa-heart"></i>カテゴリー</span></a></li><li><a href=https://uki00a.github.io/deno-weekly/gallery.html title=ギャラリー><span><i class="fa fa-road"></i>ギャラリー<span class=alert></span></span></a></li><li><a href=https://uki00a.github.io/deno-weekly/index.xml title="RSS feed"><span><i class="fa fa-road"></i>RSS feed<span class=alert></span></span></a></li><li><a href=https://uki00a.github.io/deno-weekly/about.html title=About><span><i class="fa fa-road"></i>About<span class=alert></span></span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>2024/10/21〜2024/10/27の最新情報</h1><div class=post-description>Denoのv2.0.3 (Interactive Inlay Hints for Typesのサポート, deno compileでのNode-APIのサポート, など), Deno v2.1向けの変更について (wireitを参考にしたタスクの依存関係の定義, など), @deno/nextjs-start (Deno Deployでnext startを動かすためのパッケージ), @std/async@1.0.7 (throttleが実装), @std/collections@1.0.9 (slidingWindowsでIterableがサポート), @std/expect@1.0.6 (expect.objectContainingが実装)</div><div class=post-meta><span title="2024-10-27 00:00:00 +0000 UTC">October 27, 2024</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#deno-v203 aria-label="Deno v2.0.3">Deno v2.0.3</a><ul><li><a href=#deno-lsp aria-label="deno lsp"><code>deno lsp</code></a><ul><li><a href=#interactive-inlay-hints-for-types aria-label="Interactive Inlay Hints for Types">Interactive Inlay Hints for Types</a></li><li><a href=#import-map-remap-quickfix aria-label="import-map-remap quickfix"><code>import-map-remap</code> quickfix</a></li></ul></li><li><a href=#deno-compile aria-label="deno compile"><code>deno compile</code></a><ul><li><a href=#node-api%e3%81%ae%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=Node-APIのサポート>Node-APIのサポート</a></li></ul></li><li><a href=#deno-check aria-label="deno check"><code>deno check</code></a><ul><li><a href=#--frozen%e3%81%ae%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=--frozenのサポート><code>--frozen</code>のサポート</a></li></ul></li><li><a href=#deno-fmt aria-label="deno fmt"><code>deno fmt</code></a><ul><li><a href=#--ext%e3%81%ae%e6%8c%99%e5%8b%95%e3%81%ae%e5%a4%89%e6%9b%b4 aria-label=--extの挙動の変更><code>--ext</code>の挙動の変更</a></li><li><a href=#html%e3%83%95%e3%82%a1%e3%82%a4%e3%83%ab%e3%81%ab%e5%af%be%e3%81%99%e3%82%8bdeno-fmt-ignore-%e3%81%ae%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=HTMLファイルに対するdeno-fmt-ignore-*のサポート>HTMLファイルに対する<code>deno-fmt-ignore-*</code>のサポート</a></li></ul></li><li><a href=#deno-adddeno-install aria-label="deno add/deno install"><code>deno add</code>/<code>deno install</code></a><ul><li><a href=#denojson%e3%81%ae%e6%9b%b4%e6%96%b0%e6%99%82%e3%81%ae%e6%8c%af%e3%82%8b%e8%88%9e%e3%81%84%e3%81%ae%e6%94%b9%e5%96%84 aria-label=deno.jsonの更新時の振る舞いの改善><code>deno.json</code>の更新時の振る舞いの改善</a></li><li><a href=#%e5%bc%95%e6%95%b0%e3%81%aa%e3%81%97%e3%81%a7deno-install%e3%82%92%e5%ae%9f%e8%a1%8c%e3%81%97%e3%81%9f%e9%9a%9b%e3%81%ae%e6%8c%af%e3%82%8b%e8%88%9e%e3%81%84%e3%81%ae%e5%a4%89%e6%9b%b4 aria-label="引数なしでdeno installを実行した際の振る舞いの変更">引数なしで<code>deno install</code>を実行した際の振る舞いの変更</a></li><li><a href=#%e5%9e%8b%e5%ae%9a%e7%be%a9%e3%83%95%e3%82%a1%e3%82%a4%e3%83%ab%e3%81%ae%e3%81%bf%e3%82%92%e5%90%ab%e3%82%80%e3%83%95%e3%82%a1%e3%82%a4%e3%83%ab%e3%81%ae%e5%8f%96%e3%82%8a%e6%89%b1%e3%81%84%e3%81%8c%e6%94%b9%e5%96%84 aria-label=型定義ファイルのみを含むファイルの取り扱いが改善>型定義ファイルのみを含むファイルの取り扱いが改善</a></li><li><a href=#packagejson%e3%81%ab%e5%af%be%e3%81%99%e3%82%8bdenolock%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88%e3%81%ae%e6%94%b9%e5%96%84 aria-label=package.jsonに対するdeno.lockサポートの改善><code>package.json</code>に対する<code>deno.lock</code>サポートの改善</a></li><li><a href=#npmrc%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=.npmrcサポート><code>.npmrc</code>サポート</a></li></ul></li><li><a href=#nodejs%e4%ba%92%e6%8f%9b%e6%80%a7%e3%81%ae%e6%94%b9%e5%96%84 aria-label=Node.js互換性の改善>Node.js互換性の改善</a><ul><li><a href=#windows-%e3%82%b9%e3%83%ac%e3%83%83%e3%83%89%e3%83%97%e3%83%bc%e3%83%ab%e3%82%b5%e3%82%a4%e3%82%ba%e3%81%ae%e5%a2%97%e5%8a%a0 aria-label="(Windows) スレッドプールサイズの増加">(Windows) スレッドプールサイズの増加</a></li><li><a href=#%e3%82%b5%e3%83%bc%e3%83%89%e3%83%91%e3%83%bc%e3%83%86%e3%82%a3%e3%83%bc%e3%83%ac%e3%82%b8%e3%82%b9%e3%83%88%e3%83%aa%e3%81%ae%e5%8f%96%e3%82%8a%e6%89%b1%e3%81%84%e3%81%ae%e6%94%b9%e5%96%84 aria-label=サードパーティーレジストリの取り扱いの改善>サードパーティーレジストリの取り扱いの改善</a></li><li><a href=#nodechild_process aria-label=node:child_process><code>node:child_process</code></a></li><li><a href=#nodefs aria-label=node:fs><code>node:fs</code></a></li><li><a href=#nodeutil aria-label=node:util><code>node:util</code></a></li><li><a href=#nodetls aria-label=node:tls><code>node:tls</code></a></li></ul></li><li><a href=#ffi aria-label=FFI>FFI</a><ul><li><a href=#u64i64%e3%81%ae%e5%8f%96%e3%82%8a%e6%89%b1%e3%81%84%e3%81%ae%e5%a4%89%e6%9b%b4 aria-label=u64/i64の取り扱いの変更><code>u64</code>/<code>i64</code>の取り扱いの変更</a></li></ul></li></ul></li><li><a href=#deno-v21%e5%90%91%e3%81%91%e3%81%ae%e5%a4%89%e6%9b%b4%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6 aria-label="Deno v2.1向けの変更について">Deno v2.1向けの変更について</a><ul><li><a href=#deno-task---%e3%82%bf%e3%82%b9%e3%82%af%e3%81%ae%e4%be%9d%e5%ad%98%e9%96%a2%e4%bf%82%e3%81%ae%e5%ae%9a%e7%be%a9%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6 aria-label="deno task - タスクの依存関係の定義について"><code>deno task</code> - タスクの依存関係の定義について</a></li><li><a href=#deno-compile%e3%81%a7%e3%81%aev8%e3%82%b3%e3%83%bc%e3%83%89%e3%82%ad%e3%83%a3%e3%83%83%e3%82%b7%e3%83%a5%e3%81%ae%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label="deno compileでのV8コードキャッシュのサポート"><code>deno compile</code>でのV8コードキャッシュのサポート</a></li><li><a href=#%e8%a4%87%e6%95%b0%e3%81%aeenv%e3%83%95%e3%82%a1%e3%82%a4%e3%83%ab%e3%81%ae%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=複数の.envファイルのサポート>複数の<code>.env</code>ファイルのサポート</a></li></ul></li><li><a href=#denonextjs-start aria-label=@deno/nextjs-start><code>@deno/nextjs-start</code></a></li><li><a href=#deno_std%e3%81%ae%e3%83%aa%e3%83%aa%e3%83%bc%e3%82%b9 aria-label=deno_stdのリリース><code>deno_std</code>のリリース</a><ul><li><a href=#stdasync107 aria-label=@std/async@1.0.7><code>@std/async@1.0.7</code></a><ul><li><a href=#stdasyncunstable-throttle aria-label=@std/async/unstable-throttle><code>@std/async/unstable-throttle</code></a></li></ul></li><li><a href=#stdcollections109 aria-label=@std/collections@1.0.9><code>@std/collections@1.0.9</code></a><ul><li><a href=#stdcollectionsunstable-sliding-windows aria-label=@std/collections/unstable-sliding-windows><code>@std/collections/unstable-sliding-windows</code></a></li></ul></li><li><a href=#stdexpect106 aria-label=@std/expect@1.0.6><code>@std/expect@1.0.6</code></a></li><li><a href=#stdtext108 aria-label=@std/text@1.0.8><code>@std/text@1.0.8</code></a><ul><li><a href=#stdtextunstable-slugify aria-label=@std/text/unstable-slugify><code>@std/text/unstable-slugify</code></a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><h2 id=deno-v203>Deno v2.0.3<a hidden class=anchor aria-hidden=true href=#deno-v203>#</a></h2><p><a href=https://github.com/denoland/deno/releases/tag/v2.0.3>Deno v2.0.3</a>がリリースされました。</p><h3 id=deno-lsp><code>deno lsp</code><a hidden class=anchor aria-hidden=true href=#deno-lsp>#</a></h3><h4 id=interactive-inlay-hints-for-types>Interactive Inlay Hints for Types<a hidden class=anchor aria-hidden=true href=#interactive-inlay-hints-for-types>#</a></h4><p><a href=https://www.typescriptlang.org/docs/handbook/release-notes/typescript-5-3.html#interactive-inlay-hints-for-types>Interactive Inlay Hints for Types</a>が実装されています。<a href=https://uki00a.github.io/deno-weekly/articles/deno/v1.27.html>Inlay Hints</a>の内容をクリックすることで、その定義元へジャンプできるようです。</p><hr><ul><li><a href=https://github.com/denoland/deno/pull/26382>feat(lsp): interactive inlay hints #26382</a></li></ul><h4 id=import-map-remap-quickfix><code>import-map-remap</code> quickfix<a hidden class=anchor aria-hidden=true href=#import-map-remap-quickfix>#</a></h4><p>type imports (<code>import type</code>)に対しても<code>import-map-remap</code> quickfixが利用できるよう改善されています。</p><hr><ul><li><a href=https://github.com/denoland/deno/pull/26454>fix(lsp): import-map-remap quickfix for type imports #26454</a></li></ul><h3 id=deno-compile><code>deno compile</code><a hidden class=anchor aria-hidden=true href=#deno-compile>#</a></h3><h4 id=node-apiのサポート>Node-APIのサポート<a hidden class=anchor aria-hidden=true href=#node-apiのサポート>#</a></h4><p><code>deno compile</code>で生成されたバイナリでNode-APIがサポートされています。</p><hr><ul><li><a href=https://github.com/denoland/deno/pull/26389>feat: support node-api in denort #26389</a></li></ul><h3 id=deno-check><code>deno check</code><a hidden class=anchor aria-hidden=true href=#deno-check>#</a></h3><h4 id=--frozenのサポート><code>--frozen</code>のサポート<a hidden class=anchor aria-hidden=true href=#--frozenのサポート>#</a></h4><p><code>deno check</code>コマンドで<a href=https://uki00a.github.io/deno-weekly/articles/deno/v1.45.html><code>--frozen</code></a>オプションの指定がサポートされています。</p><hr><ul><li><a href=https://github.com/denoland/deno/pull/26479>fix(check): support <code>--frozen</code> on deno check #26479</a></li></ul><h3 id=deno-fmt><code>deno fmt</code><a hidden class=anchor aria-hidden=true href=#deno-fmt>#</a></h3><h4 id=--extの挙動の変更><code>--ext</code>の挙動の変更<a hidden class=anchor aria-hidden=true href=#--extの挙動の変更>#</a></h4><p><code>deno fmt</code>に<code>--ext</code>オプションを指定した際に、引数でのファイルの指定が必須に変更されています。</p><hr><ul><li><a href=https://github.com/denoland/deno/pull/26525>fix(fmt): &ndash;ext flag requires to pass files #26525</a></li></ul><h4 id=htmlファイルに対するdeno-fmt-ignore-のサポート>HTMLファイルに対する<code>deno-fmt-ignore-*</code>のサポート<a hidden class=anchor aria-hidden=true href=#htmlファイルに対するdeno-fmt-ignore-のサポート>#</a></h4><p>HTMLファイルに対して<code>deno fmt</code>コマンドを実行する際に<code>deno-fmt-ignore-*</code>コメントが動作していなかった問題が修正されています。</p><hr><ul><li><a href=https://github.com/denoland/deno/pull/26469>fix(fmt): upgrade formatters #26469</a></li></ul><h3 id=deno-adddeno-install><code>deno add</code>/<code>deno install</code><a hidden class=anchor aria-hidden=true href=#deno-adddeno-install>#</a></h3><h4 id=denojsonの更新時の振る舞いの改善><code>deno.json</code>の更新時の振る舞いの改善<a hidden class=anchor aria-hidden=true href=#denojsonの更新時の振る舞いの改善>#</a></h4><p><code>deno add</code>や<code>deno remove</code>などのコマンドで<code>deno.json(c)</code>や<code>package.json</code>が更新される際に、元のインデントやコメントなどを維持してくれるよう振る舞いが改善されています。</p><hr><ul><li><a href=https://github.com/denoland/deno/pull/26450>fix(install): better json editing #26450</a></li></ul><h4 id=引数なしでdeno-installを実行した際の振る舞いの変更>引数なしで<code>deno install</code>を実行した際の振る舞いの変更<a hidden class=anchor aria-hidden=true href=#引数なしでdeno-installを実行した際の振る舞いの変更>#</a></h4><p>引数なしで<code>deno install</code>を実行した際に、JSRパッケージの<code>exports</code>で定義されたすべてのファイルがダウンロードされるように挙動が変更されています。(今までは依存されているファイルのみがダウンロードされていました)</p><hr><ul><li><a href=https://github.com/denoland/deno/pull/26501>fix(install): cache all exports of JSR packages listed in <code>deno.json</code> #26501</a></li></ul><h4 id=型定義ファイルのみを含むファイルの取り扱いが改善>型定義ファイルのみを含むファイルの取り扱いが改善<a hidden class=anchor aria-hidden=true href=#型定義ファイルのみを含むファイルの取り扱いが改善>#</a></h4><p><code>deno install</code>でJSRパッケージをダウンロードする際に、型定義だけを含むファイルがダウンロードされない問題が修正されています。</p><hr><ul><li><a href=https://github.com/denoland/deno/pull/26497>fix(install): cache type only module deps in <code>deno install</code> #26497</a></li></ul><h4 id=packagejsonに対するdenolockサポートの改善><code>package.json</code>に対する<code>deno.lock</code>サポートの改善<a hidden class=anchor aria-hidden=true href=#packagejsonに対するdenolockサポートの改善>#</a></h4><p>プロジェクトに<code>package.json</code>だけが存在するときに<code>deno add</code>などのコマンドを実行した際も<code>deno.lock</code>が更新されるように改善されています。</p><hr><ul><li><a href=https://github.com/denoland/deno/pull/26458>fix(install): update lockfile when using package.json #26458</a></li></ul><h4 id=npmrcサポート><code>.npmrc</code>サポート<a hidden class=anchor aria-hidden=true href=#npmrcサポート>#</a></h4><p><code>deno install</code>と<code>deno add</code>に<a href=https://uki00a.github.io/deno-weekly/articles/deno/v1.45.html><code>.npmrc</code></a>の設定が適用されない問題が修正されています。</p><hr><ul><li><a href=https://github.com/denoland/deno/pull/26473>fix: <code>.npmrc</code> settings not being passed to install/add command #26473</a></li></ul><h3 id=nodejs互換性の改善>Node.js互換性の改善<a hidden class=anchor aria-hidden=true href=#nodejs互換性の改善>#</a></h3><p>Next.jsや<a href=https://github.com/denoland/deno/issues/16899>Playwright</a>, <a href=https://github.com/denoland/deno/issues/23882>Vitest</a>のサポートの改善などが実施されています。</p><h4 id=windows-スレッドプールサイズの増加>(Windows) スレッドプールサイズの増加<a hidden class=anchor aria-hidden=true href=#windows-スレッドプールサイズの増加>#</a></h4><p>Windowsで<code>next build</code>を実行すると、利用可能なCPUコア数によってはプロセスがハングしてしまう問題を解消するため、Denoの内部で利用されているスレッドプールのサイズが調整されています。</p><hr><ul><li><a href=https://github.com/denoland/deno/pull/26465>fix(cli): increase size of blocking task threadpool on windows #26465</a></li></ul><h4 id=サードパーティーレジストリの取り扱いの改善>サードパーティーレジストリの取り扱いの改善<a hidden class=anchor aria-hidden=true href=#サードパーティーレジストリの取り扱いの改善>#</a></h4><p>AWS CodeArtifactなどのサードパーティーレジストリのサポートのため、npmレジストリからscoped packageを要求する際にURLが適切にエンコードされるよう挙動が改善されています。</p><hr><ul><li><a href=https://github.com/denoland/deno/pull/26390>fix(npm): ensure scoped package name is encoded in URLs #26390</a></li></ul><h4 id=nodechild_process><code>node:child_process</code><a hidden class=anchor aria-hidden=true href=#nodechild_process>#</a></h4><p>VitestやPlaywrightサポートの改善に向けて、IPCの使用時に意図せず<a href=https://github.com/denoland/deno/pull/26495><code>WouldBlock</code></a>や<a href=https://github.com/denoland/deno/pull/26504><code>BrokenPipe</code></a>エラーが起きることのある問題が修正されています。</p><h4 id=nodefs><code>node:fs</code><a hidden class=anchor aria-hidden=true href=#nodefs>#</a></h4><p><code>readlink()</code>のエラーハンドリングが改善され、<code>ERROR_NOT_A_REPARSE_POINT</code>の発生時に<code>EINVAL</code>が返されるように修正されています。Windowsで<code>next build</code>が失敗する問題を解消することが目的のようです (<a href=https://github.com/denoland/deno/issues/26179>#26179</a>)</p><p>また、Windowsにおいて<code>ERROR_INVALID_NAME</code>が<code>EINVAL</code>ではなく<code>ENOENT</code>へマッピングされるよう修正されています (<a href=https://github.com/denoland/deno/pull/26475>#26475</a>)</p><h4 id=nodeutil><code>node:util</code><a hidden class=anchor aria-hidden=true href=#nodeutil>#</a></h4><p><code>styleText</code>の<code>format</code>引数で配列がサポートされました。</p><hr><ul><li><a href=https://github.com/denoland/deno/pull/26507>fix(node/util): support array formats in <code>styleText</code> #26507</a></li></ul><h4 id=nodetls><code>node:tls</code><a hidden class=anchor aria-hidden=true href=#nodetls>#</a></h4><p><code>connect()</code>から返却された<code>TLSSocket</code>に対して<code>alpnProtocol</code>プロパティが設定されるように改善されています。</p><hr><ul><li><a href=https://github.com/denoland/deno/pull/26476>fix(node:tls): set TLSSocket.alpnProtocol for client connections #26476</a></li></ul><h3 id=ffi>FFI<a hidden class=anchor aria-hidden=true href=#ffi>#</a></h3><h4 id=u64i64の取り扱いの変更><code>u64</code>/<code>i64</code>の取り扱いの変更<a hidden class=anchor aria-hidden=true href=#u64i64の取り扱いの変更>#</a></h4><p><code>u64</code>/<code>i64</code>型が<code>Number</code>ではなく<code>bigint</code>として返却されるように挙動が変更されています。</p><hr><ul><li><a href=https://github.com/denoland/deno/pull/26486>fix(ext/ffi): return u64/i64 as bigints from nonblocking ffi calls #26486</a></li></ul><h2 id=deno-v21向けの変更について>Deno v2.1向けの変更について<a hidden class=anchor aria-hidden=true href=#deno-v21向けの変更について>#</a></h2><p>まだマージはされていませんが、直近でDeno v2.1向けと思われる機能の開発が進められているため、いくつか紹介します。(⚠️ここで紹介している機能についてはまだマージはされていないため、今後、使い方などに変更が発生する可能性もあります)</p><h3 id=deno-task---タスクの依存関係の定義について><code>deno task</code> - タスクの依存関係の定義について<a hidden class=anchor aria-hidden=true href=#deno-task---タスクの依存関係の定義について>#</a></h3><p>まだDraft状態ですが、<code>deno task</code>で各タスク間の依存関係を定義できるようにする対応が進められているようです:</p><ul><li><a href=https://github.com/denoland/deno/pull/26467>feat(task): dependencies (WIP) (denoland/deno#26467)</a></li><li><a href=https://github.com/denoland/deno_config/pull/129>feat(task): dependencies (denoland/deno_config#129)</a></li></ul><p>現状では<a href=https://github.com/google/wireit>wireit</a>を参考に、各タスク間の依存関係を定義できるようにする想定のようです:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;tasks&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;check&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;command&#34;</span>: <span style=color:#e6db74>&#34;deno check mod.ts&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;dependencies&#34;</span>: [<span style=color:#e6db74>&#34;lint:fmt&#34;</span>, <span style=color:#e6db74>&#34;lint:dlint&#34;</span>]
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;lint:fmt&#34;</span>: <span style=color:#e6db74>&#34;deno fmt --check&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;lint:dlint&#34;</span>: <span style=color:#e6db74>&#34;deno lint&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=deno-compileでのv8コードキャッシュのサポート><code>deno compile</code>でのV8コードキャッシュのサポート<a hidden class=anchor aria-hidden=true href=#deno-compileでのv8コードキャッシュのサポート>#</a></h3><p><code>deno compile</code>に<a href=https://uki00a.github.io/deno-weekly/articles/2024/04/28.html>V8コードキャッシュ</a>のサポートを追加するPRが作成されています:</p><ul><li><a href=https://github.com/denoland/deno/pull/26528>perf(compile): code cache #26528</a></li></ul><p><code>deno compile</code>で作成された実行可能ファイルの初回実行時に<code>/tmp</code>へコードキャッシュを保存し、その実行可能ファイルの2回目以降の実行時に読み込むことで、バイナリーの起動速度の高速化が図られるようです。</p><p>もしこのコードキャッシュの生成と読み込みを無効化したい場合、<code>deno compile</code>に<code>--no-code-cache</code>を指定する必要があるようです。</p><h3 id=複数のenvファイルのサポート>複数の<code>.env</code>ファイルのサポート<a hidden class=anchor aria-hidden=true href=#複数のenvファイルのサポート>#</a></h3><p><code>--env-file</code>で複数の<code>.env</code>ファイルを読み込めるようにする対応が進められています:</p><ul><li><a href=https://github.com/denoland/deno/pull/26527>feat(cli): support multiple env file argument #26527</a></li></ul><p>各<code>.env</code>ファイル間で環境変数の衝突が見つかった場合、後で指定されたファイルの値が優先される想定のようです。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ deno run --env-file<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;.env.default&#34;</span> --env-file<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;.env.development&#34;</span> main.ts
</span></span></code></pre></div><h2 id=denonextjs-start><code>@deno/nextjs-start</code><a hidden class=anchor aria-hidden=true href=#denonextjs-start>#</a></h2><p><code>@deno/nextjs-start</code>というJSRパッケージが公開されています:</p><ul><li>パッケージ: <a href=https://jsr.io/@deno/nextjs-start>@deno/nextjs-start</a></li><li>リポジトリ: <a href=https://github.com/arnauorriols/deno-next-start>arnauorriols/deno-next-start</a></li><li>デモ: <a href="https://www.youtube.com/watch?v=puoorw7jUoc">Deploy a Next.js app to Deno Deploy - YouTube</a></li></ul><p><a href=https://github.com/arnauorriols/deno-next-start/commit/0d8ad2d88375fc5d2353272d259c353cda25ca95#diff-564c860307257bfac9176f554a35aa858c350a59d75c0dcd0a5d63a480805bd0R1>内部的には<code>next/dist/cli/next-start.js</code>が利用されている</a>ようで、このパッケージをDeno Deployのエントリポイントとして指定することで、<code>next start</code>を実行した際と同様にDeno Deploy上でNext.jsの本番サーバーを起動できるようです。</p><h2 id=deno_stdのリリース><code>deno_std</code>のリリース<a hidden class=anchor aria-hidden=true href=#deno_stdのリリース>#</a></h2><p><a href=https://github.com/denoland/std/releases/tag/release-2024.10.24><code>deno_std</code>がリリース</a>されています。</p><h3 id=stdasync107><code>@std/async@1.0.7</code><a hidden class=anchor aria-hidden=true href=#stdasync107>#</a></h3><p><a href=https://jsr.io/@std/async@1.0.7>@std/async@1.0.7</a>がリリースされています。</p><h4 id=stdasyncunstable-throttle><code>@std/async/unstable-throttle</code><a hidden class=anchor aria-hidden=true href=#stdasyncunstable-throttle>#</a></h4><p>新規APIとして<code>throttle</code>が実装されています。基本的に<a href=https://github.com/lodash/lodash/tree/4.17.15/doc#_throttlefunc-wait0-options>lodashの<code>throttle()</code></a>と同様の機能を提供してくれるようです。</p><h3 id=stdcollections109><code>@std/collections@1.0.9</code><a hidden class=anchor aria-hidden=true href=#stdcollections109>#</a></h3><p><a href=https://jsr.io/@std/collections@1.0.9>@std/collections@1.0.9</a>がリリースされています。</p><h4 id=stdcollectionsunstable-sliding-windows><code>@std/collections/unstable-sliding-windows</code><a hidden class=anchor aria-hidden=true href=#stdcollectionsunstable-sliding-windows>#</a></h4><p><code>slidingWindows</code>に<code>Iterable</code>のサポートが追加されています。</p><h3 id=stdexpect106><code>@std/expect@1.0.6</code><a hidden class=anchor aria-hidden=true href=#stdexpect106>#</a></h3><p><a href=https://jsr.io/@std/expect@1.0.6>@std/expect@1.0.6</a>がリリースされています。</p><p><a href=https://github.com/jestjs/jest/blob/v30.0.0-alpha.6/docs/ExpectAPI.md#expectobjectcontainingobject><code>expect.objectContaining</code></a>が実装されています。</p><h3 id=stdtext108><code>@std/text@1.0.8</code><a hidden class=anchor aria-hidden=true href=#stdtext108>#</a></h3><p><a href=https://jsr.io/@std/text@1.0.8>@std/text@1.0.8</a>がリリースされています。</p><h4 id=stdtextunstable-slugify><code>@std/text/unstable-slugify</code><a hidden class=anchor aria-hidden=true href=#stdtextunstable-slugify>#</a></h4><p><code>slugify</code>に<code>options</code>引数(<code>SlugifyOptions</code>)が追加されています。<code>transliterate</code>オプションが提供されており、<a href=https://www.npmjs.com/package/any-ascii><code>any-ascii</code></a>などのパッケージとの併用が想定されているようです。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://uki00a.github.io/deno-weekly/tags/deno.html>deno</a></li><li><a href=https://uki00a.github.io/deno-weekly/tags/deno_std.html>deno_std</a></li><li><a href=https://uki00a.github.io/deno-weekly/tags/next.js.html>Next.js</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://uki00a.github.io/deno-weekly/>週刊Deno</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>