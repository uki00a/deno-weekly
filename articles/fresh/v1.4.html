<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>fresh v1.4 | 週刊Deno</title><meta name=keywords content="fresh,Preact"><meta name=description content="fresh v1.4がリリース。オプトイン方式での事前ビルドのサポート、Route Groupsやレイアウト機能の実装などが実施されています。"><meta name=author content><link rel=canonical href=https://uki00a.github.io/deno-weekly/articles/fresh/v1.4.html><link crossorigin=anonymous href=/deno-weekly/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/deno-weekly/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://raw.githubusercontent.com/uki00a/blog/master/src/assets/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://uki00a.github.io/deno-weekly/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://uki00a.github.io/deno-weekly/favicon-32x32.png><link rel=apple-touch-icon href=https://uki00a.github.io/deno-weekly/apple-touch-icon.png><link rel=mask-icon href=https://uki00a.github.io/deno-weekly/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:image" content="https://raw.githubusercontent.com/uki00a/blog/master/src/assets/avatar.png"><meta property="twitter:image" content="https://raw.githubusercontent.com/uki00a/blog/master/src/assets/avatar.png"><meta name=twitter:site content="@uki00a"><script async src="https://www.googletagmanager.com/gtag/js?id=G-MK2K2MRMBF"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-MK2K2MRMBF",{anonymize_ip:!1})}</script><meta property="og:title" content="fresh v1.4"><meta property="og:description" content="fresh v1.4がリリース。オプトイン方式での事前ビルドのサポート、Route Groupsやレイアウト機能の実装などが実施されています。"><meta property="og:type" content="article"><meta property="og:url" content="https://uki00a.github.io/deno-weekly/articles/fresh/v1.4.html"><meta property="article:section" content="articles"><meta property="article:published_time" content="2023-08-20T00:00:00+00:00"><meta property="article:modified_time" content="2023-08-20T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="fresh v1.4"><meta name=twitter:description content="fresh v1.4がリリース。オプトイン方式での事前ビルドのサポート、Route Groupsやレイアウト機能の実装などが実施されています。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"fresh v1.4","item":"https://uki00a.github.io/deno-weekly/articles/fresh/v1.4.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"fresh v1.4","name":"fresh v1.4","description":"fresh v1.4がリリース。オプトイン方式での事前ビルドのサポート、Route Groupsやレイアウト機能の実装などが実施されています。","keywords":["fresh","Preact"],"articleBody":"fresh v1.4がリリースされました。\nこの記事では主な変更点などについて解説します。\n事前ビルドのサポート Islandコンポーネントなどの事前ビルドがサポートされました。\ndeno task buildを実行すると、_freshディレクトリにIslandコンポーネントなどをesbuildによってバンドルした結果が出力されます。(この_freshディレクトリは.gitignoreに含めることが推奨されます。)\n# 1. ビルドを実行 $ deno task build  # 2. _freshディレクトリが作成されます $ cat _fresh/snapshot.json サーバの起動時にfreshは自動で_freshディレクトリを探索し、見つかればそこに格納されたバンドルを利用してくれます。これによりコールドスタート時間の短縮が期待されます。\n$ deno run -A main.ts Using snapshot found at /path/to/fresh-project/_fresh この事前ビルド機能はオプトイン方式によるものであり、従来どおり、ビルドステップなしでの開発やデプロイは引き続きサポートされています。ローカルでは従来どおりの方法で開発をし、本番環境にデプロイするときだけ事前ビルドを行うことも可能です。\n移行について (fresh.config.ts) ※fresh v1.4以降、新規に作成したプロジェクトにおいてはこの作業は不要です。\nこの修正の影響により、dev.tsで使用することが想定されているdev()に変更が入っており、移行が必要になる場合がありそうです。\n具体的には、まずfresh.config.tsを用意します。\nimport { defineConfig } from \"$fresh/server.ts\";  import twindv1 from \"$fresh/plugins/twindv1.ts\"; import twindConfig from \"./twind.config.ts\";  export default defineConfig({  plugins: [twindv1(twindConfig)] }); 次に、main.tsをfresh.config.tsからfreshに関する設定を読み込むように変更します。\nimport { start } from \"$fresh/server.ts\";  import manifest from \"./fresh.gen.ts\"; +import config from \"./fresh.config.ts\";  -import twindv1 from \"$fresh/plugins/twindv1.ts\"; -import twindConfig from \"./twind.config.ts\"; - -await start(manifest, { plugins: [twindv1(twindConfig)] }); +await start(manifest, config); 同様に、dev.tsに関してもfresh.config.tsから設定を読み込み、dev()関数に渡すように修正します。\nimport dev from \"$fresh/dev.ts\"; +import config from \"./fresh.config.ts\";  -await dev(import.meta.url, \"./main.ts\"); +await dev(import.meta.url, \"./main.ts\", config); レイアウト freshではroutes/_app.tsxを用意することで、各Routeに共通のレイアウトを定義することができました。\nしかし、このファイルはアプリケーションごとに一つしか用意できません。\nこの課題を解消するため、レイアウトという機能が実装されました。この機能を活用することで、routes/_app.tsxと同様に、特定のRouteに対して共通のレイアウトを定義することができます。\nレイアウトを使いたい際は、_layout.tsxという名前のファイルをroutes配下の任意のディレクトリに配置します。これにより、対象ディレクトリ及びその子孫のディレクトリの各Routeがレンダリングされる際に、対象のレイアウトが自動で適用されます。\n// routes/admin/_layout.tsx import type { LayoutProps } from \"$fresh/server.ts\";  export default function AdminLayout({ Component }: LayoutProps) {  return (  section  h2Adminh2  div  Component /  div  section  ); } また、レイアウトは入れ子にすることも可能です。\n例えば以下のようなディレクトリ構造があったとします。\nroutes ├── _app.tsx ├── _layout.tsx ├── admin │ ├── _layout.tsx │ └── index.tsx └── index.tsx この場合、routes/admin/index.tsxには以下のレイアウトが適用されます。\n (1) routes/_app.tsx (2) routes/_layout.tsx (3) routes/admin/_layout.tsx  また、レイアウトには後述するdefineヘルパーが提供されているため、こちらを使用して定義することも可能です。\nimport { defineLayout } from \"$fresh/server.ts\";  export default defineLayout((_req, { Component }) = {  return (  section  h2Dashboardh2  main  Component /  main  section  ); }); このレイアウト機能のサポートに合わせて、RouteConfigにskipAppWrapper/skipInheritedLayoutsオプションが追加されています。\nこれらのオプションによって、特定のRouteにおいてレイアウトに関する挙動を変更することができます。\n   オプション 説明 デフォルト     skipAppWrapper trueを指定すると、対象Routeに対するroutes/_appの適用が無効化されます false   skipInheritedLayouts trueを指定すると、祖先のディレクトリからのレイアウトの継承が無効化されます false    また、レイアウトはv1.3で実装された非同期Routeコンポーネントとして実装することも可能です。この場合、defineLayoutヘルパーを使用すると便利です。\nimport { defineLayout } from \"$fresh/server.ts\";  export default defineLayoutAppState(async (_req, { Component, params, state }) = {  const user = await ctx.state.db.findUser(params.id);  return (  section  h2Hi {user.name}!h2  main  Component /  main  section  ); }); app wrapper html, head, metaなどのタグのサポート routes/_app.tsxからhtml, head, metaなどのタグをレンダリングできるようになりました。\nこれにより、htmlのlang属性の設定などが容易になりそうです。\n// routes/_app.tsx import { AppProps } from \"$fresh/server.ts\"; import Header from \"../components/Header.tsx\"; import Footer from \"../components/Footer.tsx\";  export default function App({ Component }: AppProps) {  return (  html lang=\"ja\"  head  meta charSet=\"utf-8\" /  meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /  titleSample Fresh Projecttitle  head  body  Header /  main  Component /  main  Footer /  body  html  ); } 非同期Routeコンポーネント形式のサポート routes/_app.tsxをv1.3でサポートされた非同期Routeコンポーネントとして定義できるよう改善が行われています。この場合、defineAppを使用すると便利です。\n// routes/_app.tsx import { defineApp } from \"$fresh/server.ts\";  export default defineApp(async (_req, { Component }) = {  const title = await getTitle();  return (  html lang=\"ja\"  head  meta charSet=\"utf-8\" /  meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /  title{title}title  head  body  Component /  body  html  ); }); define*ヘルパー freshの各種構成要素の定義を簡易化するためのヘルパーが追加されました。\nすでに登場しているdefineConfigやdefineLayout, defineAppに加えて、defineRouteというヘルパーが追加されています。\n// routes/blog/[id].tsx import { defineRoute } from \"$fresh/server.ts\";  export default defineRoute(async (req, ctx) = {  const content = await readContent(ctx.params.id);   return (  div{content}div  ); }); Route Groups freshでNext.jsライクなRoute Groups機能がサポートされました。\nRoute Groupを定義したい場合、routes/ディレクトリに()というような形式のディレクトリを作成します。\nこのような形式で命名されたディレクトリについては、freshによって特別な扱いがなされます。 例えば、以下のような構成のプロジェクトが存在したとします。\nroutes ├── (_islands) │ └── Counter.tsx ├── (dashboard) │ ├── _layout.tsx │ ├── _middleware.ts │ └── account.tsx ├── _app.tsx ├── _layout.tsx └── index.tsx この場合、/accountにアクセスすることでroutes/(dashboard)/account.tsxがレンダリングされます。また、Route Groupごとにレイアウトやミドルウェアを配置することができます。\n例外として、(_foo)というような形式で命名されたディレクトリはfreshによってファイルシステムルーティングの対象から除外されます。 そのため、例えば、(_components)ディレクトリを用意し、そこに特定のRouteに関連したコンポーネントなどの一覧をまとめておくことなどが可能です。\nroutes/(dashboard) ├── (_components) │ └── Chart.tsx ├── (_utils) │ └── index.tsx ├── _layout.tsx └── account.tsx └── index.tsx その他にも、特殊なルールとして、freshは(_islands)という名前のディレクトリに配置されたコンポーネントをIslandコンポーネントとして認識します。\nその他の改善について サーバでHTTPSがサポート start()関数にTLS関連のオプションを指定することで有効化できます。\nプラグイン経由でミドルウェアを注入する際の挙動の改善 複数のプラグインから同一Routeに適用されるミドルウェアが複数存在する場合に、それらが適切にマージされるように挙動が改善されました。\n文字列形式のイベントハンドラのサポート 文字列形式でイベントハンドラを設定できるようになりました。(型エラーが発生するため@ts-expect-errorの指定などが必要です)\n button  type=\"button\"  // @ts-expect-error  onClick=\"alert('foobar')\"  Hello  button 参考  https://deno.com/blog/fresh-1.4 https://github.com/denoland/fresh/releases/tag/1.4.0  ","wordCount":"445","inLanguage":"en","datePublished":"2023-08-20T00:00:00Z","dateModified":"2023-08-20T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://uki00a.github.io/deno-weekly/articles/fresh/v1.4.html"},"publisher":{"@type":"Organization","name":"週刊Deno","logo":{"@type":"ImageObject","url":"https://raw.githubusercontent.com/uki00a/blog/master/src/assets/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://uki00a.github.io/deno-weekly/ accesskey=h title="週刊Deno (Alt + H)">週刊Deno</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://uki00a.github.io/deno-weekly/tags.html title=タグ><span><i class="fa fa-heart"></i>タグ</span></a></li><li><a href=https://uki00a.github.io/deno-weekly/categories.html title=カテゴリー><span><i class="fa fa-heart"></i>カテゴリー</span></a></li><li><a href=https://uki00a.github.io/deno-weekly/gallery.html title=ギャラリー><span><i class="fa fa-road"></i>ギャラリー<span class=alert></span></span></a></li><li><a href=https://uki00a.github.io/deno-weekly/index.xml title="RSS feed"><span><i class="fa fa-road"></i>RSS feed<span class=alert></span></span></a></li><li><a href=https://uki00a.github.io/deno-weekly/about.html title=About><span><i class="fa fa-road"></i>About<span class=alert></span></span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>fresh v1.4</h1><div class=post-description>fresh v1.4がリリース。オプトイン方式での事前ビルドのサポート、Route Groupsやレイアウト機能の実装などが実施されています。</div><div class=post-meta><span title="2023-08-20 00:00:00 +0000 UTC">August 20, 2023</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e4%ba%8b%e5%89%8d%e3%83%93%e3%83%ab%e3%83%89%e3%81%ae%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=事前ビルドのサポート>事前ビルドのサポート</a><ul><li><a href=#%e7%a7%bb%e8%a1%8c%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6-freshconfigts aria-label="移行について (fresh.config.ts)">移行について (<code>fresh.config.ts</code>)</a></li></ul></li><li><a href=#%e3%83%ac%e3%82%a4%e3%82%a2%e3%82%a6%e3%83%88 aria-label=レイアウト>レイアウト</a></li><li><a href=#app-wrapper aria-label="app wrapper">app wrapper</a><ul><li><a href=#html-head-meta%e3%81%aa%e3%81%a9%e3%81%ae%e3%82%bf%e3%82%b0%e3%81%ae%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label="html, head, metaなどのタグのサポート"><code>html</code>, <code>head</code>, <code>meta</code>などのタグのサポート</a></li><li><a href=#%e9%9d%9e%e5%90%8c%e6%9c%9froute%e3%82%b3%e3%83%b3%e3%83%9d%e3%83%bc%e3%83%8d%e3%83%b3%e3%83%88%e5%bd%a2%e5%bc%8f%e3%81%ae%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=非同期Routeコンポーネント形式のサポート>非同期Routeコンポーネント形式のサポート</a></li></ul></li><li><a href=#define%e3%83%98%e3%83%ab%e3%83%91%e3%83%bc aria-label=define*ヘルパー><code>define*</code>ヘルパー</a></li><li><a href=#route-groups aria-label="Route Groups">Route Groups</a></li><li><a href=#%e3%81%9d%e3%81%ae%e4%bb%96%e3%81%ae%e6%94%b9%e5%96%84%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6 aria-label=その他の改善について>その他の改善について</a><ul><li><a href=#%e3%82%b5%e3%83%bc%e3%83%90%e3%81%a7https%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=サーバでHTTPSがサポート>サーバでHTTPSがサポート</a></li><li><a href=#%e3%83%97%e3%83%a9%e3%82%b0%e3%82%a4%e3%83%b3%e7%b5%8c%e7%94%b1%e3%81%a7%e3%83%9f%e3%83%89%e3%83%ab%e3%82%a6%e3%82%a7%e3%82%a2%e3%82%92%e6%b3%a8%e5%85%a5%e3%81%99%e3%82%8b%e9%9a%9b%e3%81%ae%e6%8c%99%e5%8b%95%e3%81%ae%e6%94%b9%e5%96%84 aria-label=プラグイン経由でミドルウェアを注入する際の挙動の改善>プラグイン経由でミドルウェアを注入する際の挙動の改善</a></li></ul></li><li><a href=#%e6%96%87%e5%ad%97%e5%88%97%e5%bd%a2%e5%bc%8f%e3%81%ae%e3%82%a4%e3%83%99%e3%83%b3%e3%83%88%e3%83%8f%e3%83%b3%e3%83%89%e3%83%a9%e3%81%ae%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=文字列形式のイベントハンドラのサポート>文字列形式のイベントハンドラのサポート</a></li><li><a href=#%e5%8f%82%e8%80%83 aria-label=参考>参考</a></li></ul></div></details></div><div class=post-content><p>fresh v1.4がリリースされました。</p><p>この記事では主な変更点などについて解説します。</p><h2 id=事前ビルドのサポート>事前ビルドのサポート<a hidden class=anchor aria-hidden=true href=#事前ビルドのサポート>#</a></h2><p>Islandコンポーネントなどの事前ビルドがサポートされました。</p><p><code>deno task build</code>を実行すると、<code>_fresh</code>ディレクトリにIslandコンポーネントなどをesbuildによってバンドルした結果が出力されます。(この<code>_fresh</code>ディレクトリは<code>.gitignore</code>に含めることが推奨されます。)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 1. ビルドを実行</span>
</span></span><span style=display:flex><span>$ deno task build
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. _freshディレクトリが作成されます</span>
</span></span><span style=display:flex><span>$ cat _fresh/snapshot.json
</span></span></code></pre></div><p>サーバの起動時にfreshは自動で<code>_fresh</code>ディレクトリを探索し、見つかればそこに格納されたバンドルを利用してくれます。これによりコールドスタート時間の短縮が期待されます。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ deno run -A main.ts
</span></span><span style=display:flex><span>Using snapshot found at /path/to/fresh-project/_fresh
</span></span></code></pre></div><p>この事前ビルド機能はオプトイン方式によるものであり、従来どおり、ビルドステップなしでの開発やデプロイは引き続きサポートされています。ローカルでは従来どおりの方法で開発をし、本番環境にデプロイするときだけ事前ビルドを行うことも可能です。</p><h3 id=移行について-freshconfigts>移行について (<code>fresh.config.ts</code>)<a hidden class=anchor aria-hidden=true href=#移行について-freshconfigts>#</a></h3><p><strong>※fresh v1.4以降、新規に作成したプロジェクトにおいてはこの作業は不要です。</strong></p><p>この修正の影響により、<code>dev.ts</code>で使用することが想定されている<a href="https://deno.land/x/fresh@1.4.0/src/dev/mod.ts?doc=&s=dev">dev()</a>に変更が入っており、移行が必要になる場合がありそうです。</p><p>具体的には、まず<code>fresh.config.ts</code>を用意します。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>defineConfig</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;$fresh/server.ts&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>twindv1</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;$fresh/plugins/twindv1.ts&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>twindConfig</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;./twind.config.ts&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>defineConfig</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>twindv1</span>(<span style=color:#a6e22e>twindConfig</span>)]
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>次に、<code>main.ts</code>を<code>fresh.config.ts</code>からfreshに関する設定を読み込むように変更します。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>import { start } from &#34;$fresh/server.ts&#34;;
</span></span><span style=display:flex><span> import manifest from &#34;./fresh.gen.ts&#34;;
</span></span><span style=display:flex><span><span style=color:#a6e22e>+import config from &#34;./fresh.config.ts&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span> 
</span></span><span style=display:flex><span><span style=color:#f92672>-import twindv1 from &#34;$fresh/plugins/twindv1.ts&#34;;
</span></span></span><span style=display:flex><span><span style=color:#f92672>-import twindConfig from &#34;./twind.config.ts&#34;;
</span></span></span><span style=display:flex><span><span style=color:#f92672>-
</span></span></span><span style=display:flex><span><span style=color:#f92672>-await start(manifest, { plugins: [twindv1(twindConfig)] });
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+await start(manifest, config);
</span></span></span></code></pre></div><p>同様に、<code>dev.ts</code>に関しても<code>fresh.config.ts</code>から設定を読み込み、<code>dev()</code>関数に渡すように修正します。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>import dev from &#34;$fresh/dev.ts&#34;;
</span></span><span style=display:flex><span><span style=color:#a6e22e>+import config from &#34;./fresh.config.ts&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span> 
</span></span><span style=display:flex><span><span style=color:#f92672>-await dev(import.meta.url, &#34;./main.ts&#34;);
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+await dev(import.meta.url, &#34;./main.ts&#34;, config);
</span></span></span></code></pre></div><h2 id=レイアウト>レイアウト<a hidden class=anchor aria-hidden=true href=#レイアウト>#</a></h2><p>freshでは<code>routes/_app.tsx</code>を用意することで、各Routeに共通のレイアウトを定義することができました。</p><p>しかし、このファイルはアプリケーションごとに一つしか用意できません。</p><p>この課題を解消するため、レイアウトという機能が実装されました。この機能を活用することで、<code>routes/_app.tsx</code>と同様に、特定のRouteに対して共通のレイアウトを定義することができます。</p><p>レイアウトを使いたい際は、<code>_layout.tsx</code>という名前のファイルを<code>routes</code>配下の任意のディレクトリに配置します。これにより、対象ディレクトリ及びその子孫のディレクトリの各Routeがレンダリングされる際に、対象のレイアウトが自動で適用されます。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span><span style=color:#75715e>// routes/admin/_layout.tsx
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#66d9ef>type</span> { <span style=color:#a6e22e>LayoutProps</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;$fresh/server.ts&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>AdminLayout</span>({ <span style=color:#a6e22e>Component</span> }<span style=color:#f92672>:</span> <span style=color:#a6e22e>LayoutProps</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>section</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>h2</span>&gt;<span style=color:#a6e22e>Admin</span>&lt;/<span style=color:#f92672>h2</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>Component</span> /&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>section</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>また、レイアウトは入れ子にすることも可能です。</p><p>例えば以下のようなディレクトリ構造があったとします。</p><pre tabindex=0><code>routes
├── _app.tsx
├── _layout.tsx
├── admin
│   ├── _layout.tsx
│   └── index.tsx
└── index.tsx
</code></pre><p>この場合、<code>routes/admin/index.tsx</code>には以下のレイアウトが適用されます。</p><ul><li>(1) <code>routes/_app.tsx</code></li><li>(2) <code>routes/_layout.tsx</code></li><li>(3) <code>routes/admin/_layout.tsx</code></li></ul><p>また、レイアウトには後述する<code>define</code>ヘルパーが提供されているため、こちらを使用して定義することも可能です。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>defineLayout</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;$fresh/server.ts&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>defineLayout</span>((<span style=color:#a6e22e>_req</span>, { <span style=color:#a6e22e>Component</span> }) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>section</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>h2</span>&gt;<span style=color:#a6e22e>Dashboard</span>&lt;/<span style=color:#f92672>h2</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>main</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>Component</span> /&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>main</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>section</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>このレイアウト機能のサポートに合わせて、<a href="https://deno.land/x/fresh@1.4.0/src/server/types.ts?doc=&s=RouteConfig">RouteConfig</a>に<code>skipAppWrapper</code>/<code>skipInheritedLayouts</code>オプションが追加されています。</p><p>これらのオプションによって、特定のRouteにおいてレイアウトに関する挙動を変更することができます。</p><table><thead><tr><th style=text-align:center>オプション</th><th style=text-align:center>説明</th><th style=text-align:center>デフォルト</th></tr></thead><tbody><tr><td style=text-align:center><code>skipAppWrapper</code></td><td style=text-align:center><code>true</code>を指定すると、対象Routeに対する<code>routes/_app</code>の適用が無効化されます</td><td style=text-align:center><code>false</code></td></tr><tr><td style=text-align:center><code>skipInheritedLayouts</code></td><td style=text-align:center><code>true</code>を指定すると、祖先のディレクトリからのレイアウトの継承が無効化されます</td><td style=text-align:center><code>false</code></td></tr></tbody></table><p>また、レイアウトは<a href=https://uki00a.github.io/deno-weekly/articles/fresh/v1.3.html>v1.3</a>で実装された非同期Routeコンポーネントとして実装することも可能です。この場合、<code>defineLayout</code>ヘルパーを使用すると便利です。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>defineLayout</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;$fresh/server.ts&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>defineLayout</span>&lt;<span style=color:#f92672>AppState</span>&gt;(<span style=color:#66d9ef>async</span> (<span style=color:#a6e22e>_req</span>, { <span style=color:#a6e22e>Component</span>, <span style=color:#a6e22e>params</span>, <span style=color:#a6e22e>state</span> }) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>user</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>findUser</span>(<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>id</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>section</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>h2</span>&gt;<span style=color:#a6e22e>Hi</span> {<span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>name</span>}<span style=color:#f92672>!</span>&lt;/<span style=color:#f92672>h2</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>main</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>Component</span> /&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>main</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>section</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h2 id=app-wrapper>app wrapper<a hidden class=anchor aria-hidden=true href=#app-wrapper>#</a></h2><h3 id=html-head-metaなどのタグのサポート><code>html</code>, <code>head</code>, <code>meta</code>などのタグのサポート<a hidden class=anchor aria-hidden=true href=#html-head-metaなどのタグのサポート>#</a></h3><p><code>routes/_app.tsx</code>から<code>html</code>, <code>head</code>, <code>meta</code>などのタグをレンダリングできるようになりました。</p><p>これにより、<code>html</code>の<code>lang</code>属性の設定などが容易になりそうです。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span><span style=color:#75715e>// routes/_app.tsx
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>AppProps</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;$fresh/server.ts&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>Header</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;../components/Header.tsx&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>Footer</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;../components/Footer.tsx&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>App</span>({ <span style=color:#a6e22e>Component</span> }<span style=color:#f92672>:</span> <span style=color:#a6e22e>AppProps</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>html</span> <span style=color:#a6e22e>lang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ja&#34;</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>charSet</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;utf-8&#34;</span> /&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viewport&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;width=device-width, initial-scale=1.0&#34;</span> /&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>title</span>&gt;<span style=color:#a6e22e>Sample</span> <span style=color:#a6e22e>Fresh</span> <span style=color:#a6e22e>Project</span>&lt;/<span style=color:#f92672>title</span>&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>Header</span> /&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>main</span>&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>Component</span> /&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>main</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>Footer</span> /&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>html</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=非同期routeコンポーネント形式のサポート>非同期Routeコンポーネント形式のサポート<a hidden class=anchor aria-hidden=true href=#非同期routeコンポーネント形式のサポート>#</a></h3><p><code>routes/_app.tsx</code>を<a href=https://uki00a.github.io/deno-weekly/articles/fresh/v1.3.html>v1.3</a>でサポートされた非同期Routeコンポーネントとして定義できるよう改善が行われています。この場合、<code>defineApp</code>を使用すると便利です。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span><span style=color:#75715e>// routes/_app.tsx
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>defineApp</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;$fresh/server.ts&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>defineApp</span>(<span style=color:#66d9ef>async</span> (<span style=color:#a6e22e>_req</span>, { <span style=color:#a6e22e>Component</span> }) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>title</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>getTitle</span>();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>html</span> <span style=color:#a6e22e>lang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ja&#34;</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>charSet</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;utf-8&#34;</span> /&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viewport&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;width=device-width, initial-scale=1.0&#34;</span> /&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>title</span>&gt;{<span style=color:#a6e22e>title</span>}&lt;/<span style=color:#f92672>title</span>&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>Component</span> /&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>html</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h2 id=defineヘルパー><code>define*</code>ヘルパー<a hidden class=anchor aria-hidden=true href=#defineヘルパー>#</a></h2><p>freshの各種構成要素の定義を簡易化するためのヘルパーが追加されました。</p><p>すでに登場している<code>defineConfig</code>や<code>defineLayout</code>, <code>defineApp</code>に加えて、<a href="https://deno.land/x/fresh@1.4.0/src/server/defines.ts?doc=&s=defineRoute">defineRoute</a>というヘルパーが追加されています。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span><span style=color:#75715e>// routes/blog/[id].tsx
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>defineRoute</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;$fresh/server.ts&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>defineRoute</span>(<span style=color:#66d9ef>async</span> (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>ctx</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>content</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>readContent</span>(<span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>id</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span>&gt;{<span style=color:#a6e22e>content</span>}&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h2 id=route-groups>Route Groups<a hidden class=anchor aria-hidden=true href=#route-groups>#</a></h2><p>freshでNext.jsライクなRoute Groups機能がサポートされました。</p><p>Route Groupを定義したい場合、<code>routes/</code>ディレクトリに<code>(&lt;name>)</code>というような形式のディレクトリを作成します。</p><p>このような形式で命名されたディレクトリについては、freshによって特別な扱いがなされます。
例えば、以下のような構成のプロジェクトが存在したとします。</p><pre tabindex=0><code>routes
├── (_islands)
│   └── Counter.tsx
├── (dashboard)
│   ├── _layout.tsx
│   ├── _middleware.ts
│   └── account.tsx
├── _app.tsx
├── _layout.tsx
└── index.tsx
</code></pre><p>この場合、<code>/account</code>にアクセスすることで<code>routes/(dashboard)/account.tsx</code>がレンダリングされます。また、Route Groupごとにレイアウトやミドルウェアを配置することができます。</p><p>例外として、<code>(_foo)</code>というような形式で命名されたディレクトリはfreshによってファイルシステムルーティングの対象から除外されます。
そのため、例えば、<code>(_components)</code>ディレクトリを用意し、そこに特定のRouteに関連したコンポーネントなどの一覧をまとめておくことなどが可能です。</p><pre tabindex=0><code>routes/(dashboard)
├── (_components)
│   └── Chart.tsx
├── (_utils)
│   └── index.tsx
├── _layout.tsx
└── account.tsx
└── index.tsx
</code></pre><p>その他にも、特殊なルールとして、freshは<code>(_islands)</code>という名前のディレクトリに配置されたコンポーネントをIslandコンポーネントとして認識します。</p><h2 id=その他の改善について>その他の改善について<a hidden class=anchor aria-hidden=true href=#その他の改善について>#</a></h2><h3 id=サーバでhttpsがサポート>サーバでHTTPSがサポート<a hidden class=anchor aria-hidden=true href=#サーバでhttpsがサポート>#</a></h3><p><a href="https://deno.land/x/fresh@1.4.2/src/server/mod.ts?s=start">start()</a>関数にTLS関連のオプションを指定することで有効化できます。</p><h3 id=プラグイン経由でミドルウェアを注入する際の挙動の改善>プラグイン経由でミドルウェアを注入する際の挙動の改善<a hidden class=anchor aria-hidden=true href=#プラグイン経由でミドルウェアを注入する際の挙動の改善>#</a></h3><p>複数のプラグインから同一Routeに適用されるミドルウェアが複数存在する場合に、それらが適切にマージされるように挙動が改善されました。</p><h2 id=文字列形式のイベントハンドラのサポート>文字列形式のイベントハンドラのサポート<a hidden class=anchor aria-hidden=true href=#文字列形式のイベントハンドラのサポート>#</a></h2><p>文字列形式でイベントハンドラを設定できるようになりました。(型エラーが発生するため<code>@ts-expect-error</code>の指定などが必要です)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span>  &lt;<span style=color:#f92672>button</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;button&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>//</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ts</span><span style=color:#960050;background-color:#1e0010>-</span><span style=color:#a6e22e>expect</span><span style=color:#960050;background-color:#1e0010>-</span><span style=color:#a6e22e>error</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;alert(&#39;foobar&#39;)&#34;</span>&gt;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Hello</span>
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>button</span>&gt;
</span></span></code></pre></div><h2 id=参考>参考<a hidden class=anchor aria-hidden=true href=#参考>#</a></h2><ul><li><a href=https://deno.com/blog/fresh-1.4>https://deno.com/blog/fresh-1.4</a></li><li><a href=https://github.com/denoland/fresh/releases/tag/1.4.0>https://github.com/denoland/fresh/releases/tag/1.4.0</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://uki00a.github.io/deno-weekly/tags/fresh.html>fresh</a></li><li><a href=https://uki00a.github.io/deno-weekly/tags/preact.html>Preact</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://uki00a.github.io/deno-weekly/>週刊Deno</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>