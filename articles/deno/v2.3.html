<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Deno v2.3 | 週刊Deno</title><meta name=keywords content="Deno,Deno KV,OpenTelemetry"><meta name=description content="Deno v2.3がリリース, `deno.lock`のv5がデフォルトで有効化, `deno add`コマンドに`--npm`と`--jsr`オプションが追加, 引数なしでの`deno check`がサポート, `tsconfig.json`の自動検出がサポート, `deno compile`でFFIとNode.jsネイティブアドオンのサポート, `deno compile`コマンドに`--exclude`オプションが追加, `deno fmt`コマンドでTagged template内のHTML/CSS/SQLのフォーマットがサポート, `deno fmt`コマンドで`dprint-plugin-typescript`のオプションのサポートが拡充, `deno test --coverage`がカバレッジレポートの生成も行うよう変更, コメントによるカバレッジ収集の制御がサポート, `deno lsp`で`deno jupyter`向けの挙動の改善が実施, `deno clean`に`--except`オプションが追加, `Deno.connect()`で`AbortSignal`がサポート, `Deno.webgpu`APIの追加, `--allow-env`の挙動の改善, Windows向けの実行可能ファイルへのコード署名, `node:sqlite` - `DatabaseSync#loadExtension`が実装, TypeScript v5.8へのアップデート, OpenTelemetry - Span Links/Span Eventsに設定されたAttributesの送信がサポート, など"><meta name=author content><link rel=canonical href=https://uki00a.github.io/deno-weekly/articles/deno/v2.3.html><link crossorigin=anonymous href=/deno-weekly/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/deno-weekly/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://raw.githubusercontent.com/uki00a/blog/master/src/assets/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://uki00a.github.io/deno-weekly/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://uki00a.github.io/deno-weekly/favicon-32x32.png><link rel=apple-touch-icon href=https://uki00a.github.io/deno-weekly/apple-touch-icon.png><link rel=mask-icon href=https://uki00a.github.io/deno-weekly/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:image" content="https://raw.githubusercontent.com/uki00a/blog/master/src/assets/avatar.png"><meta property="twitter:image" content="https://raw.githubusercontent.com/uki00a/blog/master/src/assets/avatar.png"><meta name=twitter:site content="@uki00a"><script async src="https://www.googletagmanager.com/gtag/js?id=G-MK2K2MRMBF"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-MK2K2MRMBF",{anonymize_ip:!1})}</script><meta property="og:title" content="Deno v2.3"><meta property="og:description" content="Deno v2.3がリリース, `deno.lock`のv5がデフォルトで有効化, `deno add`コマンドに`--npm`と`--jsr`オプションが追加, 引数なしでの`deno check`がサポート, `tsconfig.json`の自動検出がサポート, `deno compile`でFFIとNode.jsネイティブアドオンのサポート, `deno compile`コマンドに`--exclude`オプションが追加, `deno fmt`コマンドでTagged template内のHTML/CSS/SQLのフォーマットがサポート, `deno fmt`コマンドで`dprint-plugin-typescript`のオプションのサポートが拡充, `deno test --coverage`がカバレッジレポートの生成も行うよう変更, コメントによるカバレッジ収集の制御がサポート, `deno lsp`で`deno jupyter`向けの挙動の改善が実施, `deno clean`に`--except`オプションが追加, `Deno.connect()`で`AbortSignal`がサポート, `Deno.webgpu`APIの追加, `--allow-env`の挙動の改善, Windows向けの実行可能ファイルへのコード署名, `node:sqlite` - `DatabaseSync#loadExtension`が実装, TypeScript v5.8へのアップデート, OpenTelemetry - Span Links/Span Eventsに設定されたAttributesの送信がサポート, など"><meta property="og:type" content="article"><meta property="og:url" content="https://uki00a.github.io/deno-weekly/articles/deno/v2.3.html"><meta property="article:section" content="articles"><meta property="article:published_time" content="2025-05-04T00:00:00+00:00"><meta property="article:modified_time" content="2025-05-04T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Deno v2.3"><meta name=twitter:description content="Deno v2.3がリリース, `deno.lock`のv5がデフォルトで有効化, `deno add`コマンドに`--npm`と`--jsr`オプションが追加, 引数なしでの`deno check`がサポート, `tsconfig.json`の自動検出がサポート, `deno compile`でFFIとNode.jsネイティブアドオンのサポート, `deno compile`コマンドに`--exclude`オプションが追加, `deno fmt`コマンドでTagged template内のHTML/CSS/SQLのフォーマットがサポート, `deno fmt`コマンドで`dprint-plugin-typescript`のオプションのサポートが拡充, `deno test --coverage`がカバレッジレポートの生成も行うよう変更, コメントによるカバレッジ収集の制御がサポート, `deno lsp`で`deno jupyter`向けの挙動の改善が実施, `deno clean`に`--except`オプションが追加, `Deno.connect()`で`AbortSignal`がサポート, `Deno.webgpu`APIの追加, `--allow-env`の挙動の改善, Windows向けの実行可能ファイルへのコード署名, `node:sqlite` - `DatabaseSync#loadExtension`が実装, TypeScript v5.8へのアップデート, OpenTelemetry - Span Links/Span Eventsに設定されたAttributesの送信がサポート, など"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Deno v2.3","item":"https://uki00a.github.io/deno-weekly/articles/deno/v2.3.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Deno v2.3","name":"Deno v2.3","description":"Deno v2.3がリリース, `deno.lock`のv5がデフォルトで有効化, `deno add`コマンドに`--npm`と`--jsr`オプションが追加, 引数なしでの`deno check`がサポート, `tsconfig.json`の自動検出がサポート, `deno compile`でFFIとNode.jsネイティブアドオンのサポート, `deno compile`コマンドに`--exclude`オプションが追加, `deno fmt`コマンドでTagged template内のHTML/CSS/SQLのフォーマットがサポート, `deno fmt`コマンドで`dprint-plugin-typescript`のオプションのサポートが拡充, `deno test --coverage`がカバレッジレポートの生成も行うよう変更, コメントによるカバレッジ収集の制御がサポート, `deno lsp`で`deno jupyter`向けの挙動の改善が実施, `deno clean`に`--except`オプションが追加, `Deno.connect()`で`AbortSignal`がサポート, `Deno.webgpu`APIの追加, `--allow-env`の挙動の改善, Windows向けの実行可能ファイルへのコード署名, `node:sqlite` - `DatabaseSync#loadExtension`が実装, TypeScript v5.8へのアップデート, OpenTelemetry - Span Links/Span Eventsに設定されたAttributesの送信がサポート, など","keywords":["Deno","Deno KV","OpenTelemetry"],"articleBody":"はじめに Deno v2.3がリリースされました。\nこの記事では主な変更点などについて解説します。\nv2.3のRCバージョンでの変更内容に関しては以下を参照いただければと思います:\n Deno v2.3.0-rc.1〜rc.3  また、Deno v2.3に関する公式ブログではすでに実装されていたnpmパッケージへのパッチ機能やvsockのサポートなどについても正式にアナウンスされています。\ndeno.lock v5 deno.lockのv5 (\"version\": \"5\")がデフォルトで有効化されました。\n今後、deno.lockが新しく作成される際はv5がデフォルトで有効化されます。\ndeno add --npmと--jsrオプションがサポート deno addとdeno installコマンドで--npmと--jsrオプションがサポートされています (#28666)\n複数のJSRまたはnpmパッケージをまとめて追加する際の記述を若干簡略化できます:\n# `jsr:@std/uuid`と`jsr:@std/ulid`を追加 $ deno add --jsr @std/uuid @std/ulid  # `npm:koa`を追加 $ deno add --npm koa  # `--jsr`オプションを指定した状態でnpmパッケージをインストールする場合、`npm:`を明示する必要があります $ deno add --jsr @std/uuid @std/ulid npm:koa deno check 引数なしでのdeno checkがサポート deno checkを引数なしで実行した際に、deno check .と同等の振る舞いをするよう改善されています (#28655)\ntsconfig.jsonの自動検出 deno.jsonもしくはpackage.jsonがある際は、tsconfig.jsonが自動で検出されるよう改善されています (#29092)\ndeno.jsonでcompilerOptionsが定義されている際はこの検出機能は無効化されます。\ncompilerOptions.erasableSyntaxOnlyのサポート 後述するTypeScript v5.8へのアップデートに合わせて、compilerOptions.erasableSyntaxOnlyがサポートされています (#29097)\ndeno compile FFIとNode.jsネイティブアドオン (.node)のサポート deno compileでFFIやNode.jsネイティブアドオンを利用したコードに対する実行可能ファイルの作成がサポートされました (#28934)\n現状では、v2.1でdeno compileに追加されたV8コードキャッシュへのサポートと同様に、/tmpディレクトリに共有ライブラリやNode.jsアドオンを書き込むことで実現されているようです。そのため、一部シナリオにおいてはうまく動作しないことも考えられるようです。この点に関しては、今後、改善が検討されているようです (#28918)\n--excludeがサポート deno compileコマンドに--excludeオプションが追加されています (#28805)\n--includeオプションとの併用が想定されており、実行可能ファイルに埋め込むディレクトリから特定のファイルを除外したい場合に使用します:\n# `./data/test.txt`と`./data/dummy.txt`の埋め込みを無効化します $ deno compile --include ./data --exclude ./data/test.txt --exclude ./data/dummy.txt main.js Explicit Resource Managementのサポート deno compileによって生成された実行可能ファイルでExplicit Resource Managementが動作するよう改善されています (#29084)\ndeno fmt Tagged template内のHTML/CSS/SQLのフォーマットがサポート deno fmtコマンドがtagged template内のHTMLやCSS, SQLなどをフォーマットしてくれるよう改善されています (#29014)\nSQLのフォーマットについてはまだ実験的サポートの段階であるため、使用する場合は場合は--unstable-sqlの指定が必要です。\n例えば、以下のようなコードがあったとします:\nsql` SELECT * FROM users; `; deno fmt --unstable-sqlを実行すると、以下のようにフォーマットされます:\nsql` SELECT * FROM users; `; dprint-plugin-typescriptのオプションの追加 dprint-plugin-typescriptで提供される以下のオプションがサポートされました (https://dprint.dev/plugins/typescript/config/)\n quoteProps useBraces bracePosition singleBodyPosition nextControlFlowPosition trailingCommas operatorPosition jsx.bracketPosition jsx.forceNewLinesSurroundingContent jsx.multiLineParens typeLiteral.separatorKind spaceAround spaceSurroundingProperties  これらのオプションはdeno.jsonのfmt配下で設定可能です (#28946)\n--permit-no-filesのサポート deno fmtで--permit-no-filesオプションがサポートされています。\nこのオプションを指定すると、フォーマット対象のファイルが一つも見つからない場合でもエラーが発生しなくなります。\ndeno lint --permit-no-filesのサポート deno lintでも--permit-no-filesオプションがサポートされています。挙動はdeno fmtの同名オプションと同様です。\ndeno coverage deno test --coverageの挙動が変更 deno test --coverageコマンドがカバレッジレポートの生成も行うよう挙動が変更されています (今までは、別途、deno coverageコマンドの実行が必要でした)\n以前のバージョンまでの挙動に戻すには--coverage-raw-data-onlyの指定が必要です。\nDENO_COVERAGE_DIR DENO_COVERAGE_DIR環境変数が追加されています (#28291)\nこの環境変数を設定しておくと、deno testコマンドが指定したディレクトリへカバレッジを保存します (deno test --coverageと同様の挙動をします)\n// deno-coverage-ignoreコメント カバレッジの収集を制御するための特殊コメントがサポートされています (#26590)\n   コメント 説明     // deno-coverage-ignore 次の行が集計対象から除外されます   // deno-coverage-ignore-startと// deno-coverage-ignore-stop それぞれのコメントで囲まれた範囲が集計対象から除外されます   // deno-coverage-ignore-file 宣言されたファイルは集計対象から除外されます    deno lsp deno jupyter使用時の振る舞いの改善 各セル間で変数や型定義、依存モジュールの宣言などが共有されるよう挙動が改善されています (#28769)\nImport Mapsでマッピングされたモジュールに対するAuto importの挙動が変更 Import Mapsでマッピングされたモジュールに対してAuto importを適用する際に、相対パス形式でimportが挿入されるよう挙動が変更されています (#29098)\nバグ修正 Deno 2.2.7から発生していた型チェックに関する問題や意図せぬ箇所に対して診断が報告される問題などが修正されています (#29061, #29019)\ndeno serve DENO_SERVE_ADDRESS DENO_SERVE_ADDRESS環境変数がサポートされています。\ndeno serveコマンドがデフォルトで利用するアドレスを設定できます:\n# `127.0.0.1:3000`でHTTPサーバーを起動します $ DENO_SERVE_ADDRESS=tcp:127.0.0.1:3000 deno serve main.js unix:から始まるアドレスを指定することでUNIXドメインソケットを、vsock:から始まるアドレスを指定することでvsockを使用することも可能です。\n--openオプションのサポート deno serveコマンドに--openオプションが追加されています (#25340)\nこのオプションを指定すると、Denoが自動でブラウザーを開いてくれます\ndeno clean --exceptがサポート deno cleanコマンドで--exceptオプションがサポートされています (#28424)\nこのオプションが指定された場合、グローバルキャッシュ (DENO_DIR) を削除する際に、指定したエントリーポイントの実行において必要とされるファイルのみは削除せずに保持してくれます:\n# `npm:koa`の実行に必要なファイルは維持する $ deno clean --except npm:koa  # `jsr:@std/uuid`の実行に必要なファイルは維持する $ deno clean --except jsr:@std/uuid また、--dry-runオプションも追加されており、deno cleanによって削除される予定のファイルを確認することができます:\n$ deno clean --dry-run --except jsr:@std/uuid deno info Denoのバージョンが追加 deno infoコマンドの出力にDenoのバージョン (denoVersion) が含まれるよう改善されました:\n$ deno info --json | jq .denoVersion \"2.3.1\" Deno API Deno.connect()でAbortSignalがサポート signalオプションにAbortSignalを指定することで、コネクション接続時のタイムアウトの制御などができます (#27113)\nDeno.build.standalone Deno.build.standaloneが追加されています (#28750)\ndeno compileによって生成された実行可能ファイルである場合のみtrueが設定されます。\nDeno.createHttpClientでlocalAddressオプションがサポート このオプションを設定することで、fetch()の利用時に使用されるローカルIPアドレスを選択できます (#28781)\nDeno.webgpu Deno.webgpuが追加されています (#28192)\n今のところdeviceStartCaptureとdeviceStopCaptureの2つのAPIが提供されています (利用には--unstable-webgpuの指定が必要です)\nCLI --allow-envの挙動の改善 セキュリティ改善 --deny-envが指定された際はDeno.env.toObject()の実行が拒否されるよう挙動が改善されています (#29079)\nまた、アクセスが許可されていない環境変数をprocess.envから読んだ際に、undefinedを返すのではなくDeno.errors.NotCapableをthrowするよう挙動が変更されています (#28280)\nNO_COLOR/FORCE_COLORに関する挙動の変更 NO_COLORとFORCE_COLOR環境変数を--allow-envなしで読み込めるよう挙動が修正されています (#29090, #28280)\nDENO_CACHE_DB_MODE/DENO_KV_DB_MODE環境変数がサポート Web Cache APIとDeno KVにおいてSQLiteに関する挙動を制御するためのDENO_CACHE_DB_MODE/DENO_KV_DB_MODE環境変数が追加されています (#29026)\nこれらの環境変数にはdiskまたはmemoryのいずれかを指定可能です (デフォルトはdisk)\nmemoryを指定した場合、インメモリデーターベース (:memory:)の使用が強制されます。テストコードなどにおいて役立ちそうです。\nDENO_EMIT_CACHE_MODE環境変数 DENO_EMIT_CACHE_MODE環境変数が追加されています (#29025)\nサポートされている値はnormal (デフォルト)もしくはdisableのいずれかで、disableを指定することで、トランスパイルされたコードのファイルシステムへのキャッシュを無効化できます。\n--v8-flags=--single-threaded --v8-flags=--single-threadedがサポートされています (#29066)\nこれを指定すると、V8が単一のスレッドのみを使用してタスクを処理するよう挙動が変更されます。単純なスクリプトにおいての使用が想定されているようです。\nWindows向けの実行可能ファイルへのコード署名 Windows向けのDenoの実行可能ファイルにコード署名が適用されています (#28963)\nDenoの公式ブログによると、この変更によってWindows DefenderからDenoの実行可能ファイルが信頼されるよう改善されるとのことです。\nNode.js互換性の改善 node:sqlite DatabaseSync#loadExtensionが実装されています (#29050)\nこのAPIを利用するには--allow-ffiの指定が必要です。\nnode:http HTTPサーバーのパフォーマンス改善が実施されています。\nServerResponse#endの不要な呼び出しの削減 (#29069)やAbortSignalの取り扱いの改善 (#29071)が実施されています。\nnode:assert assert.deepStrictEqual(0, -0)が等価と判定されてしまう問題が修正されています (#29060)\nnode:fs readFile()においてsignalオプションがサポートされています (#29028)\nnode:dns ttlオプションのサポートが追加されています (#27676)\nTypeScript v5.8 Denoに搭載されたTypeScriptがv5.8.3へアップデートされています (#29041)\n https://devblogs.microsoft.com/typescript/announcing-typescript-5-8/  また、このアップデートに合わせて、前述したcompilerOptions.erasableSyntaxOnlyのサポートも導入されています。\nOpenTelemetry Span Links/Span EventsでAttributesがサポート Span Links/Span Eventsに設定されたAttributesのバックエンドへの送信がサポートされています (#28584)\n参考  https://github.com/denoland/deno/releases/tag/v2.3.0 Deno 2.3: Improved deno compile, local npm packages, and more  ","wordCount":"370","inLanguage":"en","datePublished":"2025-05-04T00:00:00Z","dateModified":"2025-05-04T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://uki00a.github.io/deno-weekly/articles/deno/v2.3.html"},"publisher":{"@type":"Organization","name":"週刊Deno","logo":{"@type":"ImageObject","url":"https://raw.githubusercontent.com/uki00a/blog/master/src/assets/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://uki00a.github.io/deno-weekly/ accesskey=h title="週刊Deno (Alt + H)">週刊Deno</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://uki00a.github.io/deno-weekly/tags.html title=タグ><span><i class="fa fa-heart"></i>タグ</span></a></li><li><a href=https://uki00a.github.io/deno-weekly/categories.html title=カテゴリー><span><i class="fa fa-heart"></i>カテゴリー</span></a></li><li><a href=https://uki00a.github.io/deno-weekly/gallery.html title=ギャラリー><span><i class="fa fa-road"></i>ギャラリー<span class=alert></span></span></a></li><li><a href=https://uki00a.github.io/deno-weekly/index.xml title="RSS feed"><span><i class="fa fa-road"></i>RSS feed<span class=alert></span></span></a></li><li><a href=https://uki00a.github.io/deno-weekly/about.html title=About><span><i class="fa fa-road"></i>About<span class=alert></span></span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Deno v2.3</h1><div class=post-description>Deno v2.3がリリース, `deno.lock`のv5がデフォルトで有効化, `deno add`コマンドに`--npm`と`--jsr`オプションが追加, 引数なしでの`deno check`がサポート, `tsconfig.json`の自動検出がサポート, `deno compile`でFFIとNode.jsネイティブアドオンのサポート, `deno compile`コマンドに`--exclude`オプションが追加, `deno fmt`コマンドでTagged template内のHTML/CSS/SQLのフォーマットがサポート, `deno fmt`コマンドで`dprint-plugin-typescript`のオプションのサポートが拡充, `deno test --coverage`がカバレッジレポートの生成も行うよう変更, コメントによるカバレッジ収集の制御がサポート, `deno lsp`で`deno jupyter`向けの挙動の改善が実施, `deno clean`に`--except`オプションが追加, `Deno.connect()`で`AbortSignal`がサポート, `Deno.webgpu`APIの追加, `--allow-env`の挙動の改善, Windows向けの実行可能ファイルへのコード署名, `node:sqlite` - `DatabaseSync#loadExtension`が実装, TypeScript v5.8へのアップデート, OpenTelemetry - Span Links/Span Eventsに設定されたAttributesの送信がサポート, など</div><div class=post-meta><span title="2025-05-04 00:00:00 +0000 UTC">May 4, 2025</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e3%81%af%e3%81%98%e3%82%81%e3%81%ab aria-label=はじめに>はじめに</a></li><li><a href=#denolock-v5 aria-label="deno.lock v5"><code>deno.lock</code> v5</a></li><li><a href=#deno-add aria-label="deno add"><code>deno add</code></a><ul><li><a href=#--npm%e3%81%a8--jsr%e3%82%aa%e3%83%97%e3%82%b7%e3%83%a7%e3%83%b3%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=--npmと--jsrオプションがサポート><code>--npm</code>と<code>--jsr</code>オプションがサポート</a></li></ul></li><li><a href=#deno-check aria-label="deno check"><code>deno check</code></a><ul><li><a href=#%e5%bc%95%e6%95%b0%e3%81%aa%e3%81%97%e3%81%a7%e3%81%aedeno-check%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label="引数なしでのdeno checkがサポート">引数なしでの<code>deno check</code>がサポート</a></li><li><a href=#tsconfigjson%e3%81%ae%e8%87%aa%e5%8b%95%e6%a4%9c%e5%87%ba aria-label=tsconfig.jsonの自動検出><code>tsconfig.json</code>の自動検出</a></li><li><a href=#compileroptionserasablesyntaxonly%e3%81%ae%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=compilerOptions.erasableSyntaxOnlyのサポート><code>compilerOptions.erasableSyntaxOnly</code>のサポート</a></li></ul></li><li><a href=#deno-compile aria-label="deno compile"><code>deno compile</code></a><ul><li><a href=#ffi%e3%81%a8nodejs%e3%83%8d%e3%82%a4%e3%83%86%e3%82%a3%e3%83%96%e3%82%a2%e3%83%89%e3%82%aa%e3%83%b3-node%e3%81%ae%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label="FFIとNode.jsネイティブアドオン (.node)のサポート">FFIとNode.jsネイティブアドオン (<code>.node</code>)のサポート</a></li><li><a href=#--exclude%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=--excludeがサポート><code>--exclude</code>がサポート</a></li><li><a href=#explicit-resource-management%e3%81%ae%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label="Explicit Resource Managementのサポート">Explicit Resource Managementのサポート</a></li></ul></li><li><a href=#deno-fmt aria-label="deno fmt"><code>deno fmt</code></a><ul><li><a href=#tagged-template%e5%86%85%e3%81%aehtmlcsssql%e3%81%ae%e3%83%95%e3%82%a9%e3%83%bc%e3%83%9e%e3%83%83%e3%83%88%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label="Tagged template内のHTML/CSS/SQLのフォーマットがサポート">Tagged template内のHTML/CSS/SQLのフォーマットがサポート</a></li><li><a href=#dprint-plugin-typescript%e3%81%ae%e3%82%aa%e3%83%97%e3%82%b7%e3%83%a7%e3%83%b3%e3%81%ae%e8%bf%bd%e5%8a%a0 aria-label=dprint-plugin-typescriptのオプションの追加><code>dprint-plugin-typescript</code>のオプションの追加</a></li><li><a href=#--permit-no-files%e3%81%ae%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=--permit-no-filesのサポート><code>--permit-no-files</code>のサポート</a></li></ul></li><li><a href=#deno-lint aria-label="deno lint"><code>deno lint</code></a><ul><li><a href=#--permit-no-files%e3%81%ae%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88-1 aria-label=--permit-no-filesのサポート><code>--permit-no-files</code>のサポート</a></li></ul></li><li><a href=#deno-coverage aria-label="deno coverage"><code>deno coverage</code></a><ul><li><a href=#deno-test---coverage%e3%81%ae%e6%8c%99%e5%8b%95%e3%81%8c%e5%a4%89%e6%9b%b4 aria-label="deno test --coverageの挙動が変更"><code>deno test --coverage</code>の挙動が変更</a></li><li><a href=#deno_coverage_dir aria-label=DENO_COVERAGE_DIR><code>DENO_COVERAGE_DIR</code></a></li><li><a href=#-deno-coverage-ignore%e3%82%b3%e3%83%a1%e3%83%b3%e3%83%88 aria-label="// deno-coverage-ignoreコメント"><code>// deno-coverage-ignore</code>コメント</a></li></ul></li><li><a href=#deno-lsp aria-label="deno lsp"><code>deno lsp</code></a><ul><li><a href=#deno-jupyter%e4%bd%bf%e7%94%a8%e6%99%82%e3%81%ae%e6%8c%af%e3%82%8b%e8%88%9e%e3%81%84%e3%81%ae%e6%94%b9%e5%96%84 aria-label="deno jupyter使用時の振る舞いの改善"><code>deno jupyter</code>使用時の振る舞いの改善</a></li><li><a href=#import-maps%e3%81%a7%e3%83%9e%e3%83%83%e3%83%94%e3%83%b3%e3%82%b0%e3%81%95%e3%82%8c%e3%81%9f%e3%83%a2%e3%82%b8%e3%83%a5%e3%83%bc%e3%83%ab%e3%81%ab%e5%af%be%e3%81%99%e3%82%8bauto-import%e3%81%ae%e6%8c%99%e5%8b%95%e3%81%8c%e5%a4%89%e6%9b%b4 aria-label="Import Mapsでマッピングされたモジュールに対するAuto importの挙動が変更">Import Mapsでマッピングされたモジュールに対するAuto importの挙動が変更</a></li><li><a href=#%e3%83%90%e3%82%b0%e4%bf%ae%e6%ad%a3 aria-label=バグ修正>バグ修正</a></li></ul></li><li><a href=#deno-serve aria-label="deno serve"><code>deno serve</code></a><ul><li><a href=#deno_serve_address aria-label=DENO_SERVE_ADDRESS><code>DENO_SERVE_ADDRESS</code></a></li><li><a href=#--open%e3%82%aa%e3%83%97%e3%82%b7%e3%83%a7%e3%83%b3%e3%81%ae%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=--openオプションのサポート><code>--open</code>オプションのサポート</a></li></ul></li><li><a href=#deno-clean aria-label="deno clean"><code>deno clean</code></a><ul><li><a href=#--except%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=--exceptがサポート><code>--except</code>がサポート</a></li></ul></li><li><a href=#deno-info aria-label="deno info"><code>deno info</code></a><ul><li><a href=#deno%e3%81%ae%e3%83%90%e3%83%bc%e3%82%b8%e3%83%a7%e3%83%b3%e3%81%8c%e8%bf%bd%e5%8a%a0 aria-label=Denoのバージョンが追加>Denoのバージョンが追加</a></li></ul></li><li><a href=#deno-api aria-label="Deno API">Deno API</a><ul><li><a href=#denoconnect%e3%81%a7abortsignal%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=Deno.connect()でAbortSignalがサポート><code>Deno.connect()</code>で<code>AbortSignal</code>がサポート</a></li><li><a href=#denobuildstandalone aria-label=Deno.build.standalone><code>Deno.build.standalone</code></a></li><li><a href=#denocreatehttpclient%e3%81%a7localaddress%e3%82%aa%e3%83%97%e3%82%b7%e3%83%a7%e3%83%b3%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=Deno.createHttpClientでlocalAddressオプションがサポート><code>Deno.createHttpClient</code>で<code>localAddress</code>オプションがサポート</a></li><li><a href=#denowebgpu aria-label=Deno.webgpu><code>Deno.webgpu</code></a></li></ul></li><li><a href=#cli aria-label=CLI>CLI</a><ul><li><a href=#--allow-env%e3%81%ae%e6%8c%99%e5%8b%95%e3%81%ae%e6%94%b9%e5%96%84 aria-label=--allow-envの挙動の改善><code>--allow-env</code>の挙動の改善</a><ul><li><a href=#%e3%82%bb%e3%82%ad%e3%83%a5%e3%83%aa%e3%83%86%e3%82%a3%e6%94%b9%e5%96%84 aria-label=セキュリティ改善>セキュリティ改善</a></li><li><a href=#no_colorforce_color%e3%81%ab%e9%96%a2%e3%81%99%e3%82%8b%e6%8c%99%e5%8b%95%e3%81%ae%e5%a4%89%e6%9b%b4 aria-label=NO_COLOR/FORCE_COLORに関する挙動の変更><code>NO_COLOR</code>/<code>FORCE_COLOR</code>に関する挙動の変更</a></li></ul></li><li><a href=#deno_cache_db_modedeno_kv_db_mode%e7%92%b0%e5%a2%83%e5%a4%89%e6%95%b0%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=DENO_CACHE_DB_MODE/DENO_KV_DB_MODE環境変数がサポート><code>DENO_CACHE_DB_MODE</code>/<code>DENO_KV_DB_MODE</code>環境変数がサポート</a></li><li><a href=#deno_emit_cache_mode%e7%92%b0%e5%a2%83%e5%a4%89%e6%95%b0 aria-label=DENO_EMIT_CACHE_MODE環境変数><code>DENO_EMIT_CACHE_MODE</code>環境変数</a></li><li><a href=#--v8-flags--single-threaded aria-label="--v8-flags=--single-threaded"><code>--v8-flags=--single-threaded</code></a></li><li><a href=#windows%e5%90%91%e3%81%91%e3%81%ae%e5%ae%9f%e8%a1%8c%e5%8f%af%e8%83%bd%e3%83%95%e3%82%a1%e3%82%a4%e3%83%ab%e3%81%b8%e3%81%ae%e3%82%b3%e3%83%bc%e3%83%89%e7%bd%b2%e5%90%8d aria-label=Windows向けの実行可能ファイルへのコード署名>Windows向けの実行可能ファイルへのコード署名</a></li></ul></li><li><a href=#nodejs%e4%ba%92%e6%8f%9b%e6%80%a7%e3%81%ae%e6%94%b9%e5%96%84 aria-label=Node.js互換性の改善>Node.js互換性の改善</a><ul><li><a href=#nodesqlite aria-label=node:sqlite><code>node:sqlite</code></a></li><li><a href=#nodehttp aria-label=node:http><code>node:http</code></a></li><li><a href=#nodeassert aria-label=node:assert><code>node:assert</code></a></li><li><a href=#nodefs aria-label=node:fs><code>node:fs</code></a></li><li><a href=#nodedns aria-label=node:dns><code>node:dns</code></a></li></ul></li><li><a href=#typescript-v58 aria-label="TypeScript v5.8">TypeScript v5.8</a></li><li><a href=#opentelemetry aria-label=OpenTelemetry>OpenTelemetry</a><ul><li><a href=#span-linksspan-events%e3%81%a7attributes%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label="Span Links/Span EventsでAttributesがサポート">Span Links/Span EventsでAttributesがサポート</a></li></ul></li><li><a href=#%e5%8f%82%e8%80%83 aria-label=参考>参考</a></li></ul></div></details></div><div class=post-content><h2 id=はじめに>はじめに<a hidden class=anchor aria-hidden=true href=#はじめに>#</a></h2><p>Deno v2.3がリリースされました。</p><p>この記事では主な変更点などについて解説します。</p><p>v2.3のRCバージョンでの変更内容に関しては以下を参照いただければと思います:</p><ul><li><a href=https://uki00a.github.io/deno-weekly/articles/2025/04/27.html>Deno v2.3.0-rc.1〜rc.3</a></li></ul><p>また、<a href=https://deno.com/blog/v2.3>Deno v2.3に関する公式ブログ</a>ではすでに実装されていた<a href=https://uki00a.github.io/deno-weekly/articles/2025/03/23.html>npmパッケージへのパッチ機能</a>や<a href=https://uki00a.github.io/deno-weekly/articles/2025/04/20.html>vsockのサポート</a>などについても正式にアナウンスされています。</p><h2 id=denolock-v5><code>deno.lock</code> v5<a hidden class=anchor aria-hidden=true href=#denolock-v5>#</a></h2><p><a href=https://uki00a.github.io/deno-weekly/articles/2025/04/13.html><code>deno.lock</code>のv5</a> (<code>"version": "5"</code>)がデフォルトで有効化されました。</p><p>今後、<code>deno.lock</code>が新しく作成される際はv5がデフォルトで有効化されます。</p><h2 id=deno-add><code>deno add</code><a hidden class=anchor aria-hidden=true href=#deno-add>#</a></h2><h3 id=--npmと--jsrオプションがサポート><code>--npm</code>と<code>--jsr</code>オプションがサポート<a hidden class=anchor aria-hidden=true href=#--npmと--jsrオプションがサポート>#</a></h3><p><code>deno add</code>と<code>deno install</code>コマンドで<code>--npm</code>と<code>--jsr</code>オプションがサポートされています (<a href=https://github.com/denoland/deno/pull/28666>#28666</a>)</p><p>複数のJSRまたはnpmパッケージをまとめて追加する際の記述を若干簡略化できます:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># `jsr:@std/uuid`と`jsr:@std/ulid`を追加</span>
</span></span><span style=display:flex><span>$ deno add --jsr @std/uuid @std/ulid
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># `npm:koa`を追加</span>
</span></span><span style=display:flex><span>$ deno add --npm koa
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># `--jsr`オプションを指定した状態でnpmパッケージをインストールする場合、`npm:`を明示する必要があります</span>
</span></span><span style=display:flex><span>$ deno add --jsr @std/uuid @std/ulid npm:koa
</span></span></code></pre></div><h2 id=deno-check><code>deno check</code><a hidden class=anchor aria-hidden=true href=#deno-check>#</a></h2><h3 id=引数なしでのdeno-checkがサポート>引数なしでの<code>deno check</code>がサポート<a hidden class=anchor aria-hidden=true href=#引数なしでのdeno-checkがサポート>#</a></h3><p><code>deno check</code>を引数なしで実行した際に、<code>deno check .</code>と同等の振る舞いをするよう改善されています (<a href=https://github.com/denoland/deno/pull/28655>#28655</a>)</p><h3 id=tsconfigjsonの自動検出><code>tsconfig.json</code>の自動検出<a hidden class=anchor aria-hidden=true href=#tsconfigjsonの自動検出>#</a></h3><p><code>deno.json</code>もしくは<code>package.json</code>がある際は、<code>tsconfig.json</code>が自動で検出されるよう改善されています (<a href=https://github.com/denoland/deno/pull/29092>#29092</a>)</p><p><code>deno.json</code>で<code>compilerOptions</code>が定義されている際はこの検出機能は無効化されます。</p><h3 id=compileroptionserasablesyntaxonlyのサポート><code>compilerOptions.erasableSyntaxOnly</code>のサポート<a hidden class=anchor aria-hidden=true href=#compileroptionserasablesyntaxonlyのサポート>#</a></h3><p>後述するTypeScript v5.8へのアップデートに合わせて、<code>compilerOptions.erasableSyntaxOnly</code>がサポートされています (<a href=https://github.com/denoland/deno/pull/29097>#29097</a>)</p><h2 id=deno-compile><code>deno compile</code><a hidden class=anchor aria-hidden=true href=#deno-compile>#</a></h2><h3 id=ffiとnodejsネイティブアドオン-nodeのサポート>FFIとNode.jsネイティブアドオン (<code>.node</code>)のサポート<a hidden class=anchor aria-hidden=true href=#ffiとnodejsネイティブアドオン-nodeのサポート>#</a></h3><p><code>deno compile</code>でFFIやNode.jsネイティブアドオンを利用したコードに対する実行可能ファイルの作成がサポートされました (<a href=https://github.com/denoland/deno/pull/28934>#28934</a>)</p><p>現状では、<a href=https://uki00a.github.io/deno-weekly/articles/deno/v2.1.html>v2.1</a>で<code>deno compile</code>に追加されたV8コードキャッシュへのサポートと同様に、<code>/tmp</code>ディレクトリに共有ライブラリやNode.jsアドオンを書き込むことで実現されているようです。そのため、一部シナリオにおいてはうまく動作しないことも考えられるようです。この点に関しては、今後、改善が検討されているようです (<a href=https://github.com/denoland/deno/issues/28918>#28918</a>)</p><h3 id=--excludeがサポート><code>--exclude</code>がサポート<a hidden class=anchor aria-hidden=true href=#--excludeがサポート>#</a></h3><p><code>deno compile</code>コマンドに<code>--exclude</code>オプションが追加されています (<a href=https://github.com/denoland/deno/pull/28805>#28805</a>)</p><p><a href=https://uki00a.github.io/deno-weekly/articles/deno/v2.1.html><code>--include</code>オプション</a>との併用が想定されており、実行可能ファイルに埋め込むディレクトリから特定のファイルを除外したい場合に使用します:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># `./data/test.txt`と`./data/dummy.txt`の埋め込みを無効化します</span>
</span></span><span style=display:flex><span>$ deno compile --include ./data --exclude ./data/test.txt --exclude ./data/dummy.txt main.js
</span></span></code></pre></div><h3 id=explicit-resource-managementのサポート>Explicit Resource Managementのサポート<a hidden class=anchor aria-hidden=true href=#explicit-resource-managementのサポート>#</a></h3><p><code>deno compile</code>によって生成された実行可能ファイルで<a href=https://github.com/tc39/proposal-explicit-resource-management>Explicit Resource Management</a>が動作するよう改善されています (<a href=https://github.com/denoland/deno/pull/29084>#29084</a>)</p><h2 id=deno-fmt><code>deno fmt</code><a hidden class=anchor aria-hidden=true href=#deno-fmt>#</a></h2><h3 id=tagged-template内のhtmlcsssqlのフォーマットがサポート>Tagged template内のHTML/CSS/SQLのフォーマットがサポート<a hidden class=anchor aria-hidden=true href=#tagged-template内のhtmlcsssqlのフォーマットがサポート>#</a></h3><p><code>deno fmt</code>コマンドがtagged template内のHTMLやCSS, SQLなどをフォーマットしてくれるよう改善されています (<a href=https://github.com/denoland/deno/pull/29014>#29014</a>)</p><p><a href=https://uki00a.github.io/deno-weekly/articles/deno/v2.1.html>SQLのフォーマットについてはまだ実験的サポートの段階である</a>ため、使用する場合は場合は<code>--unstable-sql</code>の指定が必要です。</p><p>例えば、以下のようなコードがあったとします:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>sql</span><span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SELECT
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    *
</span></span></span><span style=display:flex><span><span style=color:#e6db74>FROM
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   users;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>`</span>;
</span></span></code></pre></div><p><code>deno fmt --unstable-sql</code>を実行すると、以下のようにフォーマットされます:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>sql</span><span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  SELECT
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    *
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  FROM
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    users;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>`</span>;
</span></span></code></pre></div><h3 id=dprint-plugin-typescriptのオプションの追加><code>dprint-plugin-typescript</code>のオプションの追加<a hidden class=anchor aria-hidden=true href=#dprint-plugin-typescriptのオプションの追加>#</a></h3><p><a href=https://github.com/dprint/dprint-plugin-typescript>dprint-plugin-typescript</a>で提供される以下のオプションがサポートされました (<a href=https://dprint.dev/plugins/typescript/config/>https://dprint.dev/plugins/typescript/config/</a>)</p><ul><li><code>quoteProps</code></li><li><code>useBraces</code></li><li><code>bracePosition</code></li><li><code>singleBodyPosition</code></li><li><code>nextControlFlowPosition</code></li><li><code>trailingCommas</code></li><li><code>operatorPosition</code></li><li><code>jsx.bracketPosition</code></li><li><code>jsx.forceNewLinesSurroundingContent</code></li><li><code>jsx.multiLineParens</code></li><li><code>typeLiteral.separatorKind</code></li><li><code>spaceAround</code></li><li><code>spaceSurroundingProperties</code></li></ul><p>これらのオプションは<code>deno.json</code>の<code>fmt</code>配下で設定可能です (<a href=https://github.com/denoland/deno/pull/28946>#28946</a>)</p><h3 id=--permit-no-filesのサポート><code>--permit-no-files</code>のサポート<a hidden class=anchor aria-hidden=true href=#--permit-no-filesのサポート>#</a></h3><p><code>deno fmt</code>で<code>--permit-no-files</code>オプションがサポートされています。</p><p>このオプションを指定すると、フォーマット対象のファイルが一つも見つからない場合でもエラーが発生しなくなります。</p><h2 id=deno-lint><code>deno lint</code><a hidden class=anchor aria-hidden=true href=#deno-lint>#</a></h2><h3 id=--permit-no-filesのサポート-1><code>--permit-no-files</code>のサポート<a hidden class=anchor aria-hidden=true href=#--permit-no-filesのサポート-1>#</a></h3><p><code>deno lint</code>でも<code>--permit-no-files</code>オプションがサポートされています。挙動は<code>deno fmt</code>の同名オプションと同様です。</p><h2 id=deno-coverage><code>deno coverage</code><a hidden class=anchor aria-hidden=true href=#deno-coverage>#</a></h2><h3 id=deno-test---coverageの挙動が変更><code>deno test --coverage</code>の挙動が変更<a hidden class=anchor aria-hidden=true href=#deno-test---coverageの挙動が変更>#</a></h3><p><code>deno test --coverage</code>コマンドがカバレッジレポートの生成も行うよう挙動が変更されています (今までは、別途、<code>deno coverage</code>コマンドの実行が必要でした)</p><p>以前のバージョンまでの挙動に戻すには<code>--coverage-raw-data-only</code>の指定が必要です。</p><h3 id=deno_coverage_dir><code>DENO_COVERAGE_DIR</code><a hidden class=anchor aria-hidden=true href=#deno_coverage_dir>#</a></h3><p><code>DENO_COVERAGE_DIR</code>環境変数が追加されています (<a href=https://github.com/denoland/deno/pull/28291>#28291</a>)</p><p>この環境変数を設定しておくと、<code>deno test</code>コマンドが指定したディレクトリへカバレッジを保存します (<code>deno test --coverage</code>と同様の挙動をします)</p><h3 id=-deno-coverage-ignoreコメント><code>// deno-coverage-ignore</code>コメント<a hidden class=anchor aria-hidden=true href=#-deno-coverage-ignoreコメント>#</a></h3><p>カバレッジの収集を制御するための特殊コメントがサポートされています (<a href=https://github.com/denoland/deno/pull/26590>#26590</a>)</p><table><thead><tr><th style=text-align:center>コメント</th><th style=text-align:center>説明</th></tr></thead><tbody><tr><td style=text-align:center><code>// deno-coverage-ignore</code></td><td style=text-align:center>次の行が集計対象から除外されます</td></tr><tr><td style=text-align:center><code>// deno-coverage-ignore-start</code>と<code>// deno-coverage-ignore-stop</code></td><td style=text-align:center>それぞれのコメントで囲まれた範囲が集計対象から除外されます</td></tr><tr><td style=text-align:center><code>// deno-coverage-ignore-file</code></td><td style=text-align:center>宣言されたファイルは集計対象から除外されます</td></tr></tbody></table><h2 id=deno-lsp><code>deno lsp</code><a hidden class=anchor aria-hidden=true href=#deno-lsp>#</a></h2><h3 id=deno-jupyter使用時の振る舞いの改善><code>deno jupyter</code>使用時の振る舞いの改善<a hidden class=anchor aria-hidden=true href=#deno-jupyter使用時の振る舞いの改善>#</a></h3><p>各セル間で変数や型定義、依存モジュールの宣言などが共有されるよう挙動が改善されています (<a href=https://github.com/denoland/deno/pull/28769>#28769</a>)</p><h3 id=import-mapsでマッピングされたモジュールに対するauto-importの挙動が変更>Import Mapsでマッピングされたモジュールに対するAuto importの挙動が変更<a hidden class=anchor aria-hidden=true href=#import-mapsでマッピングされたモジュールに対するauto-importの挙動が変更>#</a></h3><p>Import Mapsでマッピングされたモジュールに対してAuto importを適用する際に、相対パス形式で<code>import</code>が挿入されるよう挙動が変更されています (<a href=https://github.com/denoland/deno/pull/29098>#29098</a>)</p><h3 id=バグ修正>バグ修正<a hidden class=anchor aria-hidden=true href=#バグ修正>#</a></h3><p><a href=https://uki00a.github.io/deno-weekly/articles/2025/04/06.html>Deno 2.2.7</a>から発生していた型チェックに関する問題や意図せぬ箇所に対して診断が報告される問題などが修正されています (<a href=https://github.com/denoland/deno/pull/29061>#29061</a>, <a href=https://github.com/denoland/deno/pull/29019>#29019</a>)</p><h2 id=deno-serve><code>deno serve</code><a hidden class=anchor aria-hidden=true href=#deno-serve>#</a></h2><h3 id=deno_serve_address><code>DENO_SERVE_ADDRESS</code><a hidden class=anchor aria-hidden=true href=#deno_serve_address>#</a></h3><p><code>DENO_SERVE_ADDRESS</code>環境変数がサポートされています。</p><p><code>deno serve</code>コマンドがデフォルトで利用するアドレスを設定できます:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># `127.0.0.1:3000`でHTTPサーバーを起動します</span>
</span></span><span style=display:flex><span>$ DENO_SERVE_ADDRESS<span style=color:#f92672>=</span>tcp:127.0.0.1:3000 deno serve main.js
</span></span></code></pre></div><p><code>unix:</code>から始まるアドレスを指定することでUNIXドメインソケットを、<code>vsock:</code>から始まるアドレスを指定することで<a href=https://uki00a.github.io/deno-weekly/articles/2025/04/20.html>vsock</a>を使用することも可能です。</p><h3 id=--openオプションのサポート><code>--open</code>オプションのサポート<a hidden class=anchor aria-hidden=true href=#--openオプションのサポート>#</a></h3><p><code>deno serve</code>コマンドに<code>--open</code>オプションが追加されています (<a href=https://github.com/denoland/deno/pull/25340>#25340</a>)</p><p>このオプションを指定すると、Denoが自動でブラウザーを開いてくれます</p><h2 id=deno-clean><code>deno clean</code><a hidden class=anchor aria-hidden=true href=#deno-clean>#</a></h2><h3 id=--exceptがサポート><code>--except</code>がサポート<a hidden class=anchor aria-hidden=true href=#--exceptがサポート>#</a></h3><p><a href=https://uki00a.github.io/deno-weekly/articles/deno/v1.46.html><code>deno clean</code></a>コマンドで<code>--except</code>オプションがサポートされています (<a href=https://github.com/denoland/deno/pull/28424>#28424</a>)</p><p>このオプションが指定された場合、グローバルキャッシュ (<code>DENO_DIR</code>) を削除する際に、指定したエントリーポイントの実行において必要とされるファイルのみは削除せずに保持してくれます:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># `npm:koa`の実行に必要なファイルは維持する</span>
</span></span><span style=display:flex><span>$ deno clean --except npm:koa
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># `jsr:@std/uuid`の実行に必要なファイルは維持する</span>
</span></span><span style=display:flex><span>$ deno clean --except jsr:@std/uuid
</span></span></code></pre></div><p>また、<code>--dry-run</code>オプションも追加されており、<code>deno clean</code>によって削除される予定のファイルを確認することができます:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ deno clean --dry-run --except jsr:@std/uuid
</span></span></code></pre></div><h2 id=deno-info><code>deno info</code><a hidden class=anchor aria-hidden=true href=#deno-info>#</a></h2><h3 id=denoのバージョンが追加>Denoのバージョンが追加<a hidden class=anchor aria-hidden=true href=#denoのバージョンが追加>#</a></h3><p><code>deno info</code>コマンドの出力にDenoのバージョン (<code>denoVersion</code>) が含まれるよう改善されました:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ deno info --json | jq .denoVersion
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;2.3.1&#34;</span>
</span></span></code></pre></div><h2 id=deno-api>Deno API<a hidden class=anchor aria-hidden=true href=#deno-api>#</a></h2><h3 id=denoconnectでabortsignalがサポート><code>Deno.connect()</code>で<code>AbortSignal</code>がサポート<a hidden class=anchor aria-hidden=true href=#denoconnectでabortsignalがサポート>#</a></h3><p><code>signal</code>オプションに<code>AbortSignal</code>を指定することで、コネクション接続時のタイムアウトの制御などができます (<a href=https://github.com/denoland/deno/pull/27113>#27113</a>)</p><h3 id=denobuildstandalone><code>Deno.build.standalone</code><a hidden class=anchor aria-hidden=true href=#denobuildstandalone>#</a></h3><p><code>Deno.build.standalone</code>が追加されています (<a href=https://github.com/denoland/deno/pull/28750>#28750</a>)</p><p><code>deno compile</code>によって生成された実行可能ファイルである場合のみ<code>true</code>が設定されます。</p><h3 id=denocreatehttpclientでlocaladdressオプションがサポート><code>Deno.createHttpClient</code>で<code>localAddress</code>オプションがサポート<a hidden class=anchor aria-hidden=true href=#denocreatehttpclientでlocaladdressオプションがサポート>#</a></h3><p>このオプションを設定することで、<code>fetch()</code>の利用時に使用されるローカルIPアドレスを選択できます (<a href=https://github.com/denoland/deno/pull/28781>#28781</a>)</p><h3 id=denowebgpu><code>Deno.webgpu</code><a hidden class=anchor aria-hidden=true href=#denowebgpu>#</a></h3><p><code>Deno.webgpu</code>が追加されています (<a href=https://github.com/denoland/deno/pull/28192>#28192</a>)</p><p>今のところ<code>deviceStartCapture</code>と<code>deviceStopCapture</code>の2つのAPIが提供されています (利用には<code>--unstable-webgpu</code>の指定が必要です)</p><h2 id=cli>CLI<a hidden class=anchor aria-hidden=true href=#cli>#</a></h2><h3 id=--allow-envの挙動の改善><code>--allow-env</code>の挙動の改善<a hidden class=anchor aria-hidden=true href=#--allow-envの挙動の改善>#</a></h3><h4 id=セキュリティ改善>セキュリティ改善<a hidden class=anchor aria-hidden=true href=#セキュリティ改善>#</a></h4><p><code>--deny-env</code>が指定された際は<code>Deno.env.toObject()</code>の実行が拒否されるよう挙動が改善されています (<a href=https://github.com/denoland/deno/pull/29079>#29079</a>)</p><p>また、アクセスが許可されていない環境変数を<code>process.env</code>から読んだ際に、<code>undefined</code>を返すのではなく<code>Deno.errors.NotCapable</code>を<code>throw</code>するよう挙動が変更されています (<a href=https://github.com/denoland/deno/pull/28280>#28280</a>)</p><h4 id=no_colorforce_colorに関する挙動の変更><code>NO_COLOR</code>/<code>FORCE_COLOR</code>に関する挙動の変更<a hidden class=anchor aria-hidden=true href=#no_colorforce_colorに関する挙動の変更>#</a></h4><p><code>NO_COLOR</code>と<code>FORCE_COLOR</code>環境変数を<code>--allow-env</code>なしで読み込めるよう挙動が修正されています (<a href=https://github.com/denoland/deno/pull/29090>#29090</a>, <a href=https://github.com/denoland/deno/pull/28280>#28280</a>)</p><h3 id=deno_cache_db_modedeno_kv_db_mode環境変数がサポート><code>DENO_CACHE_DB_MODE</code>/<code>DENO_KV_DB_MODE</code>環境変数がサポート<a hidden class=anchor aria-hidden=true href=#deno_cache_db_modedeno_kv_db_mode環境変数がサポート>#</a></h3><p><a href=https://uki00a.github.io/deno-weekly/articles/deno/v1.26.html>Web Cache API</a>とDeno KVにおいてSQLiteに関する挙動を制御するための<code>DENO_CACHE_DB_MODE</code>/<code>DENO_KV_DB_MODE</code>環境変数が追加されています (<a href=https://github.com/denoland/deno/pull/29026>#29026</a>)</p><p>これらの環境変数には<code>disk</code>または<code>memory</code>のいずれかを指定可能です (デフォルトは<code>disk</code>)</p><p><code>memory</code>を指定した場合、インメモリデーターベース (<code>:memory:</code>)の使用が強制されます。テストコードなどにおいて役立ちそうです。</p><h3 id=deno_emit_cache_mode環境変数><code>DENO_EMIT_CACHE_MODE</code>環境変数<a hidden class=anchor aria-hidden=true href=#deno_emit_cache_mode環境変数>#</a></h3><p><code>DENO_EMIT_CACHE_MODE</code>環境変数が追加されています (<a href=https://github.com/denoland/deno/pull/29025>#29025</a>)</p><p>サポートされている値は<code>normal</code> (デフォルト)もしくは<code>disable</code>のいずれかで、<code>disable</code>を指定することで、トランスパイルされたコードのファイルシステムへのキャッシュを無効化できます。</p><h3 id=--v8-flags--single-threaded><code>--v8-flags=--single-threaded</code><a hidden class=anchor aria-hidden=true href=#--v8-flags--single-threaded>#</a></h3><p><code>--v8-flags=--single-threaded</code>がサポートされています (<a href=https://github.com/denoland/deno/pull/29066>#29066</a>)</p><p>これを指定すると、V8が単一のスレッドのみを使用してタスクを処理するよう挙動が変更されます。単純なスクリプトにおいての使用が想定されているようです。</p><h3 id=windows向けの実行可能ファイルへのコード署名>Windows向けの実行可能ファイルへのコード署名<a hidden class=anchor aria-hidden=true href=#windows向けの実行可能ファイルへのコード署名>#</a></h3><p>Windows向けのDenoの実行可能ファイルにコード署名が適用されています (<a href=https://github.com/denoland/deno/pull/28963>#28963</a>)</p><p><a href=https://deno.com/blog/v2.3>Denoの公式ブログ</a>によると、この変更によってWindows DefenderからDenoの実行可能ファイルが信頼されるよう改善されるとのことです。</p><h2 id=nodejs互換性の改善>Node.js互換性の改善<a hidden class=anchor aria-hidden=true href=#nodejs互換性の改善>#</a></h2><h3 id=nodesqlite><code>node:sqlite</code><a hidden class=anchor aria-hidden=true href=#nodesqlite>#</a></h3><p><code>DatabaseSync#loadExtension</code>が実装されています (<a href=https://github.com/denoland/deno/pull/29050>#29050</a>)</p><p>このAPIを利用するには<code>--allow-ffi</code>の指定が必要です。</p><h3 id=nodehttp><code>node:http</code><a hidden class=anchor aria-hidden=true href=#nodehttp>#</a></h3><p>HTTPサーバーのパフォーマンス改善が実施されています。</p><p><code>ServerResponse#end</code>の不要な呼び出しの削減 (<a href=https://github.com/denoland/deno/pull/29069>#29069</a>)や<code>AbortSignal</code>の取り扱いの改善 (<a href=https://github.com/denoland/deno/pull/29071>#29071</a>)が実施されています。</p><h3 id=nodeassert><code>node:assert</code><a hidden class=anchor aria-hidden=true href=#nodeassert>#</a></h3><p><code>assert.deepStrictEqual(0, -0)</code>が等価と判定されてしまう問題が修正されています (<a href=https://github.com/denoland/deno/pull/29060>#29060</a>)</p><h3 id=nodefs><code>node:fs</code><a hidden class=anchor aria-hidden=true href=#nodefs>#</a></h3><p><code>readFile()</code>において<code>signal</code>オプションがサポートされています (<a href=https://github.com/denoland/deno/pull/29028>#29028</a>)</p><h3 id=nodedns><code>node:dns</code><a hidden class=anchor aria-hidden=true href=#nodedns>#</a></h3><p><code>ttl</code>オプションのサポートが追加されています (<a href=https://github.com/denoland/deno/pull/27676>#27676</a>)</p><h2 id=typescript-v58>TypeScript v5.8<a hidden class=anchor aria-hidden=true href=#typescript-v58>#</a></h2><p>Denoに搭載されたTypeScriptがv5.8.3へアップデートされています (<a href=https://github.com/denoland/deno/pull/29041>#29041</a>)</p><ul><li><a href=https://devblogs.microsoft.com/typescript/announcing-typescript-5-8/>https://devblogs.microsoft.com/typescript/announcing-typescript-5-8/</a></li></ul><p>また、このアップデートに合わせて、前述した<code>compilerOptions.erasableSyntaxOnly</code>のサポートも導入されています。</p><h2 id=opentelemetry>OpenTelemetry<a hidden class=anchor aria-hidden=true href=#opentelemetry>#</a></h2><h3 id=span-linksspan-eventsでattributesがサポート>Span Links/Span EventsでAttributesがサポート<a hidden class=anchor aria-hidden=true href=#span-linksspan-eventsでattributesがサポート>#</a></h3><p><a href=https://github.com/open-telemetry/opentelemetry.io/blob/0369108b85532466ac127f50326ddd116947b5e4/content/en/docs/concepts/signals/traces.md#span-links>Span Links</a>/<a href=https://github.com/open-telemetry/opentelemetry.io/blob/0369108b85532466ac127f50326ddd116947b5e4/content/en/docs/concepts/signals/traces.md#span-events>Span Events</a>に設定された<a href=https://github.com/open-telemetry/opentelemetry.io/blob/0369108b85532466ac127f50326ddd116947b5e4/content/en/docs/concepts/signals/traces.md#attributes>Attributes</a>のバックエンドへの送信がサポートされています (<a href=https://github.com/denoland/deno/pull/28584>#28584</a>)</p><h2 id=参考>参考<a hidden class=anchor aria-hidden=true href=#参考>#</a></h2><ul><li><a href=https://github.com/denoland/deno/releases/tag/v2.3.0>https://github.com/denoland/deno/releases/tag/v2.3.0</a></li><li><a href=https://deno.com/blog/v2.3>Deno 2.3: Improved deno compile, local npm packages, and more</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://uki00a.github.io/deno-weekly/tags/deno.html>deno</a></li><li><a href=https://uki00a.github.io/deno-weekly/tags/deno-kv.html>Deno KV</a></li><li><a href=https://uki00a.github.io/deno-weekly/tags/opentelemetry.html>OpenTelemetry</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://uki00a.github.io/deno-weekly/>週刊Deno</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>