<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Deno v2.4 | 週刊Deno</title><meta name=keywords content="Deno,Deno Deploy,OpenTelemetry"><meta name=description content="Deno v2.4がリリース, OpenTelemetryサポートが安定化, `--unstable-raw-imports`が追加 (ファイルのテキスト/バイト形式での読み込みがサポート), `deno bundle`について, `deno update`コマンドが追加, `deno deploy`コマンドについて, `deno check` - `tsconfig.json`の検出がサポート, `--preload`/`--import`オプションの追加, `Deno.execPath()`で`--allow-read`が不要化, `--unstable-subdomain-wildcards`が安定化, `--allow-net`でCIDR表記による指定がサポート, `--deny-import`がサポート, `deno fmt`がSVG/XML/Mustacheのフォーマットをサポート, `deno run` - Import mapsによるエントリーポイントの解決がサポート, `deno run`で`--coverage`がサポート, `Deno.Command`で`detached`オプションがサポート, `Deno.addSignalListener`でSIGHUPがサポート (Windows), `--unstable-sloppy-imports`と`--unstable-node-conditions`が安定化, `DENO_COMPAT`環境変数が導入, `Buffer`/`global`/`setImmediate`/`clearImmediate`がデフォルトでグローバル化"><meta name=author content><link rel=canonical href=https://uki00a.github.io/deno-weekly/articles/deno/v2.4.html><link crossorigin=anonymous href=/deno-weekly/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/deno-weekly/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://raw.githubusercontent.com/uki00a/blog/master/src/assets/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://uki00a.github.io/deno-weekly/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://uki00a.github.io/deno-weekly/favicon-32x32.png><link rel=apple-touch-icon href=https://uki00a.github.io/deno-weekly/apple-touch-icon.png><link rel=mask-icon href=https://uki00a.github.io/deno-weekly/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:image" content="https://raw.githubusercontent.com/uki00a/blog/master/src/assets/avatar.png"><meta property="twitter:image" content="https://raw.githubusercontent.com/uki00a/blog/master/src/assets/avatar.png"><meta name=twitter:site content="@uki00a"><script async src="https://www.googletagmanager.com/gtag/js?id=G-MK2K2MRMBF"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-MK2K2MRMBF",{anonymize_ip:!1})}</script><meta property="og:title" content="Deno v2.4"><meta property="og:description" content="Deno v2.4がリリース, OpenTelemetryサポートが安定化, `--unstable-raw-imports`が追加 (ファイルのテキスト/バイト形式での読み込みがサポート), `deno bundle`について, `deno update`コマンドが追加, `deno deploy`コマンドについて, `deno check` - `tsconfig.json`の検出がサポート, `--preload`/`--import`オプションの追加, `Deno.execPath()`で`--allow-read`が不要化, `--unstable-subdomain-wildcards`が安定化, `--allow-net`でCIDR表記による指定がサポート, `--deny-import`がサポート, `deno fmt`がSVG/XML/Mustacheのフォーマットをサポート, `deno run` - Import mapsによるエントリーポイントの解決がサポート, `deno run`で`--coverage`がサポート, `Deno.Command`で`detached`オプションがサポート, `Deno.addSignalListener`でSIGHUPがサポート (Windows), `--unstable-sloppy-imports`と`--unstable-node-conditions`が安定化, `DENO_COMPAT`環境変数が導入, `Buffer`/`global`/`setImmediate`/`clearImmediate`がデフォルトでグローバル化"><meta property="og:type" content="article"><meta property="og:url" content="https://uki00a.github.io/deno-weekly/articles/deno/v2.4.html"><meta property="article:section" content="articles"><meta property="article:published_time" content="2025-07-06T00:00:00+00:00"><meta property="article:modified_time" content="2025-07-06T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Deno v2.4"><meta name=twitter:description content="Deno v2.4がリリース, OpenTelemetryサポートが安定化, `--unstable-raw-imports`が追加 (ファイルのテキスト/バイト形式での読み込みがサポート), `deno bundle`について, `deno update`コマンドが追加, `deno deploy`コマンドについて, `deno check` - `tsconfig.json`の検出がサポート, `--preload`/`--import`オプションの追加, `Deno.execPath()`で`--allow-read`が不要化, `--unstable-subdomain-wildcards`が安定化, `--allow-net`でCIDR表記による指定がサポート, `--deny-import`がサポート, `deno fmt`がSVG/XML/Mustacheのフォーマットをサポート, `deno run` - Import mapsによるエントリーポイントの解決がサポート, `deno run`で`--coverage`がサポート, `Deno.Command`で`detached`オプションがサポート, `Deno.addSignalListener`でSIGHUPがサポート (Windows), `--unstable-sloppy-imports`と`--unstable-node-conditions`が安定化, `DENO_COMPAT`環境変数が導入, `Buffer`/`global`/`setImmediate`/`clearImmediate`がデフォルトでグローバル化"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Deno v2.4","item":"https://uki00a.github.io/deno-weekly/articles/deno/v2.4.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Deno v2.4","name":"Deno v2.4","description":"Deno v2.4がリリース, OpenTelemetryサポートが安定化, `--unstable-raw-imports`が追加 (ファイルのテキスト/バイト形式での読み込みがサポート), `deno bundle`について, `deno update`コマンドが追加, `deno deploy`コマンドについて, `deno check` - `tsconfig.json`の検出がサポート, `--preload`/`--import`オプションの追加, `Deno.execPath()`で`--allow-read`が不要化, `--unstable-subdomain-wildcards`が安定化, `--allow-net`でCIDR表記による指定がサポート, `--deny-import`がサポート, `deno fmt`がSVG/XML/Mustacheのフォーマットをサポート, `deno run` - Import mapsによるエントリーポイントの解決がサポート, `deno run`で`--coverage`がサポート, `Deno.Command`で`detached`オプションがサポート, `Deno.addSignalListener`でSIGHUPがサポート (Windows), `--unstable-sloppy-imports`と`--unstable-node-conditions`が安定化, `DENO_COMPAT`環境変数が導入, `Buffer`/`global`/`setImmediate`/`clearImmediate`がデフォルトでグローバル化","keywords":["Deno","Deno Deploy","OpenTelemetry"],"articleBody":"はじめに Deno v2.4がリリースされました。\nこの記事では主な変更点などについて解説します。\nOpenTelemetryサポートが安定化 DenoのOpenTelemetryサポートが安定化されました (#29822)\nこれによって--unstable-otelの指定が不要化され、OTEL_DENOのみの指定によってOpenTelemetryサポートを有効化できます。\n--unstable-raw-importsが追加 (ファイルのテキスト/バイト形式での読み込みがサポート) --unstable-raw-importsオプションがサポートされています (#29855, #29924)\nこのオプションを指定すると、Import Attributes ( type: \"bytes\"またはtype: \"text\")によって文字列もしくはバイト (Uint8Array) 形式でファイルを読み込むことができます:\nimport data from \"./data.txt\" with { type: \"text\" };  console.info(data); // = \"foo\" この機能はDENO_UNSTABLE_RAW_IMPORTS環境変数によって有効化することも可能です。\nまた、deno publishコマンドではまだこの機能はサポートされていないようです (#29954)\ndeno bundleについて Deno v2.3.6で、esbuildをベースにdeno bundleコマンドが再導入されています。\nこのリリースでは、このdeno bundleコマンドでも--unstable-raw-importsオプションのサポートが追加されています (#29908)\nまた、このdeno bundleコマンドに関する公式ドキュメントも追加されています (denoland/docs#1866)\nDeno v2.4に関する公式ブログによると、今後、このdeno bundleの機能をAPI経由で利用できるようにすることが検討されているようです。\ndeno updateコマンドが追加 deno updateコマンドが追加されています (#29187)\nこのコマンドによって依存関係の更新を行うことができます (実質的にdeno outdated --updateのエイリアスとして機能します)\n$ deno update --latest @ts-morph/ts-morph deno deployコマンドについて 小さな変更ですが、Deno v2.3.6で追加されたdeno deployコマンドについて、デフォルトでヘルプが含まれるよう修正されています (#29863)\n$ deno help | grep deploy  deploy Manage and publish applications with Deno Deploy deno check tsconfig.jsonの検出がサポート deno checkがdeno.jsonまたはpackage.jsonと同一ディレクトリにあるtsconfig.jsonを検出してくれるよう改善されています (#29843, #29925)\ntsconfig.jsonにおいては、compilerOptionsに加えて、以下のフィールドがサポートされます:\n references extends files include exclude  --preload/--importオプションの追加 --preload (--import) オプションが追加されています (#29626)\nこのオプションはNode.jsの--importと同様に、エントリーポイントを実行する前にこのオプションで指定したモジュールが読み込まれます:\n$ deno run --preload=jsr:@std/dotenv@0.225.5/load --allow-env=DATABASE_URL --allow-read=.env main.js Permissions Deno.execPath()が--allow-readを要求しないよう挙動を変更 Deno.execPath()を利用する際に--allow-readの指定が不要化されました (#29620)\nDeno.execPath()が--allow-read=denoの要求を促すことによって、ユーザーが--allow-readを指定してしまいがちで、却ってセキュリティリスクを増してしまうとの判断からこの変更が実施されたようです。\n--allow-net --unstable-subdomain-wildcardsが安定化 Deno v2.3.4で実装された--unstable-subdomain-wildcardsが安定化されました (#29902)\n今後は--unstable-subdomain-wildcardsを指定せずに--allow-netでのサブドメインに対するワイルドカード指定が利用できます。\nCIDR表記による指定がサポート --allow-net及び--deny-netでCIDR表記による指定がサポートされています (#29704)\n$ deno run --allow-net=127.0.0.0/24 main.js --deny-importがサポート --deny-importオプションがサポートされています (#29702)\n--allow-importによって許可されるデフォルトのホストを無効化したい場合などに利用できます:\n$ deno run --deny-import=raw.githubusercontent.com main.js Deno.permissions.query()でname: \"import\"がサポート Deno.permissions.query()で--allow-importに対応したname: \"import\"オプションがサポートされています (#29610)\nconst status = await Deno.permissions.query({  name: \"import\",  host: \"cdn.jsdelivr.net\", }); deno fmt .svg/.xml/.mustache形式のサポート deno fmtでSVGやXML, Mustache形式のファイルのフォーマットをサポートしています (#29851)\nMustache形式のフォーマットを行いたい場合は、--unstable-componentオプションによって明示的に有効化する必要があります。\nUTF-8 BOMが取り除かれるよう挙動が変更 deno fmtがファイルのUTF-8 BOMを取り除くよう挙動が変更されています (#29796)\ndeno run Import mapsによるエントリーポイントの解決 deno runとdeno serveにおいて、エントリーポイントに対するImport mapsによる解決がサポートされています (#29928)\n以下のようにdeno runの引数としてdeno.jsonで定義されたImport mapsのエントリーを指定することができます:\n$ deno add npm:cowsay@1.6.0  $ cat deno.json | jq .imports.cowsay \"npm:cowsay@1.6.0\"  $ deno run -ER cowsay hi  ____  ----  \\  ^__^  \\  (oo)\\_______  (__)\\  )\\/\\  ||----w |  || || エントリーポイントが.から始まらない場合や絶対パス形式でない場合はこの振る舞いが適用されるため、もしDeno v2.4へのアップデート以降、deno runが意図せぬ振る舞いをする場合は、引数に./を付与すると回避できます。\ndeno serve Deno.ServeDefaultExportでonListenコールバックがサポート Deno.ServeDefaultExportにonListenプロパティーが追加されています (#29449)\n挙動としてはDeno.serve()のonListenオプションと同様に、サーバーが待ち受けを開始したタイミングでコールバックが実行されます。\nDENO_AUTO_SERVE環境変数がサポート DENO_AUTO_SERVE環境変数が追加されています (#29852)\nこの環境変数が指定された場合、deno runの引数で指定されたエントリーポイントがDeno.ServeDefaultExportを満たす場合、deno serveと同様の振る舞いをします。\ndeno coverage deno runで--coverageがサポート deno runでのカバレッジの収集がサポートされています (#29329)\ndeno runに--coverageを指定するか、DENO_COVERAGE_DIR環境変数を指定することで有効化されます。\nDenoでMochaなどを実行したい場合に便利ではないかと思いました。\nテーブルがMarkdown形式で表示されるよう改善 deno coverageが出力するテーブルがMarkdown形式で表示されるよう改善されています (#29533)\ndeno bench テーブルがMarkdown形式で表示されるよう改善 deno benchにおいてもdeno coverageと同様に、テーブルがMarkdown形式で表示されるよう改善されています (#29532)\ndeno install deno install -gによるnpmパッケージのインストールが改善 deno install -gによるnpmパッケージのインストール時に、package.jsonのbinエントリーの解決が試みられるよう改善されています (#29884)\n具体的には、deno install -g npm:@google/gemini-cliを実行すると、geminiが利用できるように改善されています。\nDeno API Deno.Command Deno.Commandでdetachedオプションがサポートされています (#29933)\n挙動はchild_process.spawn() (node:child_process)における同名オプションと同様です。\nDeno.addSignalListener() WindowsにおいてSIGHUPがサポートされています (#27880)\nNode.js互換性の改善 --unstable-sloppy-importsの安定化 --unstable-sloppy-importsが安定化されています (#29780)\n今後は--sloppy-importsとして利用できます。\n--unstable-node-conditionsが安定化 --unstable-node-conditionsが安定化されました (#29848, #29885, #29628)\n今後は--conditionsとして利用可能です。また、DENO_CONDITIONS環境変数による指定もサポートされています。\nDENO_COMPAT環境変数 DENO_COMPAT環境変数が追加されています (#29889)\nこの環境変数が設定されると、以下のフラグがまとめて有効化されます:\n --unstable-bare-node-builtins --unstable-detect-cjs --sloppy-imports  Buffer/global/setImmediate/clearImmediateがデフォルトでグローバル化 Node.jsに関する以下のAPIがすべてのコードにおいてデフォルトでグローバル化されました (#29416, #29877)\n global Buffer setImmediate clearImmediate  今までこれらのAPIはnpmパッケージ中のコードにおいてのみグローバル化されていましたが、npmパッケージとユーザーコードの実行環境における差異の軽減のため、ユーザーコードにおいてもこれらのAPIがグローバル化されました。\nこの変更に伴って、--unstable-node-globalsが非推奨化されています (#29887)\nnode:fs glob()とglobSync()が実装されています (#28972)\nmacOS向けにlchmod()とlchmodSync()が実装されています (#29833)\nまた、lchown()及びlutimes()がnode:fs/promisesからも読み込めるよう改善されています (#29870)\n参考  https://deno.com/blog/v2.4 https://github.com/denoland/deno/releases/tag/v2.4.0  ","wordCount":"311","inLanguage":"en","datePublished":"2025-07-06T00:00:00Z","dateModified":"2025-07-06T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://uki00a.github.io/deno-weekly/articles/deno/v2.4.html"},"publisher":{"@type":"Organization","name":"週刊Deno","logo":{"@type":"ImageObject","url":"https://raw.githubusercontent.com/uki00a/blog/master/src/assets/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://uki00a.github.io/deno-weekly/ accesskey=h title="週刊Deno (Alt + H)">週刊Deno</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://uki00a.github.io/deno-weekly/tags.html title=タグ><span><i class="fa fa-heart"></i>タグ</span></a></li><li><a href=https://uki00a.github.io/deno-weekly/categories.html title=カテゴリー><span><i class="fa fa-heart"></i>カテゴリー</span></a></li><li><a href=https://uki00a.github.io/deno-weekly/gallery.html title=ギャラリー><span><i class="fa fa-road"></i>ギャラリー<span class=alert></span></span></a></li><li><a href=https://uki00a.github.io/deno-weekly/index.xml title="RSS feed"><span><i class="fa fa-road"></i>RSS feed<span class=alert></span></span></a></li><li><a href=https://uki00a.github.io/deno-weekly/about.html title=About><span><i class="fa fa-road"></i>About<span class=alert></span></span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Deno v2.4</h1><div class=post-description>Deno v2.4がリリース, OpenTelemetryサポートが安定化, `--unstable-raw-imports`が追加 (ファイルのテキスト/バイト形式での読み込みがサポート), `deno bundle`について, `deno update`コマンドが追加, `deno deploy`コマンドについて, `deno check` - `tsconfig.json`の検出がサポート, `--preload`/`--import`オプションの追加, `Deno.execPath()`で`--allow-read`が不要化, `--unstable-subdomain-wildcards`が安定化, `--allow-net`でCIDR表記による指定がサポート, `--deny-import`がサポート, `deno fmt`がSVG/XML/Mustacheのフォーマットをサポート, `deno run` - Import mapsによるエントリーポイントの解決がサポート, `deno run`で`--coverage`がサポート, `Deno.Command`で`detached`オプションがサポート, `Deno.addSignalListener`でSIGHUPがサポート (Windows), `--unstable-sloppy-imports`と`--unstable-node-conditions`が安定化, `DENO_COMPAT`環境変数が導入, `Buffer`/`global`/`setImmediate`/`clearImmediate`がデフォルトでグローバル化</div><div class=post-meta><span title="2025-07-06 00:00:00 +0000 UTC">July 6, 2025</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e3%81%af%e3%81%98%e3%82%81%e3%81%ab aria-label=はじめに>はじめに</a></li><li><a href=#opentelemetry%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88%e3%81%8c%e5%ae%89%e5%ae%9a%e5%8c%96 aria-label=OpenTelemetryサポートが安定化>OpenTelemetryサポートが安定化</a></li><li><a href=#--unstable-raw-imports%e3%81%8c%e8%bf%bd%e5%8a%a0-%e3%83%95%e3%82%a1%e3%82%a4%e3%83%ab%e3%81%ae%e3%83%86%e3%82%ad%e3%82%b9%e3%83%88%e3%83%90%e3%82%a4%e3%83%88%e5%bd%a2%e5%bc%8f%e3%81%a7%e3%81%ae%e8%aa%ad%e3%81%bf%e8%be%bc%e3%81%bf%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label="--unstable-raw-importsが追加 (ファイルのテキスト/バイト形式での読み込みがサポート)"><code>--unstable-raw-imports</code>が追加 (ファイルのテキスト/バイト形式での読み込みがサポート)</a></li><li><a href=#deno-bundle%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6 aria-label="deno bundleについて"><code>deno bundle</code>について</a></li><li><a href=#deno-update%e3%82%b3%e3%83%9e%e3%83%b3%e3%83%89%e3%81%8c%e8%bf%bd%e5%8a%a0 aria-label="deno updateコマンドが追加"><code>deno update</code>コマンドが追加</a></li><li><a href=#deno-deploy%e3%82%b3%e3%83%9e%e3%83%b3%e3%83%89%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6 aria-label="deno deployコマンドについて"><code>deno deploy</code>コマンドについて</a></li><li><a href=#deno-check aria-label="deno check"><code>deno check</code></a><ul><li><a href=#tsconfigjson%e3%81%ae%e6%a4%9c%e5%87%ba%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=tsconfig.jsonの検出がサポート><code>tsconfig.json</code>の検出がサポート</a></li></ul></li><li><a href=#--preload--import%e3%82%aa%e3%83%97%e3%82%b7%e3%83%a7%e3%83%b3%e3%81%ae%e8%bf%bd%e5%8a%a0 aria-label=--preload/--importオプションの追加><code>--preload</code>/<code>--import</code>オプションの追加</a></li><li><a href=#permissions aria-label=Permissions>Permissions</a><ul><li><a href=#denoexecpath%e3%81%8c--allow-read%e3%82%92%e8%a6%81%e6%b1%82%e3%81%97%e3%81%aa%e3%81%84%e3%82%88%e3%81%86%e6%8c%99%e5%8b%95%e3%82%92%e5%a4%89%e6%9b%b4 aria-label=Deno.execPath()が--allow-readを要求しないよう挙動を変更><code>Deno.execPath()</code>が<code>--allow-read</code>を要求しないよう挙動を変更</a></li><li><a href=#--allow-net aria-label=--allow-net><code>--allow-net</code></a><ul><li><a href=#--unstable-subdomain-wildcards%e3%81%8c%e5%ae%89%e5%ae%9a%e5%8c%96 aria-label=--unstable-subdomain-wildcardsが安定化><code>--unstable-subdomain-wildcards</code>が安定化</a></li><li><a href=#cidr%e8%a1%a8%e8%a8%98%e3%81%ab%e3%82%88%e3%82%8b%e6%8c%87%e5%ae%9a%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=CIDR表記による指定がサポート>CIDR表記による指定がサポート</a></li></ul></li><li><a href=#--deny-import%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=--deny-importがサポート><code>--deny-import</code>がサポート</a></li><li><a href=#denopermissionsquery%e3%81%a7name-import%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label="Deno.permissions.query()でname: &amp;quot;import&amp;quot;がサポート"><code>Deno.permissions.query()</code>で<code>name: "import"</code>がサポート</a></li></ul></li><li><a href=#deno-fmt aria-label="deno fmt"><code>deno fmt</code></a><ul><li><a href=#svgxmlmustache%e5%bd%a2%e5%bc%8f%e3%81%ae%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=.svg/.xml/.mustache形式のサポート><code>.svg</code>/<code>.xml</code>/<code>.mustache</code>形式のサポート</a></li><li><a href=#utf-8-bom%e3%81%8c%e5%8f%96%e3%82%8a%e9%99%a4%e3%81%8b%e3%82%8c%e3%82%8b%e3%82%88%e3%81%86%e6%8c%99%e5%8b%95%e3%81%8c%e5%a4%89%e6%9b%b4 aria-label="UTF-8 BOMが取り除かれるよう挙動が変更">UTF-8 BOMが取り除かれるよう挙動が変更</a></li></ul></li><li><a href=#deno-run aria-label="deno run"><code>deno run</code></a><ul><li><a href=#import-maps%e3%81%ab%e3%82%88%e3%82%8b%e3%82%a8%e3%83%b3%e3%83%88%e3%83%aa%e3%83%bc%e3%83%9d%e3%82%a4%e3%83%b3%e3%83%88%e3%81%ae%e8%a7%a3%e6%b1%ba aria-label="Import mapsによるエントリーポイントの解決">Import mapsによるエントリーポイントの解決</a></li></ul></li><li><a href=#deno-serve aria-label="deno serve"><code>deno serve</code></a><ul><li><a href=#denoservedefaultexport%e3%81%a7onlisten%e3%82%b3%e3%83%bc%e3%83%ab%e3%83%90%e3%83%83%e3%82%af%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=Deno.ServeDefaultExportでonListenコールバックがサポート><code>Deno.ServeDefaultExport</code>で<code>onListen</code>コールバックがサポート</a></li><li><a href=#deno_auto_serve%e7%92%b0%e5%a2%83%e5%a4%89%e6%95%b0%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label=DENO_AUTO_SERVE環境変数がサポート><code>DENO_AUTO_SERVE</code>環境変数がサポート</a></li></ul></li><li><a href=#deno-coverage aria-label="deno coverage"><code>deno coverage</code></a><ul><li><a href=#deno-run%e3%81%a7--coverage%e3%81%8c%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88 aria-label="deno runで--coverageがサポート"><code>deno run</code>で<code>--coverage</code>がサポート</a></li><li><a href=#%e3%83%86%e3%83%bc%e3%83%96%e3%83%ab%e3%81%8cmarkdown%e5%bd%a2%e5%bc%8f%e3%81%a7%e8%a1%a8%e7%a4%ba%e3%81%95%e3%82%8c%e3%82%8b%e3%82%88%e3%81%86%e6%94%b9%e5%96%84 aria-label=テーブルがMarkdown形式で表示されるよう改善>テーブルがMarkdown形式で表示されるよう改善</a></li></ul></li><li><a href=#deno-bench aria-label="deno bench"><code>deno bench</code></a><ul><li><a href=#%e3%83%86%e3%83%bc%e3%83%96%e3%83%ab%e3%81%8cmarkdown%e5%bd%a2%e5%bc%8f%e3%81%a7%e8%a1%a8%e7%a4%ba%e3%81%95%e3%82%8c%e3%82%8b%e3%82%88%e3%81%86%e6%94%b9%e5%96%84-1 aria-label=テーブルがMarkdown形式で表示されるよう改善>テーブルがMarkdown形式で表示されるよう改善</a></li></ul></li><li><a href=#deno-install aria-label="deno install"><code>deno install</code></a><ul><li><a href=#deno-install--g%e3%81%ab%e3%82%88%e3%82%8bnpm%e3%83%91%e3%83%83%e3%82%b1%e3%83%bc%e3%82%b8%e3%81%ae%e3%82%a4%e3%83%b3%e3%82%b9%e3%83%88%e3%83%bc%e3%83%ab%e3%81%8c%e6%94%b9%e5%96%84 aria-label="deno install -gによるnpmパッケージのインストールが改善"><code>deno install -g</code>によるnpmパッケージのインストールが改善</a></li></ul></li><li><a href=#deno-api aria-label="Deno API">Deno API</a><ul><li><a href=#denocommand aria-label=Deno.Command><code>Deno.Command</code></a></li><li><a href=#denoaddsignallistener aria-label=Deno.addSignalListener()><code>Deno.addSignalListener()</code></a></li></ul></li><li><a href=#nodejs%e4%ba%92%e6%8f%9b%e6%80%a7%e3%81%ae%e6%94%b9%e5%96%84 aria-label=Node.js互換性の改善>Node.js互換性の改善</a><ul><li><a href=#--unstable-sloppy-imports%e3%81%ae%e5%ae%89%e5%ae%9a%e5%8c%96 aria-label=--unstable-sloppy-importsの安定化><code>--unstable-sloppy-imports</code>の安定化</a></li><li><a href=#--unstable-node-conditions%e3%81%8c%e5%ae%89%e5%ae%9a%e5%8c%96 aria-label=--unstable-node-conditionsが安定化><code>--unstable-node-conditions</code>が安定化</a></li><li><a href=#deno_compat%e7%92%b0%e5%a2%83%e5%a4%89%e6%95%b0 aria-label=DENO_COMPAT環境変数><code>DENO_COMPAT</code>環境変数</a></li><li><a href=#bufferglobalsetimmediateclearimmediate%e3%81%8c%e3%83%87%e3%83%95%e3%82%a9%e3%83%ab%e3%83%88%e3%81%a7%e3%82%b0%e3%83%ad%e3%83%bc%e3%83%90%e3%83%ab%e5%8c%96 aria-label=Buffer/global/setImmediate/clearImmediateがデフォルトでグローバル化><code>Buffer</code>/<code>global</code>/<code>setImmediate</code>/<code>clearImmediate</code>がデフォルトでグローバル化</a></li><li><a href=#nodefs aria-label=node:fs><code>node:fs</code></a></li></ul></li><li><a href=#%e5%8f%82%e8%80%83 aria-label=参考>参考</a></li></ul></div></details></div><div class=post-content><h2 id=はじめに>はじめに<a hidden class=anchor aria-hidden=true href=#はじめに>#</a></h2><p>Deno v2.4がリリースされました。</p><p>この記事では主な変更点などについて解説します。</p><h2 id=opentelemetryサポートが安定化>OpenTelemetryサポートが安定化<a hidden class=anchor aria-hidden=true href=#opentelemetryサポートが安定化>#</a></h2><p>DenoのOpenTelemetryサポートが安定化されました (<a href=https://github.com/denoland/deno/pull/29822>#29822</a>)</p><p>これによって<code>--unstable-otel</code>の指定が不要化され、<code>OTEL_DENO</code>のみの指定によってOpenTelemetryサポートを有効化できます。</p><h2 id=--unstable-raw-importsが追加-ファイルのテキストバイト形式での読み込みがサポート><code>--unstable-raw-imports</code>が追加 (ファイルのテキスト/バイト形式での読み込みがサポート)<a hidden class=anchor aria-hidden=true href=#--unstable-raw-importsが追加-ファイルのテキストバイト形式での読み込みがサポート>#</a></h2><p><code>--unstable-raw-imports</code>オプションがサポートされています (<a href=https://github.com/denoland/deno/pull/29855>#29855</a>, <a href=https://github.com/denoland/deno/pull/29924>#29924</a>)</p><p>このオプションを指定すると、<a href=https://uki00a.github.io/deno-weekly/articles/deno/v1.37.html>Import Attributes</a> (
<code>type: "bytes"</code>または<code>type: "text"</code>)によって文字列もしくはバイト (<code>Uint8Array</code>) 形式でファイルを読み込むことができます:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>data</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;./data.txt&#34;</span> <span style=color:#66d9ef>with</span> { <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;text&#34;</span> };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#a6e22e>data</span>); <span style=color:#75715e>// =&gt; &#34;foo&#34;
</span></span></span></code></pre></div><p>この機能は<code>DENO_UNSTABLE_RAW_IMPORTS</code>環境変数によって有効化することも可能です。</p><p>また、<code>deno publish</code>コマンドではまだこの機能はサポートされていないようです (<a href=https://github.com/denoland/deno/pull/29954>#29954</a>)</p><h2 id=deno-bundleについて><code>deno bundle</code>について<a hidden class=anchor aria-hidden=true href=#deno-bundleについて>#</a></h2><p><a href=https://uki00a.github.io/deno-weekly/articles/2025/06/15.html>Deno v2.3.6</a>で、<code>esbuild</code>をベースに<code>deno bundle</code>コマンドが再導入されています。</p><p>このリリースでは、この<code>deno bundle</code>コマンドでも<code>--unstable-raw-imports</code>オプションのサポートが追加されています (<a href=https://github.com/denoland/deno/pull/29908>#29908</a>)</p><p>また、この<code>deno bundle</code>コマンドに関する公式ドキュメントも追加されています (<a href=https://github.com/denoland/docs/commit/3bda508a5ecf11b5f3eb1c3165b41aa34262088e>denoland/docs#1866</a>)</p><p><a href=https://deno.com/blog/v2.4>Deno v2.4に関する公式ブログ</a>によると、今後、この<code>deno bundle</code>の機能をAPI経由で利用できるようにすることが検討されているようです。</p><h2 id=deno-updateコマンドが追加><code>deno update</code>コマンドが追加<a hidden class=anchor aria-hidden=true href=#deno-updateコマンドが追加>#</a></h2><p><code>deno update</code>コマンドが追加されています (<a href=https://github.com/denoland/deno/pull/29187>#29187</a>)</p><p>このコマンドによって依存関係の更新を行うことができます (実質的に<a href=https://uki00a.github.io/deno-weekly/articles/deno/v2.1.html><code>deno outdated --update</code></a>のエイリアスとして機能します)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ deno update --latest @ts-morph/ts-morph
</span></span></code></pre></div><h2 id=deno-deployコマンドについて><code>deno deploy</code>コマンドについて<a hidden class=anchor aria-hidden=true href=#deno-deployコマンドについて>#</a></h2><p>小さな変更ですが、<a href=https://uki00a.github.io/deno-weekly/articles/2025/06/15.html>Deno v2.3.6</a>で追加された<code>deno deploy</code>コマンドについて、デフォルトでヘルプが含まれるよう修正されています (<a href=https://github.com/denoland/deno/pull/29863>#29863</a>)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ deno help | grep deploy
</span></span><span style=display:flex><span>    deploy       Manage and publish applications with Deno Deploy
</span></span></code></pre></div><h2 id=deno-check><code>deno check</code><a hidden class=anchor aria-hidden=true href=#deno-check>#</a></h2><h3 id=tsconfigjsonの検出がサポート><code>tsconfig.json</code>の検出がサポート<a hidden class=anchor aria-hidden=true href=#tsconfigjsonの検出がサポート>#</a></h3><p><code>deno check</code>が<code>deno.json</code>または<code>package.json</code>と同一ディレクトリにある<code>tsconfig.json</code>を検出してくれるよう改善されています (<a href=https://github.com/denoland/deno/pull/29843>#29843</a>, <a href=https://github.com/denoland/deno/pull/29925>#29925</a>)</p><p><code>tsconfig.json</code>においては、<code>compilerOptions</code>に加えて、以下のフィールドがサポートされます:</p><ul><li><code>references</code></li><li><code>extends</code></li><li><code>files</code></li><li><code>include</code></li><li><code>exclude</code></li></ul><h2 id=--preload--importオプションの追加><code>--preload</code>/<code>--import</code>オプションの追加<a hidden class=anchor aria-hidden=true href=#--preload--importオプションの追加>#</a></h2><p><code>--preload</code> (<code>--import</code>) オプションが追加されています (<a href=https://github.com/denoland/deno/pull/29626>#29626</a>)</p><p>このオプションはNode.jsの<code>--import</code>と同様に、エントリーポイントを実行する前にこのオプションで指定したモジュールが読み込まれます:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ deno run --preload<span style=color:#f92672>=</span>jsr:@std/dotenv@0.225.5/load --allow-env<span style=color:#f92672>=</span>DATABASE_URL --allow-read<span style=color:#f92672>=</span>.env main.js
</span></span></code></pre></div><h2 id=permissions>Permissions<a hidden class=anchor aria-hidden=true href=#permissions>#</a></h2><h3 id=denoexecpathが--allow-readを要求しないよう挙動を変更><code>Deno.execPath()</code>が<code>--allow-read</code>を要求しないよう挙動を変更<a hidden class=anchor aria-hidden=true href=#denoexecpathが--allow-readを要求しないよう挙動を変更>#</a></h3><p><code>Deno.execPath()</code>を利用する際に<code>--allow-read</code>の指定が不要化されました (<a href=https://github.com/denoland/deno/pull/29620>#29620</a>)</p><p><code>Deno.execPath()</code>が<code>--allow-read=deno</code>の要求を促すことによって、ユーザーが<code>--allow-read</code>を指定してしまいがちで、却ってセキュリティリスクを増してしまうとの判断からこの変更が実施されたようです。</p><h3 id=--allow-net><code>--allow-net</code><a hidden class=anchor aria-hidden=true href=#--allow-net>#</a></h3><h4 id=--unstable-subdomain-wildcardsが安定化><code>--unstable-subdomain-wildcards</code>が安定化<a hidden class=anchor aria-hidden=true href=#--unstable-subdomain-wildcardsが安定化>#</a></h4><p><a href=https://uki00a.github.io/deno-weekly/articles/2025/06/01.html>Deno v2.3.4</a>で実装された<code>--unstable-subdomain-wildcards</code>が安定化されました (<a href=https://github.com/denoland/deno/pull/29902>#29902</a>)</p><p>今後は<code>--unstable-subdomain-wildcards</code>を指定せずに<code>--allow-net</code>でのサブドメインに対するワイルドカード指定が利用できます。</p><h4 id=cidr表記による指定がサポート>CIDR表記による指定がサポート<a hidden class=anchor aria-hidden=true href=#cidr表記による指定がサポート>#</a></h4><p><code>--allow-net</code>及び<code>--deny-net</code>でCIDR表記による指定がサポートされています (<a href=https://github.com/denoland/deno/pull/29704>#29704</a>)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ deno run --allow-net<span style=color:#f92672>=</span>127.0.0.0/24 main.js
</span></span></code></pre></div><h3 id=--deny-importがサポート><code>--deny-import</code>がサポート<a hidden class=anchor aria-hidden=true href=#--deny-importがサポート>#</a></h3><p><code>--deny-import</code>オプションがサポートされています (<a href=https://github.com/denoland/deno/pull/29702>#29702</a>)</p><p><a href=https://uki00a.github.io/deno-weekly/articles/2024/10/06.html><code>--allow-import</code></a>によって許可されるデフォルトのホストを無効化したい場合などに利用できます:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ deno run --deny-import<span style=color:#f92672>=</span>raw.githubusercontent.com main.js
</span></span></code></pre></div><h3 id=denopermissionsqueryでname-importがサポート><code>Deno.permissions.query()</code>で<code>name: "import"</code>がサポート<a hidden class=anchor aria-hidden=true href=#denopermissionsqueryでname-importがサポート>#</a></h3><p><code>Deno.permissions.query()</code>で<a href=https://uki00a.github.io/deno-weekly/articles/2024/09/29.html><code>--allow-import</code></a>に対応した<code>name: "import"</code>オプションがサポートされています (<a href=https://github.com/denoland/deno/pull/29610>#29610</a>)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>status</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>Deno</span>.<span style=color:#a6e22e>permissions</span>.<span style=color:#a6e22e>query</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;import&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>host</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;cdn.jsdelivr.net&#34;</span>,
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h2 id=deno-fmt><code>deno fmt</code><a hidden class=anchor aria-hidden=true href=#deno-fmt>#</a></h2><h3 id=svgxmlmustache形式のサポート><code>.svg</code>/<code>.xml</code>/<code>.mustache</code>形式のサポート<a hidden class=anchor aria-hidden=true href=#svgxmlmustache形式のサポート>#</a></h3><p><code>deno fmt</code>でSVGやXML, Mustache形式のファイルのフォーマットをサポートしています (<a href=https://github.com/denoland/deno/pull/29851>#29851</a>)</p><p>Mustache形式のフォーマットを行いたい場合は、<code>--unstable-component</code>オプションによって明示的に有効化する必要があります。</p><h3 id=utf-8-bomが取り除かれるよう挙動が変更>UTF-8 BOMが取り除かれるよう挙動が変更<a hidden class=anchor aria-hidden=true href=#utf-8-bomが取り除かれるよう挙動が変更>#</a></h3><p><code>deno fmt</code>がファイルのUTF-8 BOMを取り除くよう挙動が変更されています (<a href=https://github.com/denoland/deno/pull/29796>#29796</a>)</p><h2 id=deno-run><code>deno run</code><a hidden class=anchor aria-hidden=true href=#deno-run>#</a></h2><h3 id=import-mapsによるエントリーポイントの解決>Import mapsによるエントリーポイントの解決<a hidden class=anchor aria-hidden=true href=#import-mapsによるエントリーポイントの解決>#</a></h3><p><code>deno run</code>と<code>deno serve</code>において、エントリーポイントに対するImport mapsによる解決がサポートされています (<a href=https://github.com/denoland/deno/pull/29928>#29928</a>)</p><p>以下のように<code>deno run</code>の引数として<code>deno.json</code>で定義されたImport mapsのエントリーを指定することができます:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ deno add npm:cowsay@1.6.0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cat deno.json | jq .imports.cowsay
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;npm:cowsay@1.6.0&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ deno run -ER cowsay hi 
</span></span><span style=display:flex><span> ____
</span></span><span style=display:flex><span>&lt; hi &gt;
</span></span><span style=display:flex><span> ----
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>\ </span>  ^__^
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>\ </span> <span style=color:#f92672>(</span>oo<span style=color:#f92672>)</span><span style=color:#ae81ff>\_</span>______
</span></span><span style=display:flex><span>            <span style=color:#f92672>(</span>__<span style=color:#f92672>)</span><span style=color:#ae81ff>\ </span>      <span style=color:#f92672>)</span><span style=color:#ae81ff>\/\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>                <span style=color:#f92672>||</span>----w |
</span></span><span style=display:flex><span>                <span style=color:#f92672>||</span>     <span style=color:#f92672>||</span>
</span></span></code></pre></div><p>エントリーポイントが<code>.</code>から始まらない場合や絶対パス形式でない場合はこの振る舞いが適用されるため、もしDeno v2.4へのアップデート以降、<code>deno run</code>が意図せぬ振る舞いをする場合は、引数に<code>./</code>を付与すると回避できます。</p><h2 id=deno-serve><code>deno serve</code><a hidden class=anchor aria-hidden=true href=#deno-serve>#</a></h2><h3 id=denoservedefaultexportでonlistenコールバックがサポート><code>Deno.ServeDefaultExport</code>で<code>onListen</code>コールバックがサポート<a hidden class=anchor aria-hidden=true href=#denoservedefaultexportでonlistenコールバックがサポート>#</a></h3><p><a href=https://uki00a.github.io/deno-weekly/articles/deno/v1.46.html><code>Deno.ServeDefaultExport</code></a>に<code>onListen</code>プロパティーが追加されています (<a href=https://github.com/denoland/deno/pull/29449>#29449</a>)</p><p>挙動としては<code>Deno.serve()</code>の<code>onListen</code>オプションと同様に、サーバーが待ち受けを開始したタイミングでコールバックが実行されます。</p><h3 id=deno_auto_serve環境変数がサポート><code>DENO_AUTO_SERVE</code>環境変数がサポート<a hidden class=anchor aria-hidden=true href=#deno_auto_serve環境変数がサポート>#</a></h3><p><code>DENO_AUTO_SERVE</code>環境変数が追加されています (<a href=https://github.com/denoland/deno/pull/29852>#29852</a>)</p><p>この環境変数が指定された場合、<code>deno run</code>の引数で指定されたエントリーポイントが<code>Deno.ServeDefaultExport</code>を満たす場合、<code>deno serve</code>と同様の振る舞いをします。</p><h2 id=deno-coverage><code>deno coverage</code><a hidden class=anchor aria-hidden=true href=#deno-coverage>#</a></h2><h3 id=deno-runで--coverageがサポート><code>deno run</code>で<code>--coverage</code>がサポート<a hidden class=anchor aria-hidden=true href=#deno-runで--coverageがサポート>#</a></h3><p><code>deno run</code>でのカバレッジの収集がサポートされています (<a href=https://github.com/denoland/deno/pull/29329>#29329</a>)</p><p><code>deno run</code>に<code>--coverage</code>を指定するか、<a href=https://uki00a.github.io/deno-weekly/articles/deno/v2.3.html>DENO_COVERAGE_DIR</a>環境変数を指定することで有効化されます。</p><p>DenoでMochaなどを実行したい場合に便利ではないかと思いました。</p><h3 id=テーブルがmarkdown形式で表示されるよう改善>テーブルがMarkdown形式で表示されるよう改善<a hidden class=anchor aria-hidden=true href=#テーブルがmarkdown形式で表示されるよう改善>#</a></h3><p><code>deno coverage</code>が出力するテーブルがMarkdown形式で表示されるよう改善されています (<a href=https://github.com/denoland/deno/pull/29533>#29533</a>)</p><h2 id=deno-bench><code>deno bench</code><a hidden class=anchor aria-hidden=true href=#deno-bench>#</a></h2><h3 id=テーブルがmarkdown形式で表示されるよう改善-1>テーブルがMarkdown形式で表示されるよう改善<a hidden class=anchor aria-hidden=true href=#テーブルがmarkdown形式で表示されるよう改善-1>#</a></h3><p><code>deno bench</code>においても<code>deno coverage</code>と同様に、テーブルがMarkdown形式で表示されるよう改善されています (<a href=https://github.com/denoland/deno/pull/29532>#29532</a>)</p><h2 id=deno-install><code>deno install</code><a hidden class=anchor aria-hidden=true href=#deno-install>#</a></h2><h3 id=deno-install--gによるnpmパッケージのインストールが改善><code>deno install -g</code>によるnpmパッケージのインストールが改善<a hidden class=anchor aria-hidden=true href=#deno-install--gによるnpmパッケージのインストールが改善>#</a></h3><p><code>deno install -g</code>によるnpmパッケージのインストール時に、<code>package.json</code>の<code>bin</code>エントリーの解決が試みられるよう改善されています (<a href=https://github.com/denoland/deno/pull/29884>#29884</a>)</p><p>具体的には、<code>deno install -g npm:@google/gemini-cli</code>を実行すると、<code>gemini</code>が利用できるように改善されています。</p><h2 id=deno-api>Deno API<a hidden class=anchor aria-hidden=true href=#deno-api>#</a></h2><h3 id=denocommand><code>Deno.Command</code><a hidden class=anchor aria-hidden=true href=#denocommand>#</a></h3><p><code>Deno.Command</code>で<code>detached</code>オプションがサポートされています (<a href=https://github.com/denoland/deno/pull/29933>#29933</a>)</p><p>挙動は<code>child_process.spawn()</code> (<code>node:child_process</code>)における同名オプションと同様です。</p><h3 id=denoaddsignallistener><code>Deno.addSignalListener()</code><a hidden class=anchor aria-hidden=true href=#denoaddsignallistener>#</a></h3><p>Windowsにおいて<code>SIGHUP</code>がサポートされています (<a href=https://github.com/denoland/deno/pull/27880>#27880</a>)</p><h2 id=nodejs互換性の改善>Node.js互換性の改善<a hidden class=anchor aria-hidden=true href=#nodejs互換性の改善>#</a></h2><h3 id=--unstable-sloppy-importsの安定化><code>--unstable-sloppy-imports</code>の安定化<a hidden class=anchor aria-hidden=true href=#--unstable-sloppy-importsの安定化>#</a></h3><p><a href=https://uki00a.github.io/deno-weekly/articles/deno/v1.39.html><code>--unstable-sloppy-imports</code></a>が安定化されています (<a href=https://github.com/denoland/deno/pull/29780>#29780</a>)</p><p>今後は<code>--sloppy-imports</code>として利用できます。</p><h3 id=--unstable-node-conditionsが安定化><code>--unstable-node-conditions</code>が安定化<a hidden class=anchor aria-hidden=true href=#--unstable-node-conditionsが安定化>#</a></h3><p><a href=https://uki00a.github.io/deno-weekly/articles/2025/06/15.html><code>--unstable-node-conditions</code></a>が安定化されました (<a href=https://github.com/denoland/deno/pull/29848>#29848</a>, <a href=https://github.com/denoland/deno/pull/29885>#29885</a>, <a href=https://github.com/denoland/deno/pull/29628>#29628</a>)</p><p>今後は<code>--conditions</code>として利用可能です。また、<code>DENO_CONDITIONS</code>環境変数による指定もサポートされています。</p><h3 id=deno_compat環境変数><code>DENO_COMPAT</code>環境変数<a hidden class=anchor aria-hidden=true href=#deno_compat環境変数>#</a></h3><p><code>DENO_COMPAT</code>環境変数が追加されています (<a href=https://github.com/denoland/deno/pull/29889>#29889</a>)</p><p>この環境変数が設定されると、以下のフラグがまとめて有効化されます:</p><ul><li><a href=https://uki00a.github.io/deno-weekly/articles/deno/v1.38.html><code>--unstable-bare-node-builtins</code></a></li><li><a href=https://uki00a.github.io/deno-weekly/articles/2024/12/01.html><code>--unstable-detect-cjs</code></a></li><li><code>--sloppy-imports</code></li></ul><h3 id=bufferglobalsetimmediateclearimmediateがデフォルトでグローバル化><code>Buffer</code>/<code>global</code>/<code>setImmediate</code>/<code>clearImmediate</code>がデフォルトでグローバル化<a hidden class=anchor aria-hidden=true href=#bufferglobalsetimmediateclearimmediateがデフォルトでグローバル化>#</a></h3><p>Node.jsに関する以下のAPIがすべてのコードにおいてデフォルトでグローバル化されました (<a href=https://github.com/denoland/deno/pull/29416>#29416</a>, <a href=https://github.com/denoland/deno/pull/29877>#29877</a>)</p><ul><li><code>global</code></li><li><code>Buffer</code></li><li><code>setImmediate</code></li><li><code>clearImmediate</code></li></ul><p>今までこれらのAPIはnpmパッケージ中のコードにおいてのみグローバル化されていましたが、npmパッケージとユーザーコードの実行環境における差異の軽減のため、ユーザーコードにおいてもこれらのAPIがグローバル化されました。</p><p>この変更に伴って、<a href=https://uki00a.github.io/deno-weekly/articles/deno/v2.1.html><code>--unstable-node-globals</code></a>が非推奨化されています (<a href=https://github.com/denoland/deno/pull/29887>#29887</a>)</p><h3 id=nodefs><code>node:fs</code><a hidden class=anchor aria-hidden=true href=#nodefs>#</a></h3><p><code>glob()</code>と<code>globSync()</code>が実装されています  (<a href=https://github.com/denoland/deno/pull/28972>#28972</a>)</p><p>macOS向けに<code>lchmod()</code>と<code>lchmodSync()</code>が実装されています (<a href=https://github.com/denoland/deno/pull/29833>#29833</a>)</p><p>また、<code>lchown()</code>及び<code>lutimes()</code>が<code>node:fs/promises</code>からも読み込めるよう改善されています (<a href=https://github.com/denoland/deno/pull/29870>#29870</a>)</p><h2 id=参考>参考<a hidden class=anchor aria-hidden=true href=#参考>#</a></h2><ul><li><a href=https://deno.com/blog/v2.4>https://deno.com/blog/v2.4</a></li><li><a href=https://github.com/denoland/deno/releases/tag/v2.4.0>https://github.com/denoland/deno/releases/tag/v2.4.0</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://uki00a.github.io/deno-weekly/tags/deno.html>deno</a></li><li><a href=https://uki00a.github.io/deno-weekly/tags/deno-deploy.html>Deno Deploy</a></li><li><a href=https://uki00a.github.io/deno-weekly/tags/opentelemetry.html>OpenTelemetry</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://uki00a.github.io/deno-weekly/>週刊Deno</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>